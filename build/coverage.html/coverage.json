{"/home/travis/build/npmtest/node-npmtest-socketstream/test.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/test.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":1,"12":1,"13":1,"14":1,"15":2,"16":2,"17":2,"18":2,"19":1,"20":1,"21":2,"22":2,"23":2,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":2,"40":2,"41":1,"42":2,"43":2,"44":1,"45":2,"46":2,"47":1,"48":2,"49":2,"50":1,"51":1,"52":1,"53":1,"54":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[1,1],"5":[1,1],"6":[1,1],"7":[1,1],"8":[1,1],"9":[1,1],"10":[1,1,1],"11":[1,1],"12":[1,1],"13":[1,1],"14":[1,1],"15":[1,1],"16":[1,1],"17":[1,1]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":1,"7":1,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}},"4":{"name":"(anonymous_4)","line":61,"loc":{"start":{"line":61,"column":5},"end":{"line":61,"column":17}}},"5":{"name":"(anonymous_5)","line":82,"loc":{"start":{"line":82,"column":5},"end":{"line":82,"column":17}}},"6":{"name":"(anonymous_6)","line":91,"loc":{"start":{"line":91,"column":77},"end":{"line":94,"column":10}}},"7":{"name":"(anonymous_7)","line":112,"loc":{"start":{"line":112,"column":83},"end":{"line":115,"column":10}},"skip":true},"8":{"name":"(anonymous_8)","line":123,"loc":{"start":{"line":123,"column":77},"end":{"line":126,"column":10}},"skip":true},"9":{"name":"(anonymous_9)","line":139,"loc":{"start":{"line":139,"column":12},"end":{"line":139,"column":40}},"skip":true},"10":{"name":"(anonymous_10)","line":147,"loc":{"start":{"line":147,"column":77},"end":{"line":150,"column":10}},"skip":true},"11":{"name":"(anonymous_11)","line":158,"loc":{"start":{"line":158,"column":83},"end":{"line":161,"column":10}},"skip":true},"12":{"name":"(anonymous_12)","line":169,"loc":{"start":{"line":169,"column":79},"end":{"line":172,"column":10}},"skip":true},"13":{"name":"(anonymous_13)","line":180,"loc":{"start":{"line":180,"column":75},"end":{"line":183,"column":10}},"skip":true}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":195,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":56,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":40,"column":8},"end":{"line":53,"column":9}},"11":{"start":{"line":43,"column":12},"end":{"line":46,"column":14}},"12":{"start":{"line":47,"column":12},"end":{"line":47,"column":18}},"13":{"start":{"line":50,"column":12},"end":{"line":51,"column":33}},"14":{"start":{"line":52,"column":12},"end":{"line":52,"column":18}},"15":{"start":{"line":55,"column":8},"end":{"line":55,"column":35}},"16":{"start":{"line":61,"column":4},"end":{"line":63,"column":9}},"17":{"start":{"line":62,"column":8},"end":{"line":62,"column":15}},"18":{"start":{"line":64,"column":4},"end":{"line":77,"column":5}},"19":{"start":{"line":70,"column":8},"end":{"line":70,"column":14}},"20":{"start":{"line":76,"column":8},"end":{"line":76,"column":14}},"21":{"start":{"line":82,"column":4},"end":{"line":84,"column":9}},"22":{"start":{"line":83,"column":8},"end":{"line":83,"column":15}},"23":{"start":{"line":85,"column":4},"end":{"line":194,"column":5}},"24":{"start":{"line":91,"column":8},"end":{"line":99,"column":10}},"25":{"start":{"line":98,"column":12},"end":{"line":98,"column":35}},"26":{"start":{"line":102,"column":8},"end":{"line":104,"column":63}},"27":{"start":{"line":105,"column":8},"end":{"line":105,"column":14}},"28":{"start":{"line":112,"column":8},"end":{"line":121,"column":10},"skip":true},"29":{"start":{"line":119,"column":12},"end":{"line":119,"column":55},"skip":true},"30":{"start":{"line":120,"column":12},"end":{"line":120,"column":48},"skip":true},"31":{"start":{"line":123,"column":8},"end":{"line":136,"column":10},"skip":true},"32":{"start":{"line":130,"column":12},"end":{"line":130,"column":76},"skip":true},"33":{"start":{"line":131,"column":12},"end":{"line":131,"column":73},"skip":true},"34":{"start":{"line":132,"column":12},"end":{"line":132,"column":74},"skip":true},"35":{"start":{"line":133,"column":12},"end":{"line":133,"column":79},"skip":true},"36":{"start":{"line":134,"column":12},"end":{"line":134,"column":25},"skip":true},"37":{"start":{"line":135,"column":12},"end":{"line":135,"column":45},"skip":true},"38":{"start":{"line":138,"column":8},"end":{"line":145,"column":14},"skip":true},"39":{"start":{"line":143,"column":16},"end":{"line":143,"column":29},"skip":true},"40":{"start":{"line":144,"column":16},"end":{"line":144,"column":55},"skip":true},"41":{"start":{"line":147,"column":8},"end":{"line":156,"column":10},"skip":true},"42":{"start":{"line":154,"column":12},"end":{"line":154,"column":25},"skip":true},"43":{"start":{"line":155,"column":12},"end":{"line":155,"column":45},"skip":true},"44":{"start":{"line":158,"column":8},"end":{"line":167,"column":10},"skip":true},"45":{"start":{"line":165,"column":12},"end":{"line":165,"column":25},"skip":true},"46":{"start":{"line":166,"column":12},"end":{"line":166,"column":48},"skip":true},"47":{"start":{"line":169,"column":8},"end":{"line":178,"column":10},"skip":true},"48":{"start":{"line":176,"column":12},"end":{"line":176,"column":25},"skip":true},"49":{"start":{"line":177,"column":12},"end":{"line":177,"column":46},"skip":true},"50":{"start":{"line":180,"column":8},"end":{"line":189,"column":10},"skip":true},"51":{"start":{"line":187,"column":12},"end":{"line":187,"column":94},"skip":true},"52":{"start":{"line":188,"column":12},"end":{"line":188,"column":48},"skip":true},"53":{"start":{"line":192,"column":8},"end":{"line":192,"column":35},"skip":true},"54":{"start":{"line":193,"column":8},"end":{"line":193,"column":14},"skip":true}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":40,"type":"switch","locations":[{"start":{"line":42,"column":8},"end":{"line":47,"column":18}},{"start":{"line":49,"column":8},"end":{"line":52,"column":18}}]},"5":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":44}},{"start":{"line":44,"column":48},"end":{"line":44,"column":66}}]},"6":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":21},"end":{"line":50,"column":49}},{"start":{"line":50,"column":53},"end":{"line":50,"column":72}}]},"7":{"line":64,"type":"switch","locations":[{"start":{"line":69,"column":4},"end":{"line":70,"column":14}},{"start":{"line":75,"column":4},"end":{"line":76,"column":14}}]},"8":{"line":85,"type":"switch","locations":[{"start":{"line":90,"column":4},"end":{"line":105,"column":14}},{"start":{"line":111,"column":4},"end":{"line":193,"column":14},"skip":true}]},"9":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":42},"end":{"line":91,"column":73}},{"start":{"line":91,"column":77},"end":{"line":99,"column":9}}]},"10":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":18},"end":{"line":102,"column":32}},{"start":{"line":103,"column":12},"end":{"line":103,"column":53}},{"start":{"line":104,"column":12},"end":{"line":104,"column":61}}]},"11":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":45},"end":{"line":112,"column":79},"skip":true},{"start":{"line":112,"column":83},"end":{"line":121,"column":9},"skip":true}]},"12":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":42},"end":{"line":123,"column":73},"skip":true},{"start":{"line":123,"column":77},"end":{"line":136,"column":9},"skip":true}]},"13":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":48},"end":{"line":138,"column":85},"skip":true},{"start":{"line":139,"column":12},"end":{"line":145,"column":13},"skip":true}]},"14":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":42},"end":{"line":147,"column":73},"skip":true},{"start":{"line":147,"column":77},"end":{"line":156,"column":9},"skip":true}]},"15":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":45},"end":{"line":158,"column":79},"skip":true},{"start":{"line":158,"column":83},"end":{"line":167,"column":9},"skip":true}]},"16":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":43},"end":{"line":169,"column":75},"skip":true},{"start":{"line":169,"column":79},"end":{"line":178,"column":9},"skip":true}]},"17":{"line":180,"type":"binary-expr","locations":[{"start":{"line":180,"column":41},"end":{"line":180,"column":71},"skip":true},{"start":{"line":180,"column":75},"end":{"line":189,"column":9},"skip":true}]}},"code":["/* istanbul instrument in package npmtest_socketstream */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        switch (local.modeJs) {","        // re-init local from window.local","        case 'browser':","            local = local.global.utility2.objectSetDefault(","                local.global.utility2_rollup || local.global.local,","                local.global.utility2","            );","            break;","        // re-init local from example.js","        case 'node':","            local = (local.global.utility2_rollup || require('utility2'))","                .requireReadme();","            break;","        }","        // export local","        local.global.local = local;","    }());","","","","    // run shared js-env code - function","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - function","    case 'browser':","        break;","","","","    // run node js-env code - function","    case 'node':","        break;","    }","","","","    // run shared js-env code - init-after","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - init-after","    case 'browser':","        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (","            options,","            onError","        ) {","        /*","         * this function will test browsers's null-case handling-behavior-behavior","         */","            onError(null, options);","        };","","        // run tests","        local.nop(local.modeTest &&","            document.querySelector('#testRunButton1') &&","            document.querySelector('#testRunButton1').click());","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApidoc's default handling-behavior-behavior","         */","            options = { modulePathList: module.paths };","            local.buildApidoc(options, onError);","        };","","        local.testCase_buildApp_default = local.testCase_buildApp_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApp's default handling-behavior-behavior","         */","            local.testCase_buildReadme_default(options, local.onErrorThrow);","            local.testCase_buildLib_default(options, local.onErrorThrow);","            local.testCase_buildTest_default(options, local.onErrorThrow);","            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);","            options = [];","            local.buildApp(options, onError);","        };","","        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||","            function (options, onError) {","            /*","             * this function will test buildCustomOrg's default handling-behavior","             */","                options = {};","                local.buildCustomOrg(options, onError);","            };","","        local.testCase_buildLib_default = local.testCase_buildLib_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildLib's default handling-behavior","         */","            options = {};","            local.buildLib(options, onError);","        };","","        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildReadme's default handling-behavior-behavior","         */","            options = {};","            local.buildReadme(options, onError);","        };","","        local.testCase_buildTest_default = local.testCase_buildTest_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildTest's default handling-behavior","         */","            options = {};","            local.buildTest(options, onError);","        };","","        local.testCase_webpage_default = local.testCase_webpage_default || function (","            options,","            onError","        ) {","        /*","         * this function will test webpage's default handling-behavior","         */","            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };","            local.browserTest(options, onError);","        };","","        // run test-server","        local.testRunServer(local);","        break;","    }","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"40":2,"43":1,"47":1,"50":1,"52":1,"55":2,"61":2,"62":2,"64":2,"70":1,"76":1,"82":2,"83":2,"85":2,"91":1,"98":1,"102":1,"105":1,"112":1,"119":1,"120":1,"123":1,"130":1,"131":1,"132":1,"133":1,"134":1,"135":1,"138":1,"143":2,"144":2,"147":1,"154":2,"155":2,"158":1,"165":2,"166":2,"169":1,"176":2,"177":2,"180":1,"187":1,"188":1,"192":1,"193":1}},"/home/travis/build/npmtest/node-npmtest-socketstream/lib.npmtest_socketstream.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/lib.npmtest_socketstream.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":1,"15":1,"16":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1]},"f":{"1":2,"2":2,"3":2},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":53,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":52,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":41,"column":8},"end":{"line":41,"column":54}},"11":{"start":{"line":43,"column":8},"end":{"line":43,"column":57}},"12":{"start":{"line":45,"column":8},"end":{"line":51,"column":9}},"13":{"start":{"line":46,"column":12},"end":{"line":46,"column":63}},"14":{"start":{"line":48,"column":12},"end":{"line":48,"column":35}},"15":{"start":{"line":49,"column":12},"end":{"line":49,"column":49}},"16":{"start":{"line":50,"column":12},"end":{"line":50,"column":43}}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":44}},{"start":{"line":41,"column":48},"end":{"line":41,"column":53}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":45,"column":8}},{"start":{"line":45,"column":8},"end":{"line":45,"column":8}}]}},"code":["/* istanbul instrument in package npmtest_socketstream */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || local;","        // init lib","        local.local = local.npmtest_socketstream = local;","        // init exports","        if (local.modeJs === 'browser') {","            local.global.utility2_npmtest_socketstream = local;","        } else {","            module.exports = local;","            module.exports.__dirname = __dirname;","            module.exports.module = module;","        }","    }());","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"41":2,"43":2,"45":2,"46":1,"48":1,"49":1,"50":1}},"/home/travis/build/npmtest/node-npmtest-socketstream/example.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/example.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":2,"15":2,"16":2,"17":2,"18":2,"19":0,"20":2,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":1,"29":1,"30":2,"31":0,"32":0,"33":0,"34":1,"35":2,"36":2,"37":3,"38":3,"39":3,"40":3,"41":0,"42":3,"43":3,"44":3,"45":1,"46":3,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":0,"58":1,"59":6,"60":6,"61":1,"62":2,"63":0,"64":2,"65":1,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1],"6":[1,1],"7":[2,0],"8":[2,1,1,1,1,1],"9":[0,2,0],"10":[1,1],"11":[2,1,1],"12":[1,0],"13":[0,2],"14":[2,0,0,0,0,0,0],"15":[0,3],"16":[3,0],"17":[1,1],"18":[0,1],"19":[1,2,0,2],"20":[1,0],"21":[1,1],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":3,"8":3,"9":3,"10":1,"11":6,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":1},"end":{"line":26,"column":13}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":5},"end":{"line":33,"column":17}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":36}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":31},"end":{"line":69,"column":48}},"skip":true},"5":{"name":"(anonymous_5)","line":78,"loc":{"start":{"line":78,"column":26},"end":{"line":78,"column":45}},"skip":true},"6":{"name":"(anonymous_6)","line":123,"loc":{"start":{"line":123,"column":33},"end":{"line":123,"column":48}},"skip":true},"7":{"name":"(anonymous_7)","line":125,"loc":{"start":{"line":125,"column":27},"end":{"line":125,"column":39}},"skip":true},"8":{"name":"(anonymous_8)","line":133,"loc":{"start":{"line":133,"column":59},"end":{"line":133,"column":74}},"skip":true},"9":{"name":"(anonymous_9)","line":143,"loc":{"start":{"line":143,"column":45},"end":{"line":143,"column":62}},"skip":true},"10":{"name":"(anonymous_10)","line":144,"loc":{"start":{"line":144,"column":73},"end":{"line":144,"column":92}},"skip":true},"11":{"name":"(anonymous_11)","line":272,"loc":{"start":{"line":272,"column":51},"end":{"line":272,"column":77}},"skip":true},"12":{"name":"(anonymous_12)","line":315,"loc":{"start":{"line":315,"column":32},"end":{"line":315,"column":61}},"skip":true}},"statementMap":{"1":{"start":{"line":26,"column":0},"end":{"line":326,"column":5}},"2":{"start":{"line":28,"column":4},"end":{"line":28,"column":14}},"3":{"start":{"line":33,"column":4},"end":{"line":60,"column":9}},"4":{"start":{"line":35,"column":8},"end":{"line":35,"column":19}},"5":{"start":{"line":37,"column":8},"end":{"line":49,"column":13}},"6":{"start":{"line":38,"column":12},"end":{"line":48,"column":13}},"7":{"start":{"line":39,"column":16},"end":{"line":42,"column":30}},"8":{"start":{"line":44,"column":16},"end":{"line":47,"column":27}},"9":{"start":{"line":51,"column":8},"end":{"line":53,"column":21}},"10":{"start":{"line":55,"column":8},"end":{"line":57,"column":45}},"11":{"start":{"line":59,"column":8},"end":{"line":59,"column":35}},"12":{"start":{"line":61,"column":4},"end":{"line":325,"column":5}},"13":{"start":{"line":69,"column":8},"end":{"line":121,"column":10},"skip":true},"14":{"start":{"line":70,"column":12},"end":{"line":88,"column":13},"skip":true},"15":{"start":{"line":76,"column":16},"end":{"line":87,"column":19},"skip":true},"16":{"start":{"line":79,"column":20},"end":{"line":86,"column":21},"skip":true},"17":{"start":{"line":82,"column":24},"end":{"line":82,"column":43},"skip":true},"18":{"start":{"line":83,"column":24},"end":{"line":83,"column":30},"skip":true},"19":{"start":{"line":85,"column":24},"end":{"line":85,"column":49},"skip":true},"20":{"start":{"line":89,"column":12},"end":{"line":107,"column":13},"skip":true},"21":{"start":{"line":92,"column":16},"end":{"line":102,"column":17},"skip":true},"22":{"start":{"line":93,"column":20},"end":{"line":93,"column":86},"skip":true},"23":{"start":{"line":94,"column":20},"end":{"line":95,"column":45},"skip":true},"24":{"start":{"line":96,"column":20},"end":{"line":96,"column":42},"skip":true},"25":{"start":{"line":97,"column":20},"end":{"line":97,"column":48},"skip":true},"26":{"start":{"line":100,"column":20},"end":{"line":100,"column":85},"skip":true},"27":{"start":{"line":101,"column":20},"end":{"line":101,"column":96},"skip":true},"28":{"start":{"line":103,"column":16},"end":{"line":103,"column":22},"skip":true},"29":{"start":{"line":106,"column":16},"end":{"line":106,"column":22},"skip":true},"30":{"start":{"line":108,"column":12},"end":{"line":120,"column":13},"skip":true},"31":{"start":{"line":114,"column":16},"end":{"line":119,"column":17},"skip":true},"32":{"start":{"line":116,"column":20},"end":{"line":116,"column":78},"skip":true},"33":{"start":{"line":118,"column":20},"end":{"line":118,"column":47},"skip":true},"34":{"start":{"line":123,"column":8},"end":{"line":141,"column":11},"skip":true},"35":{"start":{"line":124,"column":12},"end":{"line":124,"column":54},"skip":true},"36":{"start":{"line":125,"column":12},"end":{"line":140,"column":14},"skip":true},"37":{"start":{"line":126,"column":16},"end":{"line":126,"column":28},"skip":true},"38":{"start":{"line":127,"column":16},"end":{"line":127,"column":69},"skip":true},"39":{"start":{"line":128,"column":16},"end":{"line":128,"column":75},"skip":true},"40":{"start":{"line":129,"column":16},"end":{"line":131,"column":17},"skip":true},"41":{"start":{"line":130,"column":20},"end":{"line":130,"column":27},"skip":true},"42":{"start":{"line":133,"column":16},"end":{"line":137,"column":36},"skip":true},"43":{"start":{"line":134,"column":20},"end":{"line":136,"column":55},"skip":true},"44":{"start":{"line":139,"column":16},"end":{"line":139,"column":57},"skip":true},"45":{"start":{"line":143,"column":8},"end":{"line":147,"column":11},"skip":true},"46":{"start":{"line":144,"column":12},"end":{"line":146,"column":15},"skip":true},"47":{"start":{"line":145,"column":16},"end":{"line":145,"column":70},"skip":true},"48":{"start":{"line":149,"column":8},"end":{"line":149,"column":31},"skip":true},"49":{"start":{"line":150,"column":8},"end":{"line":150,"column":14},"skip":true},"50":{"start":{"line":158,"column":8},"end":{"line":158,"column":31},"skip":true},"51":{"start":{"line":160,"column":8},"end":{"line":160,"column":33},"skip":true},"52":{"start":{"line":161,"column":8},"end":{"line":161,"column":37},"skip":true},"53":{"start":{"line":162,"column":8},"end":{"line":162,"column":35},"skip":true},"54":{"start":{"line":164,"column":8},"end":{"line":164,"column":50},"skip":true},"55":{"start":{"line":166,"column":8},"end":{"line":256,"column":2},"skip":true},"56":{"start":{"line":258,"column":8},"end":{"line":286,"column":9},"skip":true},"57":{"start":{"line":259,"column":12},"end":{"line":269,"column":14},"skip":true},"58":{"start":{"line":271,"column":12},"end":{"line":285,"column":19},"skip":true},"59":{"start":{"line":274,"column":20},"end":{"line":274,"column":35},"skip":true},"60":{"start":{"line":275,"column":20},"end":{"line":284,"column":21},"skip":true},"61":{"start":{"line":277,"column":24},"end":{"line":277,"column":64},"skip":true},"62":{"start":{"line":279,"column":24},"end":{"line":279,"column":40},"skip":true},"63":{"start":{"line":281,"column":24},"end":{"line":281,"column":40},"skip":true},"64":{"start":{"line":283,"column":24},"end":{"line":283,"column":39},"skip":true},"65":{"start":{"line":288,"column":8},"end":{"line":290,"column":9},"skip":true},"66":{"start":{"line":289,"column":12},"end":{"line":289,"column":18},"skip":true},"67":{"start":{"line":291,"column":8},"end":{"line":293,"column":54},"skip":true},"68":{"start":{"line":296,"column":8},"end":{"line":301,"column":37},"skip":true},"69":{"start":{"line":303,"column":8},"end":{"line":303,"column":82},"skip":true},"70":{"start":{"line":306,"column":8},"end":{"line":308,"column":9},"skip":true},"71":{"start":{"line":307,"column":12},"end":{"line":307,"column":82},"skip":true},"72":{"start":{"line":310,"column":8},"end":{"line":312,"column":9},"skip":true},"73":{"start":{"line":311,"column":12},"end":{"line":311,"column":18},"skip":true},"74":{"start":{"line":313,"column":8},"end":{"line":313,"column":54},"skip":true},"75":{"start":{"line":314,"column":8},"end":{"line":314,"column":69},"skip":true},"76":{"start":{"line":315,"column":8},"end":{"line":323,"column":36},"skip":true},"77":{"start":{"line":316,"column":12},"end":{"line":316,"column":61},"skip":true},"78":{"start":{"line":317,"column":12},"end":{"line":320,"column":13},"skip":true},"79":{"start":{"line":318,"column":16},"end":{"line":318,"column":75},"skip":true},"80":{"start":{"line":319,"column":16},"end":{"line":319,"column":23},"skip":true},"81":{"start":{"line":321,"column":12},"end":{"line":321,"column":38},"skip":true},"82":{"start":{"line":322,"column":12},"end":{"line":322,"column":27},"skip":true},"83":{"start":{"line":324,"column":8},"end":{"line":324,"column":14},"skip":true}},"branchMap":{"1":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":23},"end":{"line":39,"column":62}},{"start":{"line":40,"column":20},"end":{"line":40,"column":70}},{"start":{"line":41,"column":20},"end":{"line":41,"column":71}},{"start":{"line":42,"column":20},"end":{"line":42,"column":29}}]},"2":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":23},"end":{"line":44,"column":37}},{"start":{"line":45,"column":20},"end":{"line":45,"column":61}},{"start":{"line":46,"column":20},"end":{"line":46,"column":70}},{"start":{"line":47,"column":20},"end":{"line":47,"column":26}}]},"3":{"line":51,"type":"cond-expr","locations":[{"start":{"line":52,"column":14},"end":{"line":52,"column":20}},{"start":{"line":53,"column":14},"end":{"line":53,"column":20}}]},"4":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":16},"end":{"line":55,"column":44}},{"start":{"line":55,"column":49},"end":{"line":57,"column":43}}]},"5":{"line":55,"type":"cond-expr","locations":[{"start":{"line":56,"column":14},"end":{"line":56,"column":56}},{"start":{"line":57,"column":14},"end":{"line":57,"column":43}}]},"6":{"line":61,"type":"switch","locations":[{"start":{"line":68,"column":4},"end":{"line":150,"column":14},"skip":true},{"start":{"line":156,"column":4},"end":{"line":324,"column":14},"skip":true}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true},{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true}]},"8":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":16},"end":{"line":70,"column":22},"skip":true},{"start":{"line":70,"column":27},"end":{"line":70,"column":32},"skip":true},{"start":{"line":71,"column":20},"end":{"line":71,"column":39},"skip":true},{"start":{"line":72,"column":20},"end":{"line":72,"column":49},"skip":true},{"start":{"line":73,"column":20},"end":{"line":73,"column":58},"skip":true},{"start":{"line":74,"column":20},"end":{"line":74,"column":69},"skip":true}]},"9":{"line":79,"type":"switch","locations":[{"start":{"line":80,"column":20},"end":{"line":80,"column":33},"skip":true},{"start":{"line":81,"column":20},"end":{"line":83,"column":30},"skip":true},{"start":{"line":84,"column":20},"end":{"line":85,"column":49},"skip":true}]},"10":{"line":89,"type":"switch","locations":[{"start":{"line":90,"column":12},"end":{"line":103,"column":22},"skip":true},{"start":{"line":105,"column":12},"end":{"line":106,"column":22},"skip":true}]},"11":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":20},"end":{"line":89,"column":25},"skip":true},{"start":{"line":89,"column":29},"end":{"line":89,"column":48},"skip":true},{"start":{"line":89,"column":52},"end":{"line":89,"column":74},"skip":true}]},"12":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true},{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true}]},"13":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true},{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true}]},"14":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":16},"end":{"line":108,"column":61},"skip":true},{"start":{"line":108,"column":66},"end":{"line":108,"column":72},"skip":true},{"start":{"line":108,"column":77},"end":{"line":108,"column":82},"skip":true},{"start":{"line":109,"column":20},"end":{"line":109,"column":39},"skip":true},{"start":{"line":110,"column":20},"end":{"line":110,"column":49},"skip":true},{"start":{"line":111,"column":20},"end":{"line":111,"column":58},"skip":true},{"start":{"line":112,"column":20},"end":{"line":112,"column":68},"skip":true}]},"15":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true},{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true}]},"16":{"line":134,"type":"cond-expr","locations":[{"start":{"line":135,"column":26},"end":{"line":135,"column":29},"skip":true},{"start":{"line":136,"column":26},"end":{"line":136,"column":54},"skip":true}]},"17":{"line":164,"type":"binary-expr","locations":[{"start":{"line":164,"column":27},"end":{"line":164,"column":43},"skip":true},{"start":{"line":164,"column":47},"end":{"line":164,"column":49},"skip":true}]},"18":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true},{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true}]},"19":{"line":275,"type":"switch","locations":[{"start":{"line":276,"column":20},"end":{"line":277,"column":64},"skip":true},{"start":{"line":278,"column":20},"end":{"line":279,"column":40},"skip":true},{"start":{"line":280,"column":20},"end":{"line":281,"column":40},"skip":true},{"start":{"line":282,"column":20},"end":{"line":283,"column":39},"skip":true}]},"20":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true},{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true}]},"21":{"line":288,"type":"binary-expr","locations":[{"start":{"line":288,"column":12},"end":{"line":288,"column":40},"skip":true},{"start":{"line":288,"column":44},"end":{"line":288,"column":67},"skip":true}]},"22":{"line":292,"type":"binary-expr","locations":[{"start":{"line":292,"column":12},"end":{"line":292,"column":50},"skip":true},{"start":{"line":293,"column":12},"end":{"line":293,"column":53},"skip":true}]},"23":{"line":297,"type":"binary-expr","locations":[{"start":{"line":297,"column":12},"end":{"line":297,"column":70},"skip":true},{"start":{"line":298,"column":12},"end":{"line":301,"column":36},"skip":true}]},"24":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":43},"end":{"line":303,"column":75},"skip":true},{"start":{"line":303,"column":79},"end":{"line":303,"column":81},"skip":true}]},"25":{"line":306,"type":"if","locations":[{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true},{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true}]},"26":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true},{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true}]},"27":{"line":313,"type":"binary-expr","locations":[{"start":{"line":313,"column":27},"end":{"line":313,"column":43},"skip":true},{"start":{"line":313,"column":47},"end":{"line":313,"column":53},"skip":true}]},"28":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true},{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true}]}},"code":["/*","example.js","","quickstart example","","instruction","    1. save this script as example.js","    2. run the shell command:","        $ npm install npmtest-socketstream && PORT=8081 node example.js","    3. play with the browser-demo on http://127.0.0.1:8081","*/","","","","/* istanbul instrument in package npmtest_socketstream */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || (local.modeJs === 'browser'","            ? local.global.utility2_npmtest_socketstream","            : global.utility2_moduleExports);","        // export local","        local.global.local = local;","    }());","    switch (local.modeJs) {","","","","    // init-after","    // run browser js-env code - init-after","    /* istanbul ignore next */","    case 'browser':","        local.testRunBrowser = function (event) {","            if (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('onreset'))) {","                // reset output","                Array.from(","                    document.querySelectorAll('body > .resettable')","                ).forEach(function (element) {","                    switch (element.tagName) {","                    case 'INPUT':","                    case 'TEXTAREA':","                        element.value = '';","                        break;","                    default:","                        element.textContent = '';","                    }","                });","            }","            switch (event && event.currentTarget && event.currentTarget.id) {","            case 'testRunButton1':","                // show tests","                if (document.querySelector('#testReportDiv1').style.display === 'none') {","                    document.querySelector('#testReportDiv1').style.display = 'block';","                    document.querySelector('#testRunButton1').textContent =","                        'hide internal test';","                    local.modeTest = true;","                    local.testRunDefault(local);","                // hide tests","                } else {","                    document.querySelector('#testReportDiv1').style.display = 'none';","                    document.querySelector('#testRunButton1').textContent = 'run internal test';","                }","                break;","            // custom-case","            default:","                break;","            }","            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('oneval')))) {","                // try to eval input-code","                try {","                    /*jslint evil: true*/","                    eval(document.querySelector('#inputTextareaEval1').value);","                } catch (errorCaught) {","                    console.error(errorCaught);","                }","            }","        };","        // log stderr and stdout to #outputTextareaStdout1","        ['error', 'log'].forEach(function (key) {","            console[key + '_original'] = console[key];","            console[key] = function () {","                var element;","                console[key + '_original'].apply(console, arguments);","                element = document.querySelector('#outputTextareaStdout1');","                if (!element) {","                    return;","                }","                // append text to #outputTextareaStdout1","                element.value += Array.from(arguments).map(function (arg) {","                    return typeof arg === 'string'","                        ? arg","                        : JSON.stringify(arg, null, 4);","                }).join(' ') + '\\n';","                // scroll textarea to bottom","                element.scrollTop = element.scrollHeight;","            };","        });","        // init event-handling","        ['change', 'click', 'keyup'].forEach(function (event) {","            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {","                element.addEventListener(event, local.testRunBrowser);","            });","        });","        // run tests","        local.testRunBrowser();","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        // export local","        module.exports = local;","        // require modules","        local.fs = require('fs');","        local.http = require('http');","        local.url = require('url');","        // init assets","        local.assetsDict = local.assetsDict || {};","        /* jslint-ignore-begin */","        local.assetsDict['/assets.index.template.html'] = '\\","<!doctype html>\\n\\","<html lang=\"en\">\\n\\","<head>\\n\\","<meta charset=\"UTF-8\">\\n\\","<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\","<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\","<style>\\n\\","/*csslint\\n\\","    box-sizing: false,\\n\\","    universal-selector: false\\n\\","*/\\n\\","* {\\n\\","    box-sizing: border-box;\\n\\","}\\n\\","body {\\n\\","    background: #dde;\\n\\","    font-family: Arial, Helvetica, sans-serif;\\n\\","    margin: 2rem;\\n\\","}\\n\\","body > * {\\n\\","    margin-bottom: 1rem;\\n\\","}\\n\\",".utility2FooterDiv {\\n\\","    margin-top: 20px;\\n\\","    text-align: center;\\n\\","}\\n\\","</style>\\n\\","<style>\\n\\","/*csslint\\n\\","*/\\n\\","textarea {\\n\\","    font-family: monospace;\\n\\","    height: 10rem;\\n\\","    width: 100%;\\n\\","}\\n\\","textarea[readonly] {\\n\\","    background: #ddd;\\n\\","}\\n\\","</style>\\n\\","</head>\\n\\","<body>\\n\\","<!-- utility2-comment\\n\\","<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\","utility2-comment -->\\n\\","<h1>\\n\\","<!-- utility2-comment\\n\\","    <a\\n\\","        {{#if env.npm_package_homepage}}\\n\\","        href=\"{{env.npm_package_homepage}}\"\\n\\","        {{/if env.npm_package_homepage}}\\n\\","        target=\"_blank\"\\n\\","    >\\n\\","utility2-comment -->\\n\\","        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\","<!-- utility2-comment\\n\\","    </a>\\n\\","utility2-comment -->\\n\\","</h1>\\n\\","<h3>{{env.npm_package_description}}</h3>\\n\\","<!-- utility2-comment\\n\\","<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\","<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\","<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\","utility2-comment -->\\n\\","\\n\\","\\n\\","\\n\\","<label>stderr and stdout</label>\\n\\","<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\","<!-- utility2-comment\\n\\","{{#if isRollup}}\\n\\","<script src=\"assets.app.js\"></script>\\n\\","{{#unless isRollup}}\\n\\","utility2-comment -->\\n\\","<script src=\"assets.utility2.rollup.js\"></script>\\n\\","<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\","<script src=\"assets.npmtest_socketstream.rollup.js\"></script>\\n\\","<script src=\"assets.example.js\"></script>\\n\\","<script src=\"assets.test.js\"></script>\\n\\","<!-- utility2-comment\\n\\","{{/if isRollup}}\\n\\","utility2-comment -->\\n\\","<div class=\"utility2FooterDiv\">\\n\\","    [ this app was created with\\n\\","    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\","    ]\\n\\","</div>\\n\\","</body>\\n\\","</html>\\n\\","';","        /* jslint-ignore-end */","        if (local.templateRender) {","            local.assetsDict['/'] = local.templateRender(","                local.assetsDict['/assets.index.template.html'],","                {","                    env: local.objectSetDefault(local.env, {","                        npm_package_description: 'the greatest app in the world!',","                        npm_package_name: 'my-app',","                        npm_package_nameAlias: 'my_app',","                        npm_package_version: '0.0.1'","                    })","                }","            );","        } else {","            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']","                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {","                    // jslint-hack","                    String(match0);","                    switch (match1) {","                    case 'npm_package_description':","                        return 'the greatest app in the world!';","                    case 'npm_package_name':","                        return 'my-app';","                    case 'npm_package_nameAlias':","                        return 'my_app';","                    case 'npm_package_version':","                        return '0.0.1';","                    }","                });","        }","        // run the cli","        if (local.global.utility2_rollup || module !== require.main) {","            break;","        }","        local.assetsDict['/assets.example.js'] =","            local.assetsDict['/assets.example.js'] ||","            local.fs.readFileSync(__filename, 'utf8');","        // bug-workaround - long $npm_package_buildCustomOrg","        /* jslint-ignore-begin */","        local.assetsDict['/assets.npmtest_socketstream.rollup.js'] =","            local.assetsDict['/assets.npmtest_socketstream.rollup.js'] ||","            local.fs.readFileSync(","                local.npmtest_socketstream.__dirname + '/lib.npmtest_socketstream.js',","                'utf8'","            ).replace((/^#!/), '//');","        /* jslint-ignore-end */","        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';","        // if $npm_config_timeout_exit exists,","        // then exit this process after $npm_config_timeout_exit ms","        if (Number(process.env.npm_config_timeout_exit)) {","            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));","        }","        // start server","        if (local.global.utility2_serverHttp1) {","            break;","        }","        process.env.PORT = process.env.PORT || '8081';","        console.error('server starting on port ' + process.env.PORT);","        local.http.createServer(function (request, response) {","            request.urlParsed = local.url.parse(request.url);","            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {","                response.end(local.assetsDict[request.urlParsed.pathname]);","                return;","            }","            response.statusCode = 404;","            response.end();","        }).listen(process.env.PORT);","        break;","    }","}());",""],"l":{"26":2,"28":2,"33":2,"35":2,"37":2,"38":2,"39":2,"44":1,"51":2,"55":2,"59":2,"61":2,"69":1,"70":2,"76":2,"79":2,"82":2,"83":2,"85":1,"89":2,"92":1,"93":1,"94":1,"96":1,"97":1,"100":1,"101":1,"103":1,"106":1,"108":2,"114":1,"116":1,"118":1,"123":1,"124":2,"125":2,"126":3,"127":3,"128":3,"129":3,"130":1,"133":3,"134":3,"139":3,"143":1,"144":3,"145":1,"149":1,"150":1,"158":1,"160":1,"161":1,"162":1,"164":1,"166":1,"258":1,"259":1,"271":1,"274":6,"275":6,"277":1,"279":2,"281":1,"283":2,"288":1,"289":1,"291":1,"296":1,"303":1,"306":1,"307":1,"310":1,"311":1,"313":1,"314":1,"315":1,"316":1,"317":1,"318":1,"319":1,"321":1,"322":1,"324":1}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":50}}},"branchMap":{},"code":["// Initial entry point. Decides which directory of code to load","","// Load SocketStream core","module.exports = require('./lib/socketstream.js');"],"l":{"4":1}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/socketstream.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/socketstream.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":0,"29":1,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":1,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":1,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0},"b":{"1":[0,1],"2":[1,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":78,"loc":{"start":{"line":78,"column":7},"end":{"line":78,"column":26}}},"2":{"name":"(anonymous_2)","line":156,"loc":{"start":{"line":156,"column":16},"end":{"line":156,"column":27}}},"3":{"name":"load","line":164,"loc":{"start":{"line":164,"column":0},"end":{"line":164,"column":16}}},"4":{"name":"(anonymous_4)","line":169,"loc":{"start":{"line":169,"column":60},"end":{"line":169,"column":77}}},"5":{"name":"unload","line":207,"loc":{"start":{"line":207,"column":0},"end":{"line":207,"column":18}}},"6":{"name":"start","line":227,"loc":{"start":{"line":227,"column":0},"end":{"line":227,"column":17}}},"7":{"name":"(anonymous_7)","line":258,"loc":{"start":{"line":258,"column":14},"end":{"line":258,"column":35}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":18}},"2":{"start":{"line":7,"column":0},"end":{"line":8,"column":45}},"3":{"start":{"line":18,"column":0},"end":{"line":18,"column":82}},"4":{"start":{"line":21,"column":0},"end":{"line":21,"column":60}},"5":{"start":{"line":24,"column":0},"end":{"line":26,"column":1}},"6":{"start":{"line":25,"column":2},"end":{"line":25,"column":102}},"7":{"start":{"line":41,"column":0},"end":{"line":86,"column":2}},"8":{"start":{"line":79,"column":4},"end":{"line":84,"column":5}},"9":{"start":{"line":80,"column":6},"end":{"line":80,"column":120}},"10":{"start":{"line":82,"column":6},"end":{"line":82,"column":21}},"11":{"start":{"line":83,"column":6},"end":{"line":83,"column":18}},"12":{"start":{"line":91,"column":0},"end":{"line":91,"column":46}},"13":{"start":{"line":103,"column":0},"end":{"line":103,"column":50}},"14":{"start":{"line":106,"column":0},"end":{"line":106,"column":58}},"15":{"start":{"line":109,"column":0},"end":{"line":109,"column":55}},"16":{"start":{"line":112,"column":0},"end":{"line":112,"column":60}},"17":{"start":{"line":115,"column":0},"end":{"line":115,"column":62}},"18":{"start":{"line":116,"column":0},"end":{"line":116,"column":56}},"19":{"start":{"line":119,"column":0},"end":{"line":119,"column":68}},"20":{"start":{"line":122,"column":0},"end":{"line":122,"column":36}},"21":{"start":{"line":123,"column":0},"end":{"line":123,"column":36}},"22":{"start":{"line":134,"column":0},"end":{"line":134,"column":59}},"23":{"start":{"line":143,"column":0},"end":{"line":143,"column":16}},"24":{"start":{"line":146,"column":0},"end":{"line":146,"column":53}},"25":{"start":{"line":149,"column":0},"end":{"line":149,"column":56}},"26":{"start":{"line":152,"column":0},"end":{"line":152,"column":26}},"27":{"start":{"line":156,"column":0},"end":{"line":158,"column":2}},"28":{"start":{"line":157,"column":2},"end":{"line":157,"column":74}},"29":{"start":{"line":160,"column":0},"end":{"line":160,"column":19}},"30":{"start":{"line":164,"column":0},"end":{"line":205,"column":1}},"31":{"start":{"line":165,"column":2},"end":{"line":203,"column":3}},"32":{"start":{"line":166,"column":4},"end":{"line":166,"column":34}},"33":{"start":{"line":169,"column":4},"end":{"line":180,"column":7}},"34":{"start":{"line":170,"column":6},"end":{"line":179,"column":7}},"35":{"start":{"line":171,"column":8},"end":{"line":176,"column":9}},"36":{"start":{"line":172,"column":10},"end":{"line":172,"column":19}},"37":{"start":{"line":173,"column":10},"end":{"line":173,"column":26}},"38":{"start":{"line":175,"column":10},"end":{"line":175,"column":46}},"39":{"start":{"line":178,"column":8},"end":{"line":178,"column":25}},"40":{"start":{"line":181,"column":4},"end":{"line":183,"column":61}},"41":{"start":{"line":186,"column":4},"end":{"line":186,"column":16}},"42":{"start":{"line":189,"column":4},"end":{"line":189,"column":18}},"43":{"start":{"line":192,"column":4},"end":{"line":192,"column":54}},"44":{"start":{"line":194,"column":4},"end":{"line":194,"column":57}},"45":{"start":{"line":197,"column":4},"end":{"line":197,"column":57}},"46":{"start":{"line":200,"column":4},"end":{"line":200,"column":62}},"47":{"start":{"line":202,"column":4},"end":{"line":202,"column":25}},"48":{"start":{"line":204,"column":2},"end":{"line":204,"column":16}},"49":{"start":{"line":207,"column":0},"end":{"line":216,"column":1}},"50":{"start":{"line":208,"column":2},"end":{"line":208,"column":17}},"51":{"start":{"line":210,"column":2},"end":{"line":210,"column":17}},"52":{"start":{"line":211,"column":2},"end":{"line":211,"column":18}},"53":{"start":{"line":212,"column":2},"end":{"line":212,"column":25}},"54":{"start":{"line":213,"column":2},"end":{"line":213,"column":16}},"55":{"start":{"line":214,"column":2},"end":{"line":214,"column":36}},"56":{"start":{"line":215,"column":2},"end":{"line":215,"column":14}},"57":{"start":{"line":218,"column":0},"end":{"line":218,"column":19}},"58":{"start":{"line":227,"column":0},"end":{"line":248,"column":1}},"59":{"start":{"line":229,"column":2},"end":{"line":229,"column":35}},"60":{"start":{"line":232,"column":2},"end":{"line":235,"column":3}},"61":{"start":{"line":234,"column":4},"end":{"line":234,"column":92}},"62":{"start":{"line":237,"column":2},"end":{"line":237,"column":9}},"63":{"start":{"line":238,"column":2},"end":{"line":238,"column":19}},"64":{"start":{"line":240,"column":2},"end":{"line":240,"column":42}},"65":{"start":{"line":242,"column":2},"end":{"line":245,"column":3}},"66":{"start":{"line":243,"column":4},"end":{"line":243,"column":35}},"67":{"start":{"line":244,"column":4},"end":{"line":244,"column":26}},"68":{"start":{"line":247,"column":2},"end":{"line":247,"column":13}},"69":{"start":{"line":258,"column":0},"end":{"line":279,"column":2}},"70":{"start":{"line":259,"column":2},"end":{"line":259,"column":29}},"71":{"start":{"line":261,"column":2},"end":{"line":278,"column":3}},"72":{"start":{"line":262,"column":4},"end":{"line":269,"column":5}},"73":{"start":{"line":263,"column":6},"end":{"line":268,"column":7}},"74":{"start":{"line":264,"column":8},"end":{"line":264,"column":44}},"75":{"start":{"line":266,"column":8},"end":{"line":266,"column":55}},"76":{"start":{"line":267,"column":8},"end":{"line":267,"column":66}},"77":{"start":{"line":271,"column":4},"end":{"line":273,"column":5}},"78":{"start":{"line":272,"column":6},"end":{"line":272,"column":30}},"79":{"start":{"line":274,"column":4},"end":{"line":276,"column":5}},"80":{"start":{"line":275,"column":6},"end":{"line":275,"column":26}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":0},"end":{"line":24,"column":0}},{"start":{"line":24,"column":0},"end":{"line":24,"column":0}}]},"2":{"line":62,"type":"binary-expr","locations":[{"start":{"line":62,"column":23},"end":{"line":62,"column":46}},{"start":{"line":62,"column":50},"end":{"line":62,"column":71}},{"start":{"line":62,"column":75},"end":{"line":62,"column":88}}]},"3":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":4}},{"start":{"line":79,"column":4},"end":{"line":79,"column":4}}]},"4":{"line":157,"type":"binary-expr","locations":[{"start":{"line":157,"column":9},"end":{"line":157,"column":23}},{"start":{"line":157,"column":28},"end":{"line":157,"column":72}}]},"5":{"line":165,"type":"if","locations":[{"start":{"line":165,"column":2},"end":{"line":165,"column":2}},{"start":{"line":165,"column":2},"end":{"line":165,"column":2}}]},"6":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":6},"end":{"line":170,"column":6}},{"start":{"line":170,"column":6},"end":{"line":170,"column":6}}]},"7":{"line":181,"type":"cond-expr","locations":[{"start":{"line":182,"column":21},"end":{"line":182,"column":53}},{"start":{"line":182,"column":54},"end":{"line":183,"column":59}}]},"8":{"line":182,"type":"cond-expr","locations":[{"start":{"line":183,"column":22},"end":{"line":183,"column":56}},{"start":{"line":183,"column":57},"end":{"line":183,"column":59}}]},"9":{"line":232,"type":"if","locations":[{"start":{"line":232,"column":2},"end":{"line":232,"column":2}},{"start":{"line":232,"column":2},"end":{"line":232,"column":2}}]},"10":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":2},"end":{"line":242,"column":2}},{"start":{"line":242,"column":2},"end":{"line":242,"column":2}}]},"11":{"line":261,"type":"if","locations":[{"start":{"line":261,"column":2},"end":{"line":261,"column":2}},{"start":{"line":261,"column":2},"end":{"line":261,"column":2}}]},"12":{"line":262,"type":"if","locations":[{"start":{"line":262,"column":4},"end":{"line":262,"column":4}},{"start":{"line":262,"column":4},"end":{"line":262,"column":4}}]},"13":{"line":263,"type":"if","locations":[{"start":{"line":263,"column":6},"end":{"line":263,"column":6}},{"start":{"line":263,"column":6},"end":{"line":263,"column":6}}]},"14":{"line":271,"type":"if","locations":[{"start":{"line":271,"column":4},"end":{"line":271,"column":4}},{"start":{"line":271,"column":4},"end":{"line":271,"column":4}}]},"15":{"line":274,"type":"if","locations":[{"start":{"line":274,"column":4},"end":{"line":274,"column":4}},{"start":{"line":274,"column":4},"end":{"line":274,"column":4}}]}},"code":["// SocketStream 0.5","// ----------------","'use strict';","","require('colors');","","var EventEmitter2 = require('eventemitter2').EventEmitter2,","    debug = require('debug')('socketstream');","","/*"," * @ngdoc overview"," * @name socketstream"," * @description"," * Public Module for Socketstream"," */","","// Get current version from package.json","var version = exports.version = require('./utils/file').loadPackageJSON().version;","","// Set root path of your project","var root = exports.root = process.cwd().replace(/\\\\/g, '/'); // replace '\\' with '/' to support Windows","","// Warn if attempting to start without a cwd (e.g. through upstart script)","if (root === '/') {","  throw new Error('You must change into the project directory before starting your SocketStream app');","}","","/**"," * @ngdoc overview"," * @name ss"," * @description"," * It reflects a similar API to the client API."," *"," * Internal API object which is passed to sub-modules and can be used within your app."," * Use with caution."," *"," * To access it without it being passed `var ss = require('socketstream').api;`"," *"," * @type {{version: *, root: *, env: string, log: (*|exports), session: exports, add: Function}}"," */","var api = exports.api = {","","  /**","   * @ngdoc property","   * @name ss.version","   * @returns {number} major.minor","   */","  version: version,","  /**","   * @ngdoc property","   * @name ss.root","   * @description","   * By default the project root is the current working directory","   * @returns {string} Project root","   */","  root: root,","  /**","   * @ngdoc property","   * @name ss.env","   * @returns {string} Execution environment type. To change set environment variable `NODE_ENV` or `SS_ENV`. 'development' by default.","   */","  env: (exports.env = (process.env['NODE_ENV'] || process.env['SS_ENV'] || 'development').toLowerCase()),","","  log: require('./utils/log'),","","  // loading http, client and ws","  load: load,","  unload: unload,","","  /**","   * @ngdoc function","   * @name ss.add","   * @param {string} name - Key in the `ss` API.","   * @param {function|number|boolean|string} fn - value or function","   * @description","   * Call from your app to safely extend the 'ss' internal API object passed through to your /server code","   */","  add: function(name, fn) {","    if (api[name]) {","      throw new Error('Unable to register internal API extension \\'' + name + '\\' as this name has already been taken');","    } else {","      api[name] = fn;","      return true;","    }","  }","};","","/**"," * Internal API for loading bundler plugins."," */","api.require = require('./utils/require')(api);","","/**"," * @ngdoc service"," * @name events"," * @description"," * Internal Event bus."," *"," * Note: only used by the ss-console module for now. This idea will be expended upon in SocketStream 0.4"," *"," * 'server:start' is emitted when the server starts. If in production the assets will be saved before the event."," */","exports.events = api.events = new EventEmitter2();","","// Session & Session Store","exports.session = api.session = require('./session')(api);","","// Publish Events","var publish = exports.publish = require('./publish')();","","// HTTP","var http = exports.http = api.http = require('./http')(api);","","// Client Asset Manager","var client = exports.client = require('./client')(api).init();","exports.livereload = api.livereload = client.livereload;","","// Tasks for Orchestrator","var tasks = exports.tasks = require('./tasks')(api, client.options);","","// This is an experimental API, expect changes","exports.task = api.task = tasks.add;","api.defaultTask = tasks.defaultTask;","","/**"," * @ngdoc service"," * @name ss.client:client"," * @function"," *"," * @description"," * Allow other libs to send assets to the client"," */","//","api.client = {send: client.assets.send, dirs: client.dirs};","","/**"," * @ngdoc service"," * @name ss.server:server"," *"," * @description"," * Server parts used while running"," */","api.server = {}; // used in tasks","","// Incoming Request Responders","exports.responders = require('./request/index')(api);","","// Websocket Layer (transport, message responders, transmit incoming events)","var ws = exports.ws = require('./websocket/index')(api);","","// Only one instance of the server can be started at once","var serverInstance = null; //TODO enforce the one server instance in tasks","","// In the future the server will just be a middleware to use","// Ensure server can only be started once","exports.start = function() {","  return serverInstance || (serverInstance = start.apply(null,arguments));","};","","var loaded = false;","","//TODO reload function that replaces API with virgin one.","//TODO server/client API tracker in RPC","function load() {","  if (!loaded) {","    var addons = [], skipped = [];","","    // load addon modules","    api.require.forEach(['socketstream-*','socketstream.*'],function(mod,id) {","      if (typeof mod === 'function') {","        try {","          mod(api);","          addons.push(id);","        } catch(ex) {","          debug('Failed to load '+id+'. ',ex);","        }","      } else {","        skipped.push(id);","      }","    });","    debug('Addons: '+","      addons.length? addons.join(' + ') + ' Loaded. ':' None. '+","      skipped.length? skipped.join(' + ') + ' Skipped. ':'');","","    // load assets in cache","    http.load();","","    // Load Client Asset Manager","    client.load();","","    // Load internal and project responders","    api.server.responders = exports.responders.load();","","    api.server.eventTransport = publish.transport.load();","","    // Extend the internal API with a publish object you can call from your own server-side code","    api.publish = publish.api(api.server.eventTransport);","","    // Bind responders to websocket","    ws.load(api.server.responders, api.server.eventTransport);","","    debug('API loaded.');","  }","  loaded = true;","}","","function unload() {","  loaded = false;","","  tasks.unload();","  client.unload();","  client.assets.unload();","  http.unload();","  api.server.responders = undefined;","  ws.unload();","}","","var exitRegistered;","","/**"," * @ngdoc function"," * @name start"," * @param {HTTPServer} server Instance of the server from the http module"," * @description"," * Starts the development or production server"," */","function start() {","","  var plan = tasks.plan(arguments);","","  // Hook in streaming if called with HTTP server","  if (plan.httpServer) {","    // depr","    api.log.error('The API has changed you can no longer create the HTTP server yourself.');","  }","","  load();","  tasks.defaults();","","  tasks.start(plan.targets,plan.callback);","","  if (!exitRegistered) {","    process.on('exit', api.unload);","    exitRegistered = true;","  }","","  return api;","}","","/**"," * @ngdoc function"," * @name set"," * @param {String} where Path in settings or '*'"," * @param {String|Object} what Value for setting or object when using star."," * @description"," * Overrides settings for root/client/server."," */","exports.set = function(where,what) {","  var path = require('path');","","  if (where === '*') {","    if (what.root) {","      if (path.isAbsolute(what.root)) {","        exports.root = api.root = what.root;","      } else {","        var scriptBase = path.dirname(process.argv[1]);","        exports.root = api.root = path.join(scriptBase,what.root);","      }","    }","","    if (what.client) {","      client.set(what.client);","    }","    if (what.http) {","      http.set(what.http);","    }","    //TODO vars, locals remembered as fallbacks","  }","};",""],"l":{"5":1,"7":1,"18":1,"21":1,"24":1,"25":0,"41":1,"79":0,"80":0,"82":0,"83":0,"91":1,"103":1,"106":1,"109":1,"112":1,"115":1,"116":1,"119":1,"122":1,"123":1,"134":1,"143":1,"146":1,"149":1,"152":1,"156":1,"157":0,"160":1,"164":1,"165":0,"166":0,"169":0,"170":0,"171":0,"172":0,"173":0,"175":0,"178":0,"181":0,"186":0,"189":0,"192":0,"194":0,"197":0,"200":0,"202":0,"204":0,"207":1,"208":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"218":1,"227":1,"229":0,"232":0,"234":0,"237":0,"238":0,"240":0,"242":0,"243":0,"244":0,"247":0,"258":1,"259":0,"261":0,"262":0,"263":0,"264":0,"266":0,"267":0,"271":0,"272":0,"274":0,"275":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/file.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/file.js","s":{"1":1,"2":1,"3":2,"4":1,"5":2,"6":2,"7":0,"8":2,"9":0,"10":0,"11":0,"12":0,"13":2,"14":2,"15":2,"16":2,"17":2,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":2,"26":2,"27":0,"28":1,"29":0,"30":0,"31":0,"32":1,"33":1,"34":1,"35":0,"36":1,"37":0,"38":1,"39":0,"40":0,"41":0,"42":0},"b":{"1":[0,2],"2":[0,2],"3":[2,0],"4":[2,0],"5":[1,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":2,"2":2,"3":1,"4":1,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"isHidden","line":30,"loc":{"start":{"line":30,"column":0},"end":{"line":30,"column":24}}},"2":{"name":"isDir","line":41,"loc":{"start":{"line":41,"column":0},"end":{"line":41,"column":31}}},"3":{"name":"(anonymous_3)","line":82,"loc":{"start":{"line":82,"column":22},"end":{"line":82,"column":38}}},"4":{"name":"(anonymous_4)","line":128,"loc":{"start":{"line":128,"column":26},"end":{"line":128,"column":37}}},"5":{"name":"(anonymous_5)","line":147,"loc":{"start":{"line":147,"column":16},"end":{"line":147,"column":35}}},"6":{"name":"(anonymous_6)","line":169,"loc":{"start":{"line":169,"column":29},"end":{"line":169,"column":48}}},"7":{"name":"(anonymous_7)","line":174,"loc":{"start":{"line":174,"column":25},"end":{"line":174,"column":40}}}},"statementMap":{"1":{"start":{"line":21,"column":0},"end":{"line":22,"column":27}},"2":{"start":{"line":30,"column":0},"end":{"line":32,"column":1}},"3":{"start":{"line":31,"column":4},"end":{"line":31,"column":37}},"4":{"start":{"line":41,"column":0},"end":{"line":69,"column":1}},"5":{"start":{"line":42,"column":4},"end":{"line":45,"column":18}},"6":{"start":{"line":47,"column":4},"end":{"line":49,"column":5}},"7":{"start":{"line":48,"column":8},"end":{"line":48,"column":38}},"8":{"start":{"line":51,"column":4},"end":{"line":67,"column":5}},"9":{"start":{"line":52,"column":8},"end":{"line":52,"column":33}},"10":{"start":{"line":55,"column":8},"end":{"line":55,"column":51}},"11":{"start":{"line":56,"column":8},"end":{"line":56,"column":51}},"12":{"start":{"line":57,"column":8},"end":{"line":57,"column":53}},"13":{"start":{"line":61,"column":8},"end":{"line":61,"column":40}},"14":{"start":{"line":62,"column":8},"end":{"line":62,"column":55}},"15":{"start":{"line":64,"column":8},"end":{"line":66,"column":9}},"16":{"start":{"line":65,"column":12},"end":{"line":65,"column":38}},"17":{"start":{"line":68,"column":4},"end":{"line":68,"column":17}},"18":{"start":{"line":82,"column":0},"end":{"line":115,"column":2}},"19":{"start":{"line":83,"column":4},"end":{"line":87,"column":13}},"20":{"start":{"line":89,"column":4},"end":{"line":114,"column":5}},"21":{"start":{"line":91,"column":8},"end":{"line":91,"column":34}},"22":{"start":{"line":94,"column":8},"end":{"line":105,"column":9}},"23":{"start":{"line":95,"column":12},"end":{"line":95,"column":49}},"24":{"start":{"line":97,"column":12},"end":{"line":102,"column":13}},"25":{"start":{"line":99,"column":16},"end":{"line":99,"column":73}},"26":{"start":{"line":101,"column":16},"end":{"line":101,"column":46}},"27":{"start":{"line":104,"column":12},"end":{"line":104,"column":72}},"28":{"start":{"line":106,"column":8},"end":{"line":106,"column":21}},"29":{"start":{"line":110,"column":8},"end":{"line":112,"column":9}},"30":{"start":{"line":111,"column":12},"end":{"line":111,"column":22}},"31":{"start":{"line":113,"column":8},"end":{"line":113,"column":21}},"32":{"start":{"line":128,"column":0},"end":{"line":134,"column":2}},"33":{"start":{"line":129,"column":4},"end":{"line":133,"column":5}},"34":{"start":{"line":130,"column":8},"end":{"line":130,"column":78}},"35":{"start":{"line":132,"column":8},"end":{"line":132,"column":83}},"36":{"start":{"line":147,"column":0},"end":{"line":149,"column":2}},"37":{"start":{"line":148,"column":4},"end":{"line":148,"column":47}},"38":{"start":{"line":169,"column":0},"end":{"line":178,"column":2}},"39":{"start":{"line":170,"column":4},"end":{"line":172,"column":51}},"40":{"start":{"line":174,"column":4},"end":{"line":176,"column":7}},"41":{"start":{"line":175,"column":8},"end":{"line":175,"column":63}},"42":{"start":{"line":177,"column":4},"end":{"line":177,"column":63}}},"branchMap":{"1":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":4}},{"start":{"line":47,"column":4},"end":{"line":47,"column":4}}]},"2":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":51,"column":4}},{"start":{"line":51,"column":4},"end":{"line":51,"column":4}}]},"3":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":8},"end":{"line":51,"column":26}},{"start":{"line":51,"column":30},"end":{"line":51,"column":74}}]},"4":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":8},"end":{"line":64,"column":8}},{"start":{"line":64,"column":8},"end":{"line":64,"column":8}}]},"5":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":8},"end":{"line":94,"column":8}},{"start":{"line":94,"column":8},"end":{"line":94,"column":8}}]},"6":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":8}},{"start":{"line":110,"column":8},"end":{"line":110,"column":8}}]},"7":{"line":175,"type":"binary-expr","locations":[{"start":{"line":175,"column":15},"end":{"line":175,"column":40}},{"start":{"line":175,"column":44},"end":{"line":175,"column":62}}]},"8":{"line":177,"type":"cond-expr","locations":[{"start":{"line":177,"column":26},"end":{"line":177,"column":55}},{"start":{"line":177,"column":58},"end":{"line":177,"column":62}}]}},"code":["'use strict';","","/**"," * @ngdoc service"," * @name utils"," * @function"," *"," * @description"," * Contains utils modules for working with file system and some additional helpers"," */","","/**"," * @ngdoc service"," * @name utils.file:file"," * @function"," *"," * @description"," * This is used to maintain lists of userIds to socketIds and channelIds to socketIds"," */","","var fs = require('fs'),","    path = require('path');","","/**"," * Identifies if the path is hidden"," *"," * @param  {String}  path"," * @return {Boolean}"," */","function isHidden(path) {","    return path.match(/(^_|^\\.|~$)/);","}","","/**"," * Identifies if the path is directory"," *"," * @param  {String}  abspath   Absolute path, should be already have replaced '\\' with '/' to support Windows"," * @param  {Object}  found     Object: {dirs: [], files: [] }, contains information about directory's files and subdirectories"," * @return {Object}            Updated 'found' object"," */","function isDir(abspath, found) {","    var stat       = fs.statSync(abspath),","        abspathAry = abspath.split('/'),","        data,","        file_name;","","    if (!found) {","        found = {dirs: [], files: [] }","    }","","    if (stat.isDirectory() && !isHidden(abspathAry[abspathAry.length - 1])) {","        found.dirs.push(abspath);","","        /* If we found a directory, recurse! */","        data        = exports.readDirSync(abspath);","        found.dirs  = found.dirs.concat(data.dirs);","        found.files = found.files.concat(data.files);","","    } else {","","        abspathAry = abspath.split('/');","        file_name  = abspathAry[abspathAry.length - 1];","","        if (!isHidden(file_name)) {","            found.files.push(abspath);","        }","    }","    return found;","}","","/**"," * @ngdoc service"," * @name utils.file#readDirSync"," * @methodOf utils.file:file"," * @function"," *"," * @description"," * Reads the contents of a dir. Adapted from https://gist.github.com/825583"," *"," * @param {String} start Directory absolute path to lookup"," */","exports.readDirSync = function(start) {","    var stat,","        found = {dirs: [], files: [] },","        files,","        abspath,","        x, l;","","    try {","        /* Use lstat to resolve symlink if we are passed a symlink */","        stat = fs.lstatSync(start)","","        /* Read through all the files in this directory */","        if (stat.isDirectory()) {","            files = fs.readdirSync(start).sort();","","            for (x = 0, l = files.length; x < l; x++) {","                /* replace '\\' with '/' to support Windows */","                abspath = path.join(start, files[x]).replace(/\\\\/g, '/');","","                found = isDir(abspath, found);","            }","        } else {","            throw (new Error('path: ' + start + ' is not a directory'));","        }","        return found;","","    } catch (e) {","        /* Ignore if optional dirs are missing */","        if (e.code !== 'ENOENT') {","            throw (e);","        }","        return false;","    }","};","","/**"," * @ngdoc service"," * @name utils.file#loadPackageJSON"," * @methodOf utils.file:file"," * @function"," *"," * @description"," * Loads SocketStream's package.json file from the root directory"," *"," * @return {Object|Error} JSON object or thorws an eror if unable to find or parse SocketStream's package.json file"," */","exports.loadPackageJSON = function() {","    try {","        return JSON.parse(fs.readFileSync(__dirname + '/../../package.json'));","    } catch (e) {","        throw ('Error: Unable to find or parse SocketStream\\'s package.json file');","    }","};","","/**"," * @ngdoc service"," * @name utils.file#isDir"," * @methodOf utils.file:file"," * @function"," *"," * @description"," * In synchronous mode returns if givven `filePath` is directory or not"," *"," * @return {Boolean} TRUE if givven `filePath` is dorectory"," */","exports.isDir = function(filePath) {","    return fs.statSync(filePath).isDirectory();","};","","/**"," * @ngdoc service"," * @name utils.file#findExtForBasePath"," * @methodOf utils.file:file"," * @function"," *"," * @description"," * Given a basename, find a matching file with an extension."," *"," * @example:"," * <pre>"," *   findExtForBase('views/main')       => '.jade'"," *   findExtForBase('css/i-dont-exist') => null"," * </pre>"," *"," * @param {Object} basepath Path to directory"," * @returns {Array|null} Array of files or `null`"," */","exports.findExtForBasePath = function(basepath) {","    var files = fs.readdirSync(path.join(basepath, '..')),","        basename = path.basename(basepath),","        basenameRegex = new RegExp('^' + basename);","","    files = files.filter(function(file) {","        return file.match(basenameRegex) && path.extname(file);","    });","    return files.length ? path.extname(files.sort()[0]) : null;","};"],"l":{"21":1,"30":1,"31":2,"41":1,"42":2,"47":2,"48":0,"51":2,"52":0,"55":0,"56":0,"57":0,"61":2,"62":2,"64":2,"65":2,"68":2,"82":1,"83":1,"89":1,"91":1,"94":1,"95":1,"97":1,"99":2,"101":2,"104":0,"106":1,"110":0,"111":0,"113":0,"128":1,"129":1,"130":1,"132":0,"147":1,"148":0,"169":1,"170":0,"174":0,"175":0,"177":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/log.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/log.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":30,"loc":{"start":{"line":30,"column":16},"end":{"line":30,"column":27}}},"2":{"name":"clientIssue","line":113,"loc":{"start":{"line":113,"column":22},"end":{"line":113,"column":68}}},"3":{"name":"(anonymous_3)","line":131,"loc":{"start":{"line":131,"column":9},"end":{"line":131,"column":20}}},"4":{"name":"(anonymous_4)","line":136,"loc":{"start":{"line":136,"column":9},"end":{"line":136,"column":20}}}},"statementMap":{"1":{"start":{"line":30,"column":0},"end":{"line":31,"column":2}},"2":{"start":{"line":52,"column":0},"end":{"line":52,"column":28}},"3":{"start":{"line":69,"column":0},"end":{"line":69,"column":27}},"4":{"start":{"line":91,"column":0},"end":{"line":91,"column":27}},"5":{"start":{"line":109,"column":0},"end":{"line":109,"column":30}},"6":{"start":{"line":111,"column":0},"end":{"line":111,"column":45}},"7":{"start":{"line":113,"column":0},"end":{"line":144,"column":2}},"8":{"start":{"line":114,"column":2},"end":{"line":114,"column":18}},"9":{"start":{"line":115,"column":2},"end":{"line":117,"column":3}},"10":{"start":{"line":116,"column":4},"end":{"line":116,"column":24}},"11":{"start":{"line":118,"column":2},"end":{"line":118,"column":25}},"12":{"start":{"line":119,"column":2},"end":{"line":119,"column":33}},"13":{"start":{"line":120,"column":2},"end":{"line":122,"column":3}},"14":{"start":{"line":121,"column":4},"end":{"line":121,"column":56}},"15":{"start":{"line":123,"column":2},"end":{"line":126,"column":3}},"16":{"start":{"line":124,"column":4},"end":{"line":124,"column":23}},"17":{"start":{"line":125,"column":4},"end":{"line":125,"column":36}},"18":{"start":{"line":128,"column":2},"end":{"line":128,"column":33}},"19":{"start":{"line":130,"column":2},"end":{"line":134,"column":5}},"20":{"start":{"line":132,"column":6},"end":{"line":132,"column":74}},"21":{"start":{"line":135,"column":2},"end":{"line":139,"column":5}},"22":{"start":{"line":137,"column":6},"end":{"line":137,"column":72}},"23":{"start":{"line":141,"column":2},"end":{"line":141,"column":96}},"24":{"start":{"line":143,"column":2},"end":{"line":143,"column":16}}},"branchMap":{"1":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":2},"end":{"line":115,"column":2}},{"start":{"line":115,"column":2},"end":{"line":115,"column":2}}]},"2":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":2},"end":{"line":120,"column":2}},{"start":{"line":120,"column":2},"end":{"line":120,"column":2}}]},"3":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":2},"end":{"line":123,"column":2}},{"start":{"line":123,"column":2},"end":{"line":123,"column":2}}]},"4":{"line":132,"type":"cond-expr","locations":[{"start":{"line":132,"column":28},"end":{"line":132,"column":54}},{"start":{"line":132,"column":57},"end":{"line":132,"column":73}}]},"5":{"line":137,"type":"cond-expr","locations":[{"start":{"line":137,"column":28},"end":{"line":137,"column":52}},{"start":{"line":137,"column":55},"end":{"line":137,"column":71}}]}},"code":["'use strict';","/**"," * @ngdoc service"," * @name ss.log:log"," * @function"," *"," * @description"," * Contains method stubs for logging to console (by default) or"," * whatever logging provider you choose."," */","","","","","/**"," * @ngdoc function"," * @name ss.log#trace"," * @methodOf ss.log:log"," * @function"," * @description"," * Trace function calls in socketstream and plugins. By default nothing is done."," * If you want to switch on tracing override the `trace` method."," * ```"," * var ss = require('socketstream');"," * ss.api.log.trace = function() {"," * console.log.apply(console,arguments);"," * };"," * ```"," */","exports.trace = function() {","};","","/**"," * @ngdoc function"," * @name ss.log#debug"," * @methodOf ss.log:log"," * @function"," *"," * @description"," * Debug level logging, uses console.log by default. Override by assigning a"," * function that takes the same parameters as console.log:"," * ```"," * var ss = require('socketstream');"," * ss.api.log.debug = console.log;"," * ```"," *"," * @example"," * ```"," * ss.log.debug(\"Something fairly trivial happened\");"," * ```"," */","exports.debug = console.log;","","/**"," * @ngdoc service"," * @name ss.log#info"," * @methodOf ss.log:log"," * @function"," *"," * @description"," * Info level logging, uses console.log by default. Override by assigning a"," * function that takes the same parameters as console.log."," *"," * @example"," * ```"," * ss.log.info(\"Just keeping you informed\");"," * ```"," */","exports.info = console.log;","","/**"," * @ngdoc function"," * @name ss.log#warn"," * @methodOf ss.log:log"," * @function"," *"," * @description"," * Warn level logging, uses console.log by default. Override by assigning a"," * function that takes the same parameters as console.log:"," * ```"," * var ss = require('socketstream'),"," *     winston = require('winston');"," * ss.log.warn = winston.warn;"," * ```"," *"," * @example"," * ```"," * ss.log.warn(\"Something unexpected happened!\");"," * ```"," */","exports.warn = console.log;","","","/**"," * @ngdoc function"," * @name ss.log#error"," * @methodOf ss.log:log"," * @function"," *"," * @description"," * Error level logging, uses console.error by default. Override by assigning a"," * function that takes the same parameters as console.error."," *"," * @example"," * ```"," * ss.log.error(\"Time to wakeup the sysadmin\");"," * ```"," */","exports.error = console.error;","","var nextClientIssue = (new Date()).getTime();","","exports.clientIssue = function clientIssue(client,options,err,more) {","  var info = [''];","  if (options.serveDebugInfo) {","    err.userInfo = info;","  }","  info.push(err.message);","  info.push('client='+client.id);","  if (err.stack) {","    info = info.concat(err.stack.split('\\n').splice(1));","  }","  if (more) {","    info.push('more:');","    info.push(JSON.stringify(more));","  }","","  var number = nextClientIssue++;","","  Object.defineProperty(err, 'userInfoHTML', {","    get: function() {","      return this.userInfo? this.userInfo.join('<br>') : ' issue='+number;","    }","  });","  Object.defineProperty(err, 'userInfoText', {","    get: function() {","      return this.userInfo? this.userInfo.join('\\n') : ' issue='+number;","    }","  });","","  this.error(('Couldn\\'t serve client '+client.name+',').red, 'issue='+number, info.join('\\n'));","","  return number;","};","",""],"l":{"30":1,"52":1,"69":1,"91":1,"109":1,"111":1,"113":1,"114":0,"115":0,"116":0,"118":0,"119":0,"120":0,"121":0,"123":0,"124":0,"125":0,"128":0,"130":0,"132":0,"135":0,"137":0,"141":0,"143":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/require.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/require.js","s":{"1":1,"2":1,"3":1,"4":17,"5":17,"6":4,"7":4,"8":17,"9":4,"10":4,"11":1,"12":4,"13":4,"14":4,"15":4,"16":17,"17":0,"18":0,"19":0,"20":17,"21":4,"22":4,"23":4,"24":13,"25":0,"26":0,"27":0,"28":0,"29":13,"30":13,"31":3,"32":3,"33":10,"34":10,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":10,"43":0,"44":10,"45":1,"46":0,"47":1,"48":1,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":1,"62":1,"63":1,"64":13,"65":13,"66":13,"67":13,"68":13,"69":3},"b":{"1":[4,13],"2":[4,13],"3":[1,3],"4":[4,0],"5":[0,0,17],"6":[0,0],"7":[4,13],"8":[4,0],"9":[0,13],"10":[0,0],"11":[3,10],"12":[0,10],"13":[10,0],"14":[0,0],"15":[0,0],"16":[0,10],"17":[0,0],"18":[0,0],"19":[0,0]},"f":{"1":1,"2":17,"3":4,"4":0,"5":0,"6":0,"7":13},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":17},"end":{"line":11,"column":30}}},"2":{"name":"requires","line":27,"loc":{"start":{"line":27,"column":1},"end":{"line":27,"column":47}}},"3":{"name":"(anonymous_3)","line":39,"loc":{"start":{"line":39,"column":16},"end":{"line":39,"column":29}}},"4":{"name":"resolves","line":105,"loc":{"start":{"line":105,"column":1},"end":{"line":105,"column":23}}},"5":{"name":"forEach","line":111,"loc":{"start":{"line":111,"column":1},"end":{"line":111,"column":30}}},"6":{"name":"(anonymous_6)","line":118,"loc":{"start":{"line":118,"column":19},"end":{"line":118,"column":32}}},"7":{"name":"projectOrHereRequire","line":138,"loc":{"start":{"line":138,"column":0},"end":{"line":138,"column":39}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":9,"column":15}},"2":{"start":{"line":11,"column":0},"end":{"line":135,"column":2}},"3":{"start":{"line":27,"column":1},"end":{"line":103,"column":2}},"4":{"start":{"line":28,"column":2},"end":{"line":28,"column":24}},"5":{"start":{"line":29,"column":2},"end":{"line":32,"column":3}},"6":{"start":{"line":30,"column":3},"end":{"line":30,"column":24}},"7":{"start":{"line":31,"column":3},"end":{"line":31,"column":20}},"8":{"start":{"line":33,"column":2},"end":{"line":49,"column":5}},"9":{"start":{"line":34,"column":3},"end":{"line":34,"column":35}},"10":{"start":{"line":35,"column":3},"end":{"line":48,"column":4}},"11":{"start":{"line":36,"column":4},"end":{"line":47,"column":6}},"12":{"start":{"line":40,"column":6},"end":{"line":45,"column":20}},"13":{"start":{"line":41,"column":7},"end":{"line":41,"column":44}},"14":{"start":{"line":42,"column":7},"end":{"line":44,"column":8}},"15":{"start":{"line":43,"column":8},"end":{"line":43,"column":26}},"16":{"start":{"line":51,"column":4},"end":{"line":82,"column":5}},"17":{"start":{"line":54,"column":8},"end":{"line":56,"column":9}},"18":{"start":{"line":55,"column":10},"end":{"line":55,"column":20}},"19":{"start":{"line":57,"column":8},"end":{"line":57,"column":14}},"20":{"start":{"line":59,"column":8},"end":{"line":64,"column":9}},"21":{"start":{"line":61,"column":10},"end":{"line":61,"column":48}},"22":{"start":{"line":62,"column":10},"end":{"line":62,"column":46}},"23":{"start":{"line":62,"column":27},"end":{"line":62,"column":44}},"24":{"start":{"line":67,"column":8},"end":{"line":73,"column":9}},"25":{"start":{"line":68,"column":10},"end":{"line":68,"column":48}},"26":{"start":{"line":69,"column":10},"end":{"line":72,"column":11}},"27":{"start":{"line":70,"column":12},"end":{"line":70,"column":31}},"28":{"start":{"line":71,"column":12},"end":{"line":71,"column":38}},"29":{"start":{"line":76,"column":8},"end":{"line":76,"column":51}},"30":{"start":{"line":77,"column":8},"end":{"line":80,"column":9}},"31":{"start":{"line":78,"column":10},"end":{"line":78,"column":59}},"32":{"start":{"line":79,"column":10},"end":{"line":79,"column":30}},"33":{"start":{"line":81,"column":8},"end":{"line":81,"column":14}},"34":{"start":{"line":84,"column":2},"end":{"line":95,"column":3}},"35":{"start":{"line":86,"column":3},"end":{"line":86,"column":55}},"36":{"start":{"line":87,"column":3},"end":{"line":87,"column":53}},"37":{"start":{"line":87,"column":27},"end":{"line":87,"column":51}},"38":{"start":{"line":90,"column":3},"end":{"line":90,"column":49}},"39":{"start":{"line":91,"column":3},"end":{"line":94,"column":4}},"40":{"start":{"line":92,"column":4},"end":{"line":92,"column":60}},"41":{"start":{"line":93,"column":4},"end":{"line":93,"column":24}},"42":{"start":{"line":97,"column":2},"end":{"line":101,"column":3}},"43":{"start":{"line":98,"column":3},"end":{"line":100,"column":6}},"44":{"start":{"line":102,"column":2},"end":{"line":102,"column":80}},"45":{"start":{"line":105,"column":1},"end":{"line":107,"column":2}},"46":{"start":{"line":106,"column":2},"end":{"line":106,"column":42}},"47":{"start":{"line":109,"column":1},"end":{"line":109,"column":29}},"48":{"start":{"line":111,"column":1},"end":{"line":130,"column":2}},"49":{"start":{"line":112,"column":2},"end":{"line":112,"column":58}},"50":{"start":{"line":113,"column":2},"end":{"line":129,"column":3}},"51":{"start":{"line":114,"column":3},"end":{"line":114,"column":56}},"52":{"start":{"line":115,"column":3},"end":{"line":115,"column":63}},"53":{"start":{"line":116,"column":3},"end":{"line":116,"column":50}},"54":{"start":{"line":117,"column":3},"end":{"line":117,"column":16}},"55":{"start":{"line":118,"column":3},"end":{"line":128,"column":6}},"56":{"start":{"line":119,"column":4},"end":{"line":127,"column":5}},"57":{"start":{"line":120,"column":5},"end":{"line":126,"column":6}},"58":{"start":{"line":121,"column":6},"end":{"line":121,"column":76}},"59":{"start":{"line":122,"column":6},"end":{"line":122,"column":52}},"60":{"start":{"line":123,"column":6},"end":{"line":123,"column":30}},"61":{"start":{"line":132,"column":1},"end":{"line":132,"column":28}},"62":{"start":{"line":134,"column":1},"end":{"line":134,"column":17}},"63":{"start":{"line":138,"column":0},"end":{"line":160,"column":1}},"64":{"start":{"line":139,"column":1},"end":{"line":147,"column":2}},"65":{"start":{"line":140,"column":2},"end":{"line":144,"column":5}},"66":{"start":{"line":149,"column":1},"end":{"line":149,"column":43}},"67":{"start":{"line":150,"column":1},"end":{"line":159,"column":2}},"68":{"start":{"line":151,"column":2},"end":{"line":155,"column":5}},"69":{"start":{"line":156,"column":2},"end":{"line":156,"column":11}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"2":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":2},"end":{"line":33,"column":2}},{"start":{"line":33,"column":2},"end":{"line":33,"column":2}}]},"3":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":3},"end":{"line":35,"column":3}},{"start":{"line":35,"column":3},"end":{"line":35,"column":3}}]},"4":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":7},"end":{"line":42,"column":7}},{"start":{"line":42,"column":7},"end":{"line":42,"column":7}}]},"5":{"line":51,"type":"switch","locations":[{"start":{"line":52,"column":6},"end":{"line":52,"column":20}},{"start":{"line":53,"column":6},"end":{"line":57,"column":14}},{"start":{"line":58,"column":6},"end":{"line":81,"column":14}}]},"6":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":54,"column":8}},{"start":{"line":54,"column":8},"end":{"line":54,"column":8}}]},"7":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":59,"column":8}},{"start":{"line":59,"column":8},"end":{"line":59,"column":8}}]},"8":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":10},"end":{"line":62,"column":10}},{"start":{"line":62,"column":10},"end":{"line":62,"column":10}}]},"9":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":8},"end":{"line":67,"column":8}},{"start":{"line":67,"column":8},"end":{"line":67,"column":8}}]},"10":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":10},"end":{"line":69,"column":10}},{"start":{"line":69,"column":10},"end":{"line":69,"column":10}}]},"11":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":8},"end":{"line":77,"column":8}},{"start":{"line":77,"column":8},"end":{"line":77,"column":8}}]},"12":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":2},"end":{"line":84,"column":2}},{"start":{"line":84,"column":2},"end":{"line":84,"column":2}}]},"13":{"line":84,"type":"binary-expr","locations":[{"start":{"line":84,"column":6},"end":{"line":84,"column":13}},{"start":{"line":84,"column":17},"end":{"line":84,"column":26}}]},"14":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":3},"end":{"line":87,"column":3}},{"start":{"line":87,"column":3},"end":{"line":87,"column":3}}]},"15":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":3},"end":{"line":91,"column":3}},{"start":{"line":91,"column":3},"end":{"line":91,"column":3}}]},"16":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":2},"end":{"line":97,"column":2}},{"start":{"line":97,"column":2},"end":{"line":97,"column":2}}]},"17":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":2},"end":{"line":113,"column":2}},{"start":{"line":113,"column":2},"end":{"line":113,"column":2}}]},"18":{"line":115,"type":"cond-expr","locations":[{"start":{"line":115,"column":32},"end":{"line":115,"column":57}},{"start":{"line":115,"column":60},"end":{"line":115,"column":62}}]},"19":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":4},"end":{"line":119,"column":4}},{"start":{"line":119,"column":4},"end":{"line":119,"column":4}}]}},"code":["'use strict';","","var path = require('path'),","\tfs = require('fs'),","\tfindup = require('findup-sync'),","\tresolve = require('resolve'),","\tmicromatch = require('micromatch'),","\tdebug = require('debug')('require'),","\tcontexts = {};","","module.exports = function(ss) {","\t/*","\t * Require a module by id that is located.","\t * - builtin module in context","\t * - module relative to app.js","\t * - module in socketstream, in project or above","\t * - the default module","\t *","\t * Currently only support .js files","\t *","\t * Currently doesn't cache anything. It could cache builtin names.","\t * Or it could remember the result of a call.","","\t * @param {function} callback The third parameter can be a callback function called when the","\t module isn't found. If it returns something that will be the resolved module.","\t */","\tfunction requires(id, contextPath, defaultId) {","\t\tvar context, callback;","\t\tif (typeof defaultId === 'function') {","\t\t\tcallback = defaultId;","\t\t\tdefaultId = null;","\t\t}","\t\tif (contextPath) {","\t\t\tcontext = contexts[contextPath];","\t\t\tif (context === undefined) {","\t\t\t\tcontext = contexts[contextPath] = {","\t\t\t\t\trel : context,","\t\t\t\t\tprefix: path.join(__dirname, '..', contextPath),","\t\t\t\t\tinContext: function(id) {","\t\t\t\t\t\ttry {","\t\t\t\t\t\t\tvar p = path.join(context.prefix,id);","\t\t\t\t\t\t\tif (require.resolve(p)) { // gives full path","\t\t\t\t\t\t\t\treturn require(p);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t} catch(ex) {}","\t\t\t\t\t}","\t\t\t\t};","\t\t\t}","    }","","    switch(typeof id) {","      case 'object':","      case 'function':","        if (id) {","          return id; // straight object/function will just resolve straight away","        }","        break;","      case 'string':","        if (context) {","          // builtin modules take first priority","          var inContext = context.inContext(id);","          if (inContext) { return inContext; }","","        }","","        // if relative base on main script location","        if (id.charAt(0) === '.') {","          var inProject = path.join(ss.root,id);","          if (fs.existsSync(inProject+'.js')) {","            debug('found '+id);","            return require(inProject);","          }","        }","","        // getting a packaged module","        var mod = projectOrHereRequire(id,ss.root);","        if (mod) {","          debug('found '+id+' in project or SocketStream');","          return require(mod);","        }","        break;","    }","","\t\tif (context && defaultId) {","\t\t\t// default looked up in context first","\t\t\tvar defaultInContext = context.inContext(defaultId);","\t\t\tif (defaultInContext) { return defaultInContext; }","","\t\t\t// all bets are off","\t\t\tmod = projectOrHereRequire(defaultId,ss.root);","\t\t\tif (mod) {","\t\t\t\tdebug('found '+defaultId+' in project or SocketStream');","\t\t\t\treturn require(mod);","\t\t\t}","\t\t}","","\t\tif (callback) {","\t\t\treturn callback({","\t\t\t\tid:id","\t\t\t});","\t\t}","\t\tthrow new Error('Cannot find module \"' + id + '\" in socketstream or project');","\t}","","\tfunction resolves(id) {","\t\treturn projectOrHereRequire(id,ss.root);","\t}","","\trequires.resolve = resolves;","","\tfunction forEach(pattern,fn) {","\t\tvar packageJSON = findup('package.json', {cwd:ss.root});","\t\tif (packageJSON) {","\t\t\tvar dependencies = require(packageJSON).dependencies;","\t\t\tdependencies = dependencies? Object.keys(dependencies) : [];","\t\t\tvar matches = micromatch(dependencies,pattern);","\t\t\tvar mod = {};","\t\t\tmatches.forEach(function(id) {","\t\t\t\tif (mod[id] === undefined) {","\t\t\t\t\ttry {","\t\t\t\t\t\tmod[id] = resolve.sync(id, { package: packageJSON, basedir: ss.root});","\t\t\t\t\t\tdebug('matched '+id+' from pattern '+pattern);","\t\t\t\t\t\tfn(require(mod[id]),id);","\t\t\t\t\t} catch(ex) {","\t\t\t\t\t\t//TODO debug log failed to use SocketStream Add-On","\t\t\t\t\t}","\t\t\t\t}","\t\t\t});","\t\t}","\t}","","\trequires.forEach = forEach;","","\treturn requires;","};","","// return path to found, project first","function projectOrHereRequire(id,root) {","\ttry {","\t\treturn resolve.sync(id, {","\t\t\tpackage: path.join(root,'package.json'),","\t\t\tpaths: [root],","\t\t\tbasedir:root","\t\t});","\t} catch(ex) {","\t\t// console.error(ex);","\t}","","\tvar here = path.join(__dirname,'..','..');","\ttry {","\t\tvar p = resolve.sync(id, {","\t\t\tpackage: path.join(here,'package.json'),","\t\t\tpaths: [here],","\t\t\tbasedir:here","\t\t});","\t\treturn p;","\t} catch(ex) {","\t\t// console.error(ex);","\t}","}",""],"l":{"3":1,"11":1,"27":1,"28":17,"29":17,"30":4,"31":4,"33":17,"34":4,"35":4,"36":1,"40":4,"41":4,"42":4,"43":4,"51":17,"54":0,"55":0,"57":0,"59":17,"61":4,"62":4,"67":13,"68":0,"69":0,"70":0,"71":0,"76":13,"77":13,"78":3,"79":3,"81":10,"84":10,"86":0,"87":0,"90":0,"91":0,"92":0,"93":0,"97":10,"98":0,"102":10,"105":1,"106":0,"109":1,"111":1,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"132":1,"134":1,"138":1,"139":13,"140":13,"149":13,"150":13,"151":13,"156":3}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":17},"end":{"line":26,"column":30}}},"2":{"name":"(anonymous_2)","line":39,"loc":{"start":{"line":39,"column":17},"end":{"line":39,"column":37}}},"3":{"name":"(anonymous_3)","line":50,"loc":{"start":{"line":50,"column":12},"end":{"line":50,"column":23}}},"4":{"name":"(anonymous_4)","line":60,"loc":{"start":{"line":60,"column":10},"end":{"line":60,"column":44}}},"5":{"name":"(anonymous_5)","line":61,"loc":{"start":{"line":61,"column":45},"end":{"line":61,"column":68}}},"6":{"name":"(anonymous_6)","line":74,"loc":{"start":{"line":74,"column":28},"end":{"line":74,"column":49}}},"7":{"name":"(anonymous_7)","line":76,"loc":{"start":{"line":76,"column":17},"end":{"line":76,"column":28}}},"8":{"name":"(anonymous_8)","line":89,"loc":{"start":{"line":89,"column":32},"end":{"line":89,"column":43}}},"9":{"name":"(anonymous_9)","line":98,"loc":{"start":{"line":98,"column":23},"end":{"line":98,"column":36}}},"10":{"name":"(anonymous_10)","line":106,"loc":{"start":{"line":106,"column":31},"end":{"line":106,"column":49}}},"11":{"name":"(anonymous_11)","line":117,"loc":{"start":{"line":117,"column":11},"end":{"line":117,"column":42}}},"12":{"name":"(anonymous_12)","line":126,"loc":{"start":{"line":126,"column":11},"end":{"line":126,"column":22}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":11,"column":18}},"2":{"start":{"line":13,"column":0},"end":{"line":16,"column":35}},"3":{"start":{"line":22,"column":0},"end":{"line":24,"column":68}},"4":{"start":{"line":26,"column":0},"end":{"line":143,"column":2}},"5":{"start":{"line":28,"column":2},"end":{"line":140,"column":4}},"6":{"start":{"line":40,"column":6},"end":{"line":40,"column":43}},"7":{"start":{"line":41,"column":6},"end":{"line":41,"column":41}},"8":{"start":{"line":51,"column":6},"end":{"line":51,"column":32}},"9":{"start":{"line":52,"column":6},"end":{"line":52,"column":38}},"10":{"start":{"line":53,"column":6},"end":{"line":53,"column":44}},"11":{"start":{"line":54,"column":6},"end":{"line":54,"column":23}},"12":{"start":{"line":61,"column":6},"end":{"line":103,"column":9}},"13":{"start":{"line":65,"column":8},"end":{"line":70,"column":9}},"14":{"start":{"line":66,"column":10},"end":{"line":66,"column":47}},"15":{"start":{"line":67,"column":10},"end":{"line":67,"column":52}},"16":{"start":{"line":69,"column":10},"end":{"line":69,"column":59}},"17":{"start":{"line":73,"column":8},"end":{"line":73,"column":58}},"18":{"start":{"line":74,"column":8},"end":{"line":86,"column":10}},"19":{"start":{"line":75,"column":10},"end":{"line":77,"column":11}},"20":{"start":{"line":76,"column":12},"end":{"line":76,"column":31}},"21":{"start":{"line":78,"column":10},"end":{"line":84,"column":11}},"22":{"start":{"line":79,"column":12},"end":{"line":79,"column":33}},"23":{"start":{"line":80,"column":12},"end":{"line":80,"column":33}},"24":{"start":{"line":81,"column":17},"end":{"line":84,"column":11}},"25":{"start":{"line":82,"column":12},"end":{"line":82,"column":61}},"26":{"start":{"line":83,"column":12},"end":{"line":83,"column":31}},"27":{"start":{"line":85,"column":10},"end":{"line":85,"column":31}},"28":{"start":{"line":89,"column":8},"end":{"line":97,"column":10}},"29":{"start":{"line":90,"column":10},"end":{"line":92,"column":11}},"30":{"start":{"line":91,"column":12},"end":{"line":91,"column":61}},"31":{"start":{"line":93,"column":10},"end":{"line":95,"column":11}},"32":{"start":{"line":94,"column":12},"end":{"line":94,"column":44}},"33":{"start":{"line":96,"column":10},"end":{"line":96,"column":22}},"34":{"start":{"line":98,"column":8},"end":{"line":100,"column":10}},"35":{"start":{"line":99,"column":10},"end":{"line":99,"column":58}},"36":{"start":{"line":101,"column":8},"end":{"line":101,"column":32}},"37":{"start":{"line":102,"column":8},"end":{"line":102,"column":27}},"38":{"start":{"line":107,"column":6},"end":{"line":109,"column":7}},"39":{"start":{"line":108,"column":8},"end":{"line":108,"column":118}},"40":{"start":{"line":110,"column":6},"end":{"line":110,"column":78}},"41":{"start":{"line":111,"column":6},"end":{"line":111,"column":42}},"42":{"start":{"line":112,"column":6},"end":{"line":112,"column":16}},"43":{"start":{"line":118,"column":8},"end":{"line":118,"column":23}},"44":{"start":{"line":119,"column":8},"end":{"line":119,"column":92}},"45":{"start":{"line":122,"column":8},"end":{"line":124,"column":23}},"46":{"start":{"line":127,"column":8},"end":{"line":136,"column":9}},"47":{"start":{"line":130,"column":10},"end":{"line":132,"column":11}},"48":{"start":{"line":131,"column":12},"end":{"line":131,"column":33}},"49":{"start":{"line":134,"column":10},"end":{"line":134,"column":47}},"50":{"start":{"line":135,"column":10},"end":{"line":135,"column":58}},"51":{"start":{"line":137,"column":8},"end":{"line":137,"column":28}},"52":{"start":{"line":142,"column":2},"end":{"line":142,"column":13}}},"branchMap":{"1":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":65,"column":8}},{"start":{"line":65,"column":8},"end":{"line":65,"column":8}}]},"2":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":10},"end":{"line":75,"column":10}},{"start":{"line":75,"column":10},"end":{"line":75,"column":10}}]},"3":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":10},"end":{"line":78,"column":10}},{"start":{"line":78,"column":10},"end":{"line":78,"column":10}}]},"4":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":17},"end":{"line":81,"column":17}},{"start":{"line":81,"column":17},"end":{"line":81,"column":17}}]},"5":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":10},"end":{"line":90,"column":10}},{"start":{"line":90,"column":10},"end":{"line":90,"column":10}}]},"6":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":10},"end":{"line":93,"column":10}},{"start":{"line":93,"column":10},"end":{"line":93,"column":10}}]},"7":{"line":93,"type":"binary-expr","locations":[{"start":{"line":93,"column":15},"end":{"line":93,"column":31}},{"start":{"line":93,"column":36},"end":{"line":93,"column":63}}]},"8":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":6},"end":{"line":107,"column":6}},{"start":{"line":107,"column":6},"end":{"line":107,"column":6}}]},"9":{"line":119,"type":"cond-expr","locations":[{"start":{"line":119,"column":74},"end":{"line":119,"column":81}},{"start":{"line":119,"column":82},"end":{"line":119,"column":90}}]},"10":{"line":122,"type":"cond-expr","locations":[{"start":{"line":123,"column":11},"end":{"line":123,"column":81}},{"start":{"line":124,"column":10},"end":{"line":124,"column":21}}]},"11":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":8},"end":{"line":127,"column":8}},{"start":{"line":127,"column":8},"end":{"line":127,"column":8}}]},"12":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":10},"end":{"line":130,"column":10}},{"start":{"line":130,"column":10},"end":{"line":130,"column":10}}]}},"code":["// Sessions","// --------","// Creates a wrapper around a Connect Session Store object","'use strict';","","var channels = require('./channels'),","    subscriptions = require('../websocket/subscriptions'),","    uuid = require('uuid'),","    debug = require('debug')('socketstream:session'),","    sessionStore,","    strategy = {};","","var Store = require('./store'),","    MemoryStore = require('./memory'),","    Cookie = require('./cookie'),","    Session = require('./session');","","/**"," * Warning message for `MemoryStore` usage in production."," * @private"," */","var warning = ['Warning: connect.session() MemoryStore is not',","    'designed for a production environment, as it will leak',","    'memory, and will not scale past a single process.'].join('\\n');","","module.exports = function(ss) {","","  var api = {","","    // Expose options which can be changed in your app","    options: {","      maxAge: null, // by default session exists for duration of user agent (e.g. until browser is closed)","      secret: \"SocketStream\" //TODO add config todo for dev time logging","    },","    //TODO config point for ss.session.options.cookie","","    strategy: strategy,","","    setStrategy: function(_strategy) {","      this.strategy = strategy = _strategy;","      debug('session strategy defined.');","    },","","    Store: Store,","    MemoryStore: MemoryStore,","    Cookie: Cookie,","    Session: Session,","","    // Manually create a new session (for running server-side tests, or calling responders from ss-console)","    create: function() {","      var sessionId = uuid.v1();","      this.strategy.create(sessionId);","      debug('created session %s',sessionId);","      return sessionId;","    },","","    // Find a session from the Connect Session Store","    // Note: Sessions are automatically created by the connect.session()","    // middleware when the browser makes a HTTP request","    find: function(sessionId, socketId, cb) {","      return api.store.get().load(sessionId, function(err, session) {","        // Create a new session if we don't have this sessionId in memory","        // Note: in production you should be using Redis or another","        // persistent store so this should rarely happen","        if (!session) {","          session = strategy.create(sessionId);","          debug('created session for %s',sessionId);","        } else {","          debug('using existing session for %s',sessionId);","        }","","        // Append methods to session object","        session.channel = channels(ss, session, socketId);","        session.setUserId = function(userId, cb) {","          if (!cb) {","            cb = function() {};","          }","          if (userId) {","            this.userId = userId;","            this._bindToSocket();","          } else if (this.userId) {  // if null (i.e. user has signed out)","            subscriptions.user.remove(this.userId, socketId);","            delete this.userId;","          }","          return this.save(cb);","        };","","        // Bind username and any channel subscriptions to this socketID on each request","        session._bindToSocket = function() {","          if (session.userId) {","            subscriptions.user.add(session.userId, socketId);","          }","          if ((session.channels) && session.channels.length > 0) {","            session.channel._bindToSocket();","          }","          return this;","        };","        session.save = function(cb) {","          return sessionStore.set(sessionId, session, cb);","        };","        session._bindToSocket();","        return cb(session);","      });","    },","","    extractSocketSessionToken: function(request) {","      if (!this.strategy.extractSocketSessionToken) {","        throw new Error('No session strategy defined! Did you forget to \"npm install socketstream-cookie-session\" ?');","      }","      var id = this.strategy.extractSocketSessionToken(request, this.options);","      debug('extracted session id %s',id);","      return id;","    },","","    // Allow use of any Connect Session Store","    store: {","      use: function(nameOrStore, options) {","        var RedisStore;","        debug('Using %s Store for ss.session.store',nameOrStore==='redis'?'Redis':'Custom');","        // Allow any Connect Session Store *instance* to be used","        //jshint -W093","        return (sessionStore = nameOrStore === 'redis' ?","          (RedisStore = ss.require('connect-redis')(api), new RedisStore(options)) :","          nameOrStore);","      },","      get: function() {","        if (sessionStore == null) {","          // notify user that this store is not","          // meant for a production environment","          if ('production' === ss.env) {","            ss.log.warn(warning);","          }","          // Define default session store (no default impl for now, is set in session strategy addon socketstream-cookie-session)","          sessionStore = new api.MemoryStore();","          debug('Using MemoryStore for ss.session.store');","        }","        return sessionStore;","      }","    }","  };","","  return api;","};",""],"l":{"6":1,"13":1,"22":1,"26":1,"28":1,"40":0,"41":0,"51":0,"52":0,"53":0,"54":0,"61":0,"65":0,"66":0,"67":0,"69":0,"73":0,"74":0,"75":0,"76":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"85":0,"89":0,"90":0,"91":0,"93":0,"94":0,"96":0,"98":0,"99":0,"101":0,"102":0,"107":0,"108":0,"110":0,"111":0,"112":0,"118":0,"119":0,"122":0,"127":0,"130":0,"131":0,"134":0,"135":0,"137":0,"142":1}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/channels.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/channels.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":17},"end":{"line":11,"column":49}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":10},"end":{"line":15,"column":21}}},"3":{"name":"(anonymous_3)","line":20,"loc":{"start":{"line":20,"column":15},"end":{"line":20,"column":35}}},"4":{"name":"(anonymous_4)","line":22,"loc":{"start":{"line":22,"column":13},"end":{"line":22,"column":24}}},"5":{"name":"(anonymous_5)","line":27,"loc":{"start":{"line":27,"column":32},"end":{"line":27,"column":47}}},"6":{"name":"(anonymous_6)","line":38,"loc":{"start":{"line":38,"column":17},"end":{"line":38,"column":37}}},"7":{"name":"(anonymous_7)","line":40,"loc":{"start":{"line":40,"column":13},"end":{"line":40,"column":24}}},"8":{"name":"(anonymous_8)","line":45,"loc":{"start":{"line":45,"column":32},"end":{"line":45,"column":47}}},"9":{"name":"(anonymous_9)","line":57,"loc":{"start":{"line":57,"column":11},"end":{"line":57,"column":24}}},"10":{"name":"(anonymous_10)","line":59,"loc":{"start":{"line":59,"column":13},"end":{"line":59,"column":24}}},"11":{"name":"(anonymous_11)","line":63,"loc":{"start":{"line":63,"column":19},"end":{"line":63,"column":30}}},"12":{"name":"(anonymous_12)","line":67,"loc":{"start":{"line":67,"column":50},"end":{"line":67,"column":65}}},"13":{"name":"forceArray","line":76,"loc":{"start":{"line":76,"column":0},"end":{"line":76,"column":27}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":18}},"2":{"start":{"line":9,"column":0},"end":{"line":9,"column":58}},"3":{"start":{"line":11,"column":0},"end":{"line":72,"column":2}},"4":{"start":{"line":12,"column":2},"end":{"line":71,"column":4}},"5":{"start":{"line":16,"column":6},"end":{"line":16,"column":36}},"6":{"start":{"line":21,"column":6},"end":{"line":23,"column":7}},"7":{"start":{"line":22,"column":8},"end":{"line":22,"column":27}},"8":{"start":{"line":24,"column":6},"end":{"line":26,"column":7}},"9":{"start":{"line":25,"column":8},"end":{"line":25,"column":30}},"10":{"start":{"line":27,"column":6},"end":{"line":32,"column":9}},"11":{"start":{"line":28,"column":8},"end":{"line":31,"column":9}},"12":{"start":{"line":29,"column":10},"end":{"line":29,"column":38}},"13":{"start":{"line":30,"column":10},"end":{"line":30,"column":114}},"14":{"start":{"line":33,"column":6},"end":{"line":33,"column":27}},"15":{"start":{"line":34,"column":6},"end":{"line":34,"column":30}},"16":{"start":{"line":39,"column":6},"end":{"line":41,"column":7}},"17":{"start":{"line":40,"column":8},"end":{"line":40,"column":27}},"18":{"start":{"line":42,"column":6},"end":{"line":44,"column":7}},"19":{"start":{"line":43,"column":8},"end":{"line":43,"column":30}},"20":{"start":{"line":45,"column":6},"end":{"line":52,"column":9}},"21":{"start":{"line":46,"column":8},"end":{"line":46,"column":14}},"22":{"start":{"line":47,"column":8},"end":{"line":51,"column":9}},"23":{"start":{"line":48,"column":10},"end":{"line":48,"column":40}},"24":{"start":{"line":49,"column":10},"end":{"line":49,"column":55}},"25":{"start":{"line":50,"column":10},"end":{"line":50,"column":118}},"26":{"start":{"line":53,"column":6},"end":{"line":53,"column":30}},"27":{"start":{"line":58,"column":6},"end":{"line":60,"column":7}},"28":{"start":{"line":59,"column":8},"end":{"line":59,"column":27}},"29":{"start":{"line":61,"column":6},"end":{"line":61,"column":47}},"30":{"start":{"line":64,"column":6},"end":{"line":66,"column":7}},"31":{"start":{"line":65,"column":8},"end":{"line":65,"column":30}},"32":{"start":{"line":67,"column":6},"end":{"line":69,"column":9}},"33":{"start":{"line":68,"column":8},"end":{"line":68,"column":57}},"34":{"start":{"line":76,"column":0},"end":{"line":78,"column":1}},"35":{"start":{"line":77,"column":2},"end":{"line":77,"column":63}}},"branchMap":{"1":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":13},"end":{"line":16,"column":29}},{"start":{"line":16,"column":33},"end":{"line":16,"column":35}}]},"2":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":6},"end":{"line":21,"column":6}},{"start":{"line":21,"column":6},"end":{"line":21,"column":6}}]},"3":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":6},"end":{"line":24,"column":6}},{"start":{"line":24,"column":6},"end":{"line":24,"column":6}}]},"4":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":8}},{"start":{"line":28,"column":8},"end":{"line":28,"column":8}}]},"5":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":6},"end":{"line":39,"column":6}},{"start":{"line":39,"column":6},"end":{"line":39,"column":6}}]},"6":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":6},"end":{"line":42,"column":6}},{"start":{"line":42,"column":6},"end":{"line":42,"column":6}}]},"7":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":8},"end":{"line":47,"column":8}},{"start":{"line":47,"column":8},"end":{"line":47,"column":8}}]},"8":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":6},"end":{"line":58,"column":6}},{"start":{"line":58,"column":6},"end":{"line":58,"column":6}}]},"9":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":6},"end":{"line":64,"column":6}},{"start":{"line":64,"column":6},"end":{"line":64,"column":6}}]},"10":{"line":77,"type":"binary-expr","locations":[{"start":{"line":77,"column":9},"end":{"line":77,"column":34}},{"start":{"line":77,"column":38},"end":{"line":77,"column":51}},{"start":{"line":77,"column":55},"end":{"line":77,"column":62}}]}},"code":["// Session Channels","// ----------------","// Provides an interface allowing you to subscribe or unsubscribe the session to a private channel","'use strict';","","require('colors');","","// Stores the relationship between sessionId and socketIds","var subscriptions = require('../websocket/subscriptions');","","module.exports = function(ss, session, socketId) {","  return {","","    // Lists all the channels the client is currently subscribed to    ","    list: function() {","      return session.channels || [];","    },","","    // Subscribes the client to one or more channels    ","    subscribe: function(names, cb) {","      if (!cb) {","        cb = function() {};","      }","      if (!session.channels) {","        session.channels = [];","      }","      forceArray(names).forEach(function(name) {","        if (session.channels.indexOf(name) === -1) { // clients can only join a channel once","          session.channels.push(name);","          return ss.log.info('i'.green + ' subscribed sessionId '.grey + session.id + ' to channel '.grey + name);","        }","      });","      this._bindToSocket();","      return session.save(cb);","    },","","    // Unsubscribes the client from one or more channels","    unsubscribe: function(names, cb) {","      if (!cb) {","        cb = function() {};","      }","      if (!session.channels) {","        session.channels = [];","      }","      forceArray(names).forEach(function(name) {","        var i;","        if ((i = session.channels.indexOf(name)) >= 0) {","          session.channels.splice(i, 1);","          subscriptions.channel.remove(name, socketId);","          return ss.log.info('i'.green + ' unsubscribed sessionId '.grey + session.id + ' from channel '.grey + name);","        }","      });","      return session.save(cb);","    },","","    // Unsubscribes the client from all channels    ","    reset: function(cb) {","      if (!cb) {","        cb = function() {};","      }","      return this.unsubscribe(this.list(), cb);","    },","    _bindToSocket: function() {","      if (!session.channels) {","        session.channels = [];","      }","      return forceArray(session.channels).forEach(function(name) {","        return subscriptions.channel.add(name, socketId);","      });","    }","  };","};","","// Private","","function forceArray(input) {","  return typeof input === 'object' && input.slice() || [input];","}",""],"l":{"6":1,"9":1,"11":1,"12":0,"16":0,"21":0,"22":0,"24":0,"25":0,"27":0,"28":0,"29":0,"30":0,"33":0,"34":0,"39":0,"40":0,"42":0,"43":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"53":0,"58":0,"59":0,"61":0,"64":0,"65":0,"67":0,"68":0,"76":1,"77":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/websocket/subscriptions.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/websocket/subscriptions.js","s":{"1":1,"2":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":7,"column":0},"end":{"line":7,"column":57}},"2":{"start":{"line":9,"column":0},"end":{"line":12,"column":2}}},"branchMap":{},"code":["// Websocket ID subscriptions","// --------------------------","// Stores a list of which socket IDs are subscribed to which users or channels","// and delivers events accordingly","'use strict';","","var UniqueSet = require('../utils/unique_set').UniqueSet;","","module.exports = {","  user: new UniqueSet,","  channel: new UniqueSet","};",""],"l":{"7":1,"9":1}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/unique_set.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/unique_set.js","s":{"1":1,"2":1,"3":2,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":1,"27":0,"28":1,"29":0,"30":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":1,"2":2,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":21},"end":{"line":11,"column":32}}},"2":{"name":"UniqueSet","line":13,"loc":{"start":{"line":13,"column":2},"end":{"line":13,"column":23}}},"3":{"name":"(anonymous_3)","line":29,"loc":{"start":{"line":29,"column":28},"end":{"line":29,"column":49}}},"4":{"name":"(anonymous_4)","line":58,"loc":{"start":{"line":58,"column":31},"end":{"line":58,"column":52}}},"5":{"name":"(anonymous_5)","line":83,"loc":{"start":{"line":83,"column":38},"end":{"line":83,"column":54}}},"6":{"name":"(anonymous_6)","line":85,"loc":{"start":{"line":85,"column":31},"end":{"line":85,"column":45}}},"7":{"name":"(anonymous_7)","line":101,"loc":{"start":{"line":101,"column":29},"end":{"line":101,"column":40}}},"8":{"name":"(anonymous_8)","line":116,"loc":{"start":{"line":116,"column":32},"end":{"line":116,"column":46}}}},"statementMap":{"1":{"start":{"line":11,"column":0},"end":{"line":122,"column":5}},"2":{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},"3":{"start":{"line":14,"column":4},"end":{"line":14,"column":19}},"4":{"start":{"line":29,"column":2},"end":{"line":43,"column":4}},"5":{"start":{"line":30,"column":4},"end":{"line":30,"column":12}},"6":{"start":{"line":31,"column":4},"end":{"line":33,"column":5}},"7":{"start":{"line":32,"column":6},"end":{"line":32,"column":19}},"8":{"start":{"line":34,"column":4},"end":{"line":34,"column":25}},"9":{"start":{"line":35,"column":4},"end":{"line":42,"column":5}},"10":{"start":{"line":36,"column":6},"end":{"line":38,"column":7}},"11":{"start":{"line":37,"column":8},"end":{"line":37,"column":31}},"12":{"start":{"line":40,"column":6},"end":{"line":40,"column":31}},"13":{"start":{"line":41,"column":6},"end":{"line":41,"column":28}},"14":{"start":{"line":58,"column":2},"end":{"line":69,"column":4}},"15":{"start":{"line":59,"column":4},"end":{"line":59,"column":10}},"16":{"start":{"line":60,"column":4},"end":{"line":62,"column":5}},"17":{"start":{"line":61,"column":6},"end":{"line":61,"column":13}},"18":{"start":{"line":63,"column":4},"end":{"line":68,"column":5}},"19":{"start":{"line":64,"column":6},"end":{"line":64,"column":34}},"20":{"start":{"line":65,"column":6},"end":{"line":67,"column":7}},"21":{"start":{"line":66,"column":8},"end":{"line":66,"column":37}},"22":{"start":{"line":83,"column":2},"end":{"line":88,"column":4}},"23":{"start":{"line":84,"column":4},"end":{"line":84,"column":21}},"24":{"start":{"line":85,"column":4},"end":{"line":87,"column":7}},"25":{"start":{"line":86,"column":6},"end":{"line":86,"column":38}},"26":{"start":{"line":101,"column":2},"end":{"line":103,"column":4}},"27":{"start":{"line":102,"column":4},"end":{"line":102,"column":34}},"28":{"start":{"line":116,"column":2},"end":{"line":118,"column":4}},"29":{"start":{"line":117,"column":4},"end":{"line":117,"column":32}},"30":{"start":{"line":120,"column":2},"end":{"line":120,"column":19}}},"branchMap":{"1":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":4}},{"start":{"line":31,"column":4},"end":{"line":31,"column":4}}]},"2":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":11},"end":{"line":31,"column":14}},{"start":{"line":31,"column":20},"end":{"line":31,"column":25}}]},"3":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":35,"column":4}},{"start":{"line":35,"column":4},"end":{"line":35,"column":4}}]},"4":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":6},"end":{"line":36,"column":6}},{"start":{"line":36,"column":6},"end":{"line":36,"column":6}}]},"5":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":4},"end":{"line":60,"column":4}},{"start":{"line":60,"column":4},"end":{"line":60,"column":4}}]},"6":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":63,"column":4}},{"start":{"line":63,"column":4},"end":{"line":63,"column":4}}]},"7":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":6},"end":{"line":65,"column":6}},{"start":{"line":65,"column":6},"end":{"line":65,"column":6}}]},"8":{"line":117,"type":"binary-expr","locations":[{"start":{"line":117,"column":11},"end":{"line":117,"column":25}},{"start":{"line":117,"column":29},"end":{"line":117,"column":31}}]}},"code":["'use strict';","","/**"," * @ngdoc service"," * @name utils.unique_set:UniqueSet"," * @function"," *"," * @description"," * This is used to maintain lists of userIds to socketIds and channelIds to socketIds"," */","exports.UniqueSet = (function() {","","  function UniqueSet() {","    this.data = {};","  }","","  /**","   * @ngdoc service","   * @name utils.UniqueSet#add","   * @methodOf utils.unique_set:UniqueSet","   * @function","   *","   * @description","   * Add specific `key/value` set","   *","   * @param {String} key   Key name","   * @param {Mixed}  value Value to be assigned to the `key`","   */","  UniqueSet.prototype.add = function(key, value) {","    var set;","    if (!((key) && (value))) {","      return false;","    }","    set = this.data[key];","    if (set) {","      if (set.indexOf(value) === -1) {","        return set.push(value);","      }","    } else {","      this.data[key] = [value];","      return this.data[key];","    }","  };","","  /**","   * @ngdoc service","   * @name utils.UniqueSet#remove","   * @methodOf utils.unique_set:UniqueSet","   * @function","   *","   * @description","   * Remove specific `key/value` set","   *","   * @param {String}    key   Key name","   * @param {Mixed}     value Value related to the `key`","   * @return {Boolean}        Remove state","   */","  UniqueSet.prototype.remove = function(key, value) {","    var i;","    if (this.data[key] === void 0) {","      return;","    }","    if ((i = this.data[key].indexOf(value)) >= 0) {","      this.data[key].splice(i, 1);","      if (this.data[key].length === 0) {","        return delete this.data[key];","      }","    }","  };","","  /**","   * @ngdoc service","   * @name utils.UniqueSet#removeFromAll","   * @methodOf utils.unique_set:UniqueSet","   * @function","   *","   * @description","   * Remove all specific `key/value` sets accotding to `value`","   *","   * @param {Mixed}     value Value as a link for removal all the sets","   * @return {Boolean}        Removal status","   */","  UniqueSet.prototype.removeFromAll = function(value) {","    var _this = this;","    return this.keys().forEach(function(key) {","      return _this.remove(key, value);","    });","  };","","  /**","   * @ngdoc service","   * @name utils.UniqueSet#keys","   * @methodOf utils.unique_set:UniqueSet","   * @function","   *","   * @description","   * Returns array of keys","   *","   * @return {Array} Array of all the keys names","   */","  UniqueSet.prototype.keys = function() {","    return Object.keys(this.data);","  };","","  /**","   * @ngdoc service","   * @name utils.UniqueSet#members","   * @methodOf utils.unique_set:UniqueSet","   * @function","   *","   * @description","   * Returns array with all the values by certain `key`","   *","   * @return {Array}  Array of all the keys for specified `key`","   */","  UniqueSet.prototype.members = function(key) {","    return this.data[key] || [];","  };","","  return UniqueSet;","","})();",""],"l":{"11":1,"13":1,"14":2,"29":1,"30":0,"31":0,"32":0,"34":0,"35":0,"36":0,"37":0,"40":0,"41":0,"58":1,"59":0,"60":0,"61":0,"63":0,"64":0,"65":0,"66":0,"83":1,"84":0,"85":0,"86":0,"101":1,"102":0,"116":1,"117":0,"120":1}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/store.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/store.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"Store","line":25,"loc":{"start":{"line":25,"column":29},"end":{"line":25,"column":45}}},"2":{"name":"(anonymous_2)","line":41,"loc":{"start":{"line":41,"column":29},"end":{"line":41,"column":46}}},"3":{"name":"(anonymous_3)","line":43,"loc":{"start":{"line":43,"column":30},"end":{"line":43,"column":43}}},"4":{"name":"(anonymous_4)","line":58,"loc":{"start":{"line":58,"column":23},"end":{"line":58,"column":40}}},"5":{"name":"(anonymous_5)","line":60,"loc":{"start":{"line":60,"column":16},"end":{"line":60,"column":35}}},"6":{"name":"(anonymous_6)","line":78,"loc":{"start":{"line":78,"column":32},"end":{"line":78,"column":51}}}},"statementMap":{"1":{"start":{"line":13,"column":0},"end":{"line":16,"column":31}},"2":{"start":{"line":25,"column":0},"end":{"line":25,"column":48}},"3":{"start":{"line":31,"column":0},"end":{"line":31,"column":56}},"4":{"start":{"line":41,"column":0},"end":{"line":47,"column":2}},"5":{"start":{"line":42,"column":2},"end":{"line":42,"column":18}},"6":{"start":{"line":43,"column":2},"end":{"line":46,"column":5}},"7":{"start":{"line":44,"column":4},"end":{"line":44,"column":23}},"8":{"start":{"line":45,"column":4},"end":{"line":45,"column":12}},"9":{"start":{"line":58,"column":0},"end":{"line":67,"column":2}},"10":{"start":{"line":59,"column":2},"end":{"line":59,"column":18}},"11":{"start":{"line":60,"column":2},"end":{"line":66,"column":5}},"12":{"start":{"line":61,"column":4},"end":{"line":61,"column":63}},"13":{"start":{"line":61,"column":15},"end":{"line":61,"column":45}},"14":{"start":{"line":61,"column":46},"end":{"line":61,"column":61}},"15":{"start":{"line":62,"column":4},"end":{"line":62,"column":63}},"16":{"start":{"line":62,"column":17},"end":{"line":62,"column":48}},"17":{"start":{"line":62,"column":49},"end":{"line":62,"column":61}},"18":{"start":{"line":63,"column":4},"end":{"line":63,"column":53}},"19":{"start":{"line":64,"column":4},"end":{"line":64,"column":41}},"20":{"start":{"line":65,"column":4},"end":{"line":65,"column":19}},"21":{"start":{"line":78,"column":0},"end":{"line":86,"column":2}},"22":{"start":{"line":79,"column":2},"end":{"line":80,"column":40}},"23":{"start":{"line":81,"column":2},"end":{"line":81,"column":40}},"24":{"start":{"line":82,"column":2},"end":{"line":82,"column":79}},"25":{"start":{"line":82,"column":37},"end":{"line":82,"column":77}},"26":{"start":{"line":83,"column":2},"end":{"line":83,"column":36}},"27":{"start":{"line":84,"column":2},"end":{"line":84,"column":39}},"28":{"start":{"line":85,"column":2},"end":{"line":85,"column":21}}},"branchMap":{"1":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":61,"column":4}},{"start":{"line":61,"column":4},"end":{"line":61,"column":4}}]},"2":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":62,"column":4}},{"start":{"line":62,"column":4},"end":{"line":62,"column":4}}]},"3":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":2},"end":{"line":82,"column":2}},{"start":{"line":82,"column":2},"end":{"line":82,"column":2}}]}},"code":["/*!"," * Connect - session - Store"," * Copyright(c) 2010 Sencha Inc."," * Copyright(c) 2011 TJ Holowaychuk"," * MIT Licensed"," */","'use strict';","","/**"," * Module dependencies."," */","","var EventEmitter = require('eventemitter2').EventEmitter2,","  debug = require('debug')('sessionstore'),","  Session = require('./session'),","  Cookie = require('./cookie');","","/**"," * Initialize abstract `Store`."," *"," * @param options {Object} Store options"," * @api private"," */","","var Store = module.exports = function Store(){};","","/**"," * Inherit from `EventEmitter.prototype`."," */","","Store.prototype = Object.create(EventEmitter.prototype);","","/**"," * Re-generate the given requests's session."," *"," * @param {IncomingRequest} req"," * @return {Function} fn"," * @api public"," */","","Store.prototype.regenerate = function(req, fn){","  var self = this;","  this.destroy(req.sessionID, function(err){","    self.generate(req);","    fn(err);","  });","};","","/**"," * Load a `Session` instance via the given `sid`"," * and invoke the callback `fn(err, sess)`."," *"," * @param {String} sid"," * @param {Function} fn"," * @api public"," */","","Store.prototype.load = function(sid, fn){","  var self = this;","  this.get(sid, function(err, sess){","    if (err) { debug('failed to get %s',sid); return fn(err); }","    if (!sess) { debug('no session for %s',sid); return fn(); }","    var req = { sessionID: sid, sessionStore: self };","    sess = self.createSession(req, sess); // recreate prototypes on persisted data","    fn(null, sess);","  });","};","","/**"," * Create session from JSON `sess` data."," *"," * @param {IncomingRequest} req"," * @param {Object} sess"," * @return {Session}"," * @api private"," */","","Store.prototype.createSession = function(req, sess){","  var expires = sess.cookie.expires","    , orig = sess.cookie.originalMaxAge;","  sess.cookie = new Cookie(sess.cookie);","  if ('string' === typeof expires) { sess.cookie.expires = new Date(expires); }","  sess.cookie.originalMaxAge = orig;","  req.session = new Session(req, sess);","  return req.session;","};",""],"l":{"13":1,"25":1,"31":1,"41":1,"42":0,"43":0,"44":0,"45":0,"58":1,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"78":1,"79":0,"81":0,"82":0,"83":0,"84":0,"85":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/session.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/session.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":1,"12":0,"13":0,"14":1,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":0,"31":1,"32":0,"33":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"Session","line":23,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":28}}},"2":{"name":"(anonymous_2)","line":46,"loc":{"start":{"line":46,"column":26},"end":{"line":46,"column":36}}},"3":{"name":"(anonymous_3)","line":57,"loc":{"start":{"line":57,"column":32},"end":{"line":57,"column":42}}},"4":{"name":"(anonymous_4)","line":70,"loc":{"start":{"line":70,"column":25},"end":{"line":70,"column":37}}},"5":{"name":"(anonymous_5)","line":71,"loc":{"start":{"line":71,"column":49},"end":{"line":71,"column":59}}},"6":{"name":"(anonymous_6)","line":87,"loc":{"start":{"line":87,"column":27},"end":{"line":87,"column":39}}},"7":{"name":"(anonymous_7)","line":90,"loc":{"start":{"line":90,"column":21},"end":{"line":90,"column":40}}},"8":{"name":"(anonymous_8)","line":107,"loc":{"start":{"line":107,"column":28},"end":{"line":107,"column":40}}},"9":{"name":"(anonymous_9)","line":121,"loc":{"start":{"line":121,"column":31},"end":{"line":121,"column":43}}}},"statementMap":{"1":{"start":{"line":13,"column":0},"end":{"line":13,"column":25}},"2":{"start":{"line":23,"column":0},"end":{"line":35,"column":1}},"3":{"start":{"line":24,"column":2},"end":{"line":24,"column":53}},"4":{"start":{"line":25,"column":2},"end":{"line":25,"column":62}},"5":{"start":{"line":27,"column":2},"end":{"line":34,"column":3}},"6":{"start":{"line":29,"column":4},"end":{"line":33,"column":5}},"7":{"start":{"line":30,"column":6},"end":{"line":32,"column":7}},"8":{"start":{"line":31,"column":8},"end":{"line":31,"column":31}},"9":{"start":{"line":46,"column":0},"end":{"line":48,"column":2}},"10":{"start":{"line":47,"column":2},"end":{"line":47,"column":28}},"11":{"start":{"line":57,"column":0},"end":{"line":60,"column":2}},"12":{"start":{"line":58,"column":2},"end":{"line":58,"column":50}},"13":{"start":{"line":59,"column":2},"end":{"line":59,"column":14}},"14":{"start":{"line":70,"column":0},"end":{"line":73,"column":2}},"15":{"start":{"line":71,"column":2},"end":{"line":71,"column":63}},"16":{"start":{"line":72,"column":2},"end":{"line":72,"column":14}},"17":{"start":{"line":87,"column":0},"end":{"line":97,"column":2}},"18":{"start":{"line":88,"column":2},"end":{"line":89,"column":36}},"19":{"start":{"line":90,"column":2},"end":{"line":95,"column":5}},"20":{"start":{"line":91,"column":4},"end":{"line":91,"column":30}},"21":{"start":{"line":91,"column":14},"end":{"line":91,"column":29}},"22":{"start":{"line":92,"column":4},"end":{"line":92,"column":64}},"23":{"start":{"line":92,"column":16},"end":{"line":92,"column":63}},"24":{"start":{"line":93,"column":4},"end":{"line":93,"column":35}},"25":{"start":{"line":94,"column":4},"end":{"line":94,"column":9}},"26":{"start":{"line":96,"column":2},"end":{"line":96,"column":14}},"27":{"start":{"line":107,"column":0},"end":{"line":111,"column":2}},"28":{"start":{"line":108,"column":2},"end":{"line":108,"column":26}},"29":{"start":{"line":109,"column":2},"end":{"line":109,"column":45}},"30":{"start":{"line":110,"column":2},"end":{"line":110,"column":14}},"31":{"start":{"line":121,"column":0},"end":{"line":124,"column":2}},"32":{"start":{"line":122,"column":2},"end":{"line":122,"column":49}},"33":{"start":{"line":123,"column":2},"end":{"line":123,"column":14}}},"branchMap":{"1":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":2},"end":{"line":27,"column":2}},{"start":{"line":27,"column":2},"end":{"line":27,"column":2}}]},"2":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":6},"end":{"line":27,"column":30}},{"start":{"line":27,"column":34},"end":{"line":27,"column":47}}]},"3":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":6},"end":{"line":30,"column":6}},{"start":{"line":30,"column":6},"end":{"line":30,"column":6}}]},"4":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":43},"end":{"line":71,"column":45}},{"start":{"line":71,"column":49},"end":{"line":71,"column":61}}]},"5":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":91,"column":4}},{"start":{"line":91,"column":4},"end":{"line":91,"column":4}}]},"6":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":4},"end":{"line":92,"column":4}},{"start":{"line":92,"column":4},"end":{"line":92,"column":4}}]}},"code":["/*!"," * Connect - session - Session"," * Copyright(c) 2010 Sencha Inc."," * Copyright(c) 2011 TJ Holowaychuk"," * MIT Licensed"," */","'use strict';","","/**"," * Expose Session."," */","","module.exports = Session;","","/**"," * Create a new `Session` with the given request and `data`."," *"," * @param {IncomingRequest} req"," * @param {Object} data"," * @api private"," */","","function Session(req, data) {","  Object.defineProperty(this, 'req', { value: req });","  Object.defineProperty(this, 'id', { value: req.sessionID });","","  if (typeof data === 'object' && data !== null) {","    // merge data into this, ignoring prototype properties","    for (var prop in data) {","      if (!(prop in this)) {","        this[prop] = data[prop]","      }","    }","  }","}","","/**"," * Update reset `.cookie.maxAge` to prevent"," * the cookie from expiring when the"," * session is still active."," *"," * @return {Session} for chaining"," * @api public"," */","","Session.prototype.touch = function(){","  return this.resetMaxAge();","};","","/**"," * Reset `.maxAge` to `.originalMaxAge`."," *"," * @return {Session} for chaining"," * @api public"," */","","Session.prototype.resetMaxAge = function(){","  this.cookie.maxAge = this.cookie.originalMaxAge;","  return this;","};","","/**"," * Save the session data with optional callback `fn(err)`."," *"," * @param {Function} fn"," * @return {Session} for chaining"," * @api public"," */","","Session.prototype.save = function(fn){","  this.req.sessionStore.set(this.id, this, fn || function(){});","  return this;","};","","/**"," * Re-loads the session data _without_ altering"," * the maxAge properties. Invokes the callback `fn(err)`,"," * after which time if no exception has occurred the"," * `req.session` property will be a new `Session` object,"," * although representing the same session."," *"," * @param {Function} fn"," * @return {Session} for chaining"," * @api public"," */","","Session.prototype.reload = function(fn){","  var req = this.req","    , store = this.req.sessionStore;","  store.get(this.id, function(err, sess){","    if (err) {return fn(err);}","    if (!sess) {return fn(new Error('failed to load session'));}","    store.createSession(req, sess);","    fn();","  });","  return this;","};","","/**"," * Destroy `this` session."," *"," * @param {Function} fn"," * @return {Session} for chaining"," * @api public"," */","","Session.prototype.destroy = function(fn){","  delete this.req.session;","  this.req.sessionStore.destroy(this.id, fn);","  return this;","};","","/**"," * Regenerate this request's session."," *"," * @param {Function} fn"," * @return {Session} for chaining"," * @api public"," */","","Session.prototype.regenerate = function(fn){","  this.req.sessionStore.regenerate(this.req, fn);","  return this;","};",""],"l":{"13":1,"23":1,"24":0,"25":0,"27":0,"29":0,"30":0,"31":0,"46":1,"47":0,"57":1,"58":0,"59":0,"70":1,"71":0,"72":0,"87":1,"88":0,"90":0,"91":0,"92":0,"93":0,"94":0,"96":0,"107":1,"108":0,"109":0,"110":0,"121":1,"122":0,"123":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/cookie.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/cookie.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":27,"13":0,"14":9,"15":13,"16":0,"17":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,9]},"f":{"1":0,"2":0,"3":27,"4":0,"5":9,"6":13,"7":0,"8":0},"fnMap":{"1":{"name":"Cookie","line":24,"loc":{"start":{"line":24,"column":30},"end":{"line":24,"column":55}}},"2":{"name":"(anonymous_2)","line":47,"loc":{"start":{"line":47,"column":13},"end":{"line":47,"column":20}}},"3":{"name":"(anonymous_3)","line":59,"loc":{"start":{"line":59,"column":13},"end":{"line":59,"column":16}}},"4":{"name":"(anonymous_4)","line":70,"loc":{"start":{"line":70,"column":12},"end":{"line":70,"column":17}}},"5":{"name":"(anonymous_5)","line":83,"loc":{"start":{"line":83,"column":12},"end":{"line":83,"column":15}}},"6":{"name":"(anonymous_6)","line":96,"loc":{"start":{"line":96,"column":10},"end":{"line":96,"column":13}}},"7":{"name":"(anonymous_7)","line":114,"loc":{"start":{"line":114,"column":13},"end":{"line":114,"column":32}}},"8":{"name":"(anonymous_8)","line":125,"loc":{"start":{"line":125,"column":10},"end":{"line":125,"column":20}}}},"statementMap":{"1":{"start":{"line":13,"column":0},"end":{"line":14,"column":31}},"2":{"start":{"line":24,"column":0},"end":{"line":32,"column":2}},"3":{"start":{"line":25,"column":2},"end":{"line":25,"column":18}},"4":{"start":{"line":26,"column":2},"end":{"line":26,"column":21}},"5":{"start":{"line":27,"column":2},"end":{"line":27,"column":23}},"6":{"start":{"line":28,"column":2},"end":{"line":28,"column":38}},"7":{"start":{"line":28,"column":16},"end":{"line":28,"column":37}},"8":{"start":{"line":29,"column":2},"end":{"line":31,"column":26}},"9":{"start":{"line":38,"column":0},"end":{"line":128,"column":2}},"10":{"start":{"line":48,"column":4},"end":{"line":48,"column":25}},"11":{"start":{"line":49,"column":4},"end":{"line":49,"column":38}},"12":{"start":{"line":60,"column":4},"end":{"line":60,"column":25}},"13":{"start":{"line":71,"column":4},"end":{"line":73,"column":11}},"14":{"start":{"line":84,"column":4},"end":{"line":86,"column":21}},"15":{"start":{"line":97,"column":4},"end":{"line":104,"column":5}},"16":{"start":{"line":115,"column":4},"end":{"line":115,"column":50}},"17":{"start":{"line":126,"column":4},"end":{"line":126,"column":21}}},"branchMap":{"1":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":2},"end":{"line":28,"column":2}},{"start":{"line":28,"column":2},"end":{"line":28,"column":2}}]},"2":{"line":29,"type":"cond-expr","locations":[{"start":{"line":30,"column":6},"end":{"line":30,"column":17}},{"start":{"line":31,"column":6},"end":{"line":31,"column":25}}]},"3":{"line":71,"type":"cond-expr","locations":[{"start":{"line":72,"column":8},"end":{"line":72,"column":33}},{"start":{"line":73,"column":8},"end":{"line":73,"column":10}}]},"4":{"line":84,"type":"cond-expr","locations":[{"start":{"line":85,"column":8},"end":{"line":85,"column":43}},{"start":{"line":86,"column":8},"end":{"line":86,"column":20}}]}},"code":["/*!"," * Connect - session - Cookie"," * Copyright(c) 2010 Sencha Inc."," * Copyright(c) 2011 TJ Holowaychuk"," * MIT Licensed"," */","'use strict';","","/**"," * Module dependencies."," */","","var merge = require('utils-merge')","  , cookie = require('cookie');","","/**"," * Initialize a new `Cookie` with the given `options`."," *"," * @param {IncomingMessage} req"," * @param {Object} options"," * @api private"," */","","var Cookie = module.exports = function Cookie(options) {","  this.path = '/';","  this.maxAge = null;","  this.httpOnly = true;","  if (options) {merge(this, options);}","  this.originalMaxAge = undefined === this.originalMaxAge ?","      this.maxAge :","      this.originalMaxAge;","};","","/*!"," * Prototype."," */","","Cookie.prototype = {","","  /**","   * Set expires `date`.","   *","   * @param {Date} date","   * @api public","   */","","  set expires(date) {","    this._expires = date;","    this.originalMaxAge = this.maxAge;","  },","","  /**","   * Get expires `date`.","   *","   * @return {Date}","   * @api public","   */","","  get expires() {","    return this._expires;","  },","","  /**","   * Set expires via max-age in `ms`.","   *","   * @param {Number} ms","   * @api public","   */","","  set maxAge(ms) {","    this.expires = 'number' === typeof ms ?","        new Date(Date.now() + ms) :","        ms;","  },","","  /**","   * Get expires max-age in `ms`.","   *","   * @return {Number}","   * @api public","   */","","  get maxAge() {","    return this.expires instanceof Date ?","        this.expires.valueOf() - Date.now() :","        this.expires;","  },","","  /**","   * Return cookie data object.","   *","   * @return {Object}","   * @api private","   */","","  get data() {","    return {","        originalMaxAge: this.originalMaxAge","      , expires: this._expires","      , secure: this.secure","      , httpOnly: this.httpOnly","      , domain: this.domain","      , path: this.path","    }","  },","","  /**","   * Return a serialized cookie string.","   *","   * @return {String}","   * @api public","   */","","  serialize: function(name, val){","    return cookie.serialize(name, val, this.data);","  },","","  /**","   * Return JSON representation of this cookie.","   *","   * @return {Object}","   * @api private","   */","","  toJSON: function(){","    return this.data;","  }","};"],"l":{"13":1,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"38":1,"48":0,"49":0,"60":27,"71":0,"84":9,"97":13,"115":0,"126":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/memory.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/session/memory.js","s":{"1":1,"2":1,"3":0,"4":1,"5":1,"6":0,"7":0,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":1,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":1,"35":0,"36":0,"37":0,"38":1,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0},"b":{"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":4},"end":{"line":26,"column":16}},"skip":true},"2":{"name":"MemoryStore","line":39,"loc":{"start":{"line":39,"column":0},"end":{"line":39,"column":23}}},"3":{"name":"all","line":56,"loc":{"start":{"line":56,"column":28},"end":{"line":56,"column":51}}},"4":{"name":"clear","line":81,"loc":{"start":{"line":81,"column":30},"end":{"line":81,"column":55}}},"5":{"name":"destroy","line":95,"loc":{"start":{"line":95,"column":32},"end":{"line":95,"column":70}}},"6":{"name":"get","line":110,"loc":{"start":{"line":110,"column":28},"end":{"line":110,"column":62}}},"7":{"name":"length","line":130,"loc":{"start":{"line":130,"column":31},"end":{"line":130,"column":57}}},"8":{"name":"(anonymous_8)","line":131,"loc":{"start":{"line":131,"column":11},"end":{"line":131,"column":36}}},"9":{"name":"set","line":137,"loc":{"start":{"line":137,"column":28},"end":{"line":137,"column":71}}},"10":{"name":"touch","line":153,"loc":{"start":{"line":153,"column":30},"end":{"line":153,"column":75}}},"11":{"name":"getSession","line":172,"loc":{"start":{"line":172,"column":0},"end":{"line":172,"column":41}}}},"statementMap":{"1":{"start":{"line":15,"column":0},"end":{"line":16,"column":53}},"2":{"start":{"line":24,"column":0},"end":{"line":26,"column":66},"skip":true},"3":{"start":{"line":26,"column":18},"end":{"line":26,"column":65},"skip":true},"4":{"start":{"line":32,"column":0},"end":{"line":32,"column":28}},"5":{"start":{"line":39,"column":0},"end":{"line":42,"column":1}},"6":{"start":{"line":40,"column":2},"end":{"line":40,"column":18}},"7":{"start":{"line":41,"column":2},"end":{"line":41,"column":37}},"8":{"start":{"line":47,"column":0},"end":{"line":47,"column":55}},"9":{"start":{"line":56,"column":0},"end":{"line":72,"column":1}},"10":{"start":{"line":57,"column":2},"end":{"line":57,"column":45}},"11":{"start":{"line":58,"column":2},"end":{"line":58,"column":36}},"12":{"start":{"line":60,"column":2},"end":{"line":67,"column":3}},"13":{"start":{"line":61,"column":4},"end":{"line":61,"column":33}},"14":{"start":{"line":62,"column":4},"end":{"line":62,"column":54}},"15":{"start":{"line":64,"column":4},"end":{"line":66,"column":5}},"16":{"start":{"line":65,"column":6},"end":{"line":65,"column":36}},"17":{"start":{"line":69,"column":2},"end":{"line":71,"column":3}},"18":{"start":{"line":70,"column":5},"end":{"line":70,"column":37}},"19":{"start":{"line":81,"column":0},"end":{"line":86,"column":1}},"20":{"start":{"line":82,"column":2},"end":{"line":82,"column":37}},"21":{"start":{"line":83,"column":2},"end":{"line":85,"column":3}},"22":{"start":{"line":84,"column":5},"end":{"line":84,"column":21}},"23":{"start":{"line":95,"column":0},"end":{"line":100,"column":1}},"24":{"start":{"line":96,"column":2},"end":{"line":96,"column":33}},"25":{"start":{"line":97,"column":2},"end":{"line":99,"column":3}},"26":{"start":{"line":98,"column":5},"end":{"line":98,"column":21}},"27":{"start":{"line":110,"column":0},"end":{"line":112,"column":1}},"28":{"start":{"line":111,"column":2},"end":{"line":111,"column":61}},"29":{"start":{"line":130,"column":0},"end":{"line":135,"column":1}},"30":{"start":{"line":131,"column":2},"end":{"line":134,"column":4}},"31":{"start":{"line":132,"column":4},"end":{"line":132,"column":38}},"32":{"start":{"line":132,"column":15},"end":{"line":132,"column":36}},"33":{"start":{"line":133,"column":4},"end":{"line":133,"column":48}},"34":{"start":{"line":137,"column":0},"end":{"line":142,"column":1}},"35":{"start":{"line":138,"column":2},"end":{"line":138,"column":52}},"36":{"start":{"line":139,"column":2},"end":{"line":141,"column":3}},"37":{"start":{"line":140,"column":5},"end":{"line":140,"column":21}},"38":{"start":{"line":153,"column":0},"end":{"line":165,"column":1}},"39":{"start":{"line":154,"column":2},"end":{"line":154,"column":59}},"40":{"start":{"line":156,"column":2},"end":{"line":160,"column":3}},"41":{"start":{"line":158,"column":4},"end":{"line":158,"column":42}},"42":{"start":{"line":159,"column":4},"end":{"line":159,"column":61}},"43":{"start":{"line":162,"column":2},"end":{"line":164,"column":3}},"44":{"start":{"line":163,"column":5},"end":{"line":163,"column":21}},"45":{"start":{"line":172,"column":0},"end":{"line":195,"column":1}},"46":{"start":{"line":173,"column":2},"end":{"line":173,"column":32}},"47":{"start":{"line":175,"column":2},"end":{"line":178,"column":3}},"48":{"start":{"line":176,"column":4},"end":{"line":176,"column":56}},"49":{"start":{"line":177,"column":4},"end":{"line":177,"column":11}},"50":{"start":{"line":181,"column":2},"end":{"line":181,"column":25}},"51":{"start":{"line":183,"column":2},"end":{"line":185,"column":23}},"52":{"start":{"line":188,"column":2},"end":{"line":192,"column":3}},"53":{"start":{"line":189,"column":4},"end":{"line":189,"column":60}},"54":{"start":{"line":190,"column":4},"end":{"line":190,"column":31}},"55":{"start":{"line":191,"column":4},"end":{"line":191,"column":11}},"56":{"start":{"line":194,"column":2},"end":{"line":194,"column":13}}},"branchMap":{"1":{"line":24,"type":"cond-expr","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":16},"skip":true},{"start":{"line":26,"column":4},"end":{"line":26,"column":66},"skip":true}]},"2":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":64,"column":4}},{"start":{"line":64,"column":4},"end":{"line":64,"column":4}}]},"3":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":69,"column":2}},{"start":{"line":69,"column":2},"end":{"line":69,"column":2}}]},"4":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":2},"end":{"line":83,"column":2}},{"start":{"line":83,"column":2},"end":{"line":83,"column":2}}]},"5":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":2},"end":{"line":97,"column":2}},{"start":{"line":97,"column":2},"end":{"line":97,"column":2}}]},"6":{"line":132,"type":"if","locations":[{"start":{"line":132,"column":4},"end":{"line":132,"column":4}},{"start":{"line":132,"column":4},"end":{"line":132,"column":4}}]},"7":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":2},"end":{"line":139,"column":2}},{"start":{"line":139,"column":2},"end":{"line":139,"column":2}}]},"8":{"line":156,"type":"if","locations":[{"start":{"line":156,"column":2},"end":{"line":156,"column":2}},{"start":{"line":156,"column":2},"end":{"line":156,"column":2}}]},"9":{"line":162,"type":"if","locations":[{"start":{"line":162,"column":2},"end":{"line":162,"column":2}},{"start":{"line":162,"column":2},"end":{"line":162,"column":2}}]},"10":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":2},"end":{"line":175,"column":2}},{"start":{"line":175,"column":2},"end":{"line":175,"column":2}}]},"11":{"line":183,"type":"cond-expr","locations":[{"start":{"line":184,"column":4},"end":{"line":184,"column":33}},{"start":{"line":185,"column":4},"end":{"line":185,"column":23}}]},"12":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":2},"end":{"line":188,"column":2}},{"start":{"line":188,"column":2},"end":{"line":188,"column":2}}]},"13":{"line":188,"type":"binary-expr","locations":[{"start":{"line":188,"column":6},"end":{"line":188,"column":13}},{"start":{"line":188,"column":17},"end":{"line":188,"column":38}}]}},"code":["/*!"," * express-session"," * Copyright(c) 2010 Sencha Inc."," * Copyright(c) 2011 TJ Holowaychuk"," * Copyright(c) 2015 Douglas Christopher Wilson"," * MIT Licensed"," */","'use strict';","","/**"," * Module dependencies."," * @private"," */","","var Store = require('./store'),","    debug = require('debug')('socketstream:session');","","/**"," * Shim setImmediate for node.js < 0.10"," * @private"," */","","/* istanbul ignore next */","var defer = typeof setImmediate === 'function' ?","    setImmediate :","    function(fn){ process.nextTick(fn.bind.apply(fn, arguments)) }","","/**"," * Module exports."," */","","module.exports = MemoryStore","","/**"," * A session store in memory."," * @public"," */","","function MemoryStore() {","  Store.call(this)","  this.sessions = Object.create(null)","}","","/**"," * Inherit from Store."," */","MemoryStore.prototype = Object.create(Store.prototype);","","/**"," * Get all active sessions."," *"," * @param {function} callback"," * @public"," */","","MemoryStore.prototype.all = function all(callback) {","  var sessionIds = Object.keys(this.sessions)","  var sessions = Object.create(null)","","  for (var i = 0; i < sessionIds.length; i++) {","    var sessionId = sessionIds[i]","    var session = getSession(this.sessions, sessionId)","","    if (session) {","      sessions[sessionId] = session;","    }","  }","","  if (callback) {","     defer(callback, null, sessions);","  }","}","","/**"," * Clear all sessions."," *"," * @param {function} callback"," * @public"," */","","MemoryStore.prototype.clear = function clear(callback) {","  this.sessions = Object.create(null)","  if (callback) {","     defer(callback);","  }","}","","/**"," * Destroy the session associated with the given session ID."," *"," * @param {string} sessionId"," * @public"," */","","MemoryStore.prototype.destroy = function destroy(sessionId, callback) {","  delete this.sessions[sessionId]","  if (callback) {","     defer(callback);","  }","}","","/**"," * Fetch session by the given session ID."," *"," * @param {string} sessionId"," * @param {function} callback"," * @public"," */","","MemoryStore.prototype.get = function get(sessionId, callback) {","  defer(callback, null, getSession(this.sessions, sessionId))","}","","/**"," * Commit the given session associated with the given sessionId to the store."," *"," * @param {string} sessionId"," * @param {object} session"," * @param {function} callback"," * @public"," */","","/**"," * Get number of active sessions."," *"," * @param {function} callback"," * @public"," */","","MemoryStore.prototype.length = function length(callback) {","  this.all(function (err, sessions) {","    if (err) { return callback(err); }","    callback(null, Object.keys(sessions).length)","  })","}","","MemoryStore.prototype.set = function set(sessionId, session, callback) {","  this.sessions[sessionId] = JSON.stringify(session)","  if (callback) {","     defer(callback);","  }","}","","/**"," * Touch the given session object associated with the given session ID."," *"," * @param {string} sessionId"," * @param {object} session"," * @param {function} callback"," * @public"," */","","MemoryStore.prototype.touch = function touch(sessionId, session, callback) {","  var currentSession = getSession(this.sessions, sessionId)","","  if (currentSession) {","    // update expiration","    currentSession.cookie = session.cookie","    this.sessions[sessionId] = JSON.stringify(currentSession)","  }","","  if (callback) {","     defer(callback);","  }","}","","/**"," * Get session from the store."," * @private"," */","","function getSession(sessions, sessionId) {","  var sess = sessions[sessionId]","","  if (!sess) {","    debug('no session in MemoryStore for %s',sessionId);","    return;","  }","","  // parse","  sess = JSON.parse(sess)","","  var expires = typeof sess.cookie.expires === 'string' ?","    new Date(sess.cookie.expires) :","    sess.cookie.expires","","  // destroy expired session","  if (expires && expires <= Date.now()) {","    debug('Session %s is Expired in MemoryStore',sessionId);","    delete sessions[sessionId];","    return;","  }","","  return sess","}",""],"l":{"15":1,"24":1,"26":1,"32":1,"39":1,"40":0,"41":0,"47":1,"56":1,"57":0,"58":0,"60":0,"61":0,"62":0,"64":0,"65":0,"69":0,"70":0,"81":1,"82":0,"83":0,"84":0,"95":1,"96":0,"97":0,"98":0,"110":1,"111":0,"130":1,"131":0,"132":0,"133":0,"137":1,"138":0,"139":0,"140":0,"153":1,"154":0,"156":0,"158":0,"159":0,"162":0,"163":0,"172":1,"173":0,"175":0,"176":0,"177":0,"181":0,"183":0,"188":0,"189":0,"190":0,"191":0,"194":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/publish/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/publish/index.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":17},"end":{"line":10,"column":28}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":9},"end":{"line":21,"column":29}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":13},"end":{"line":33,"column":24}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":18},"end":{"line":46,"column":29}}},"5":{"name":"(anonymous_5)","line":59,"loc":{"start":{"line":59,"column":15},"end":{"line":59,"column":26}}},"6":{"name":"(anonymous_6)","line":83,"loc":{"start":{"line":83,"column":18},"end":{"line":83,"column":29}}},"7":{"name":"(anonymous_7)","line":112,"loc":{"start":{"line":112,"column":13},"end":{"line":112,"column":29}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":8,"column":32}},"2":{"start":{"line":10,"column":0},"end":{"line":108,"column":2}},"3":{"start":{"line":11,"column":2},"end":{"line":107,"column":4}},"4":{"start":{"line":22,"column":6},"end":{"line":96,"column":8}},"5":{"start":{"line":34,"column":10},"end":{"line":40,"column":14}},"6":{"start":{"line":41,"column":10},"end":{"line":41,"column":30}},"7":{"start":{"line":42,"column":10},"end":{"line":44,"column":11}},"8":{"start":{"line":43,"column":12},"end":{"line":43,"column":63}},"9":{"start":{"line":47,"column":10},"end":{"line":55,"column":16}},"10":{"start":{"line":56,"column":10},"end":{"line":56,"column":30}},"11":{"start":{"line":57,"column":10},"end":{"line":57,"column":80}},"12":{"start":{"line":60,"column":10},"end":{"line":68,"column":16}},"13":{"start":{"line":69,"column":10},"end":{"line":69,"column":30}},"14":{"start":{"line":70,"column":10},"end":{"line":70,"column":93}},"15":{"start":{"line":84,"column":10},"end":{"line":92,"column":16}},"16":{"start":{"line":93,"column":10},"end":{"line":93,"column":30}},"17":{"start":{"line":94,"column":10},"end":{"line":94,"column":99}},"18":{"start":{"line":99,"column":6},"end":{"line":99,"column":38}},"19":{"start":{"line":101,"column":6},"end":{"line":101,"column":41}},"20":{"start":{"line":102,"column":6},"end":{"line":102,"column":35}},"21":{"start":{"line":105,"column":6},"end":{"line":105,"column":21}},"22":{"start":{"line":112,"column":0},"end":{"line":114,"column":2}},"23":{"start":{"line":113,"column":2},"end":{"line":113,"column":40}}},"branchMap":{"1":{"line":35,"type":"cond-expr","locations":[{"start":{"line":35,"column":48},"end":{"line":35,"column":74}},{"start":{"line":35,"column":77},"end":{"line":35,"column":79}}]},"2":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":10},"end":{"line":42,"column":10}},{"start":{"line":42,"column":10},"end":{"line":42,"column":10}}]},"3":{"line":49,"type":"cond-expr","locations":[{"start":{"line":49,"column":48},"end":{"line":49,"column":74}},{"start":{"line":49,"column":77},"end":{"line":49,"column":79}}]},"4":{"line":60,"type":"cond-expr","locations":[{"start":{"line":60,"column":53},"end":{"line":60,"column":65}},{"start":{"line":60,"column":68},"end":{"line":60,"column":82}}]},"5":{"line":62,"type":"cond-expr","locations":[{"start":{"line":62,"column":48},"end":{"line":62,"column":74}},{"start":{"line":62,"column":77},"end":{"line":62,"column":79}}]},"6":{"line":84,"type":"cond-expr","locations":[{"start":{"line":84,"column":56},"end":{"line":84,"column":68}},{"start":{"line":84,"column":71},"end":{"line":84,"column":85}}]},"7":{"line":86,"type":"cond-expr","locations":[{"start":{"line":86,"column":48},"end":{"line":86,"column":74}},{"start":{"line":86,"column":77},"end":{"line":86,"column":79}}]}},"code":["// Publish Event API","// -----------------","// Allows you to publish events to browser clients. All this code is closely related to the 'event' websocket responder","'use strict';","","var isInternal,","  __slice = [].slice,","  log = require('../utils/log');","","module.exports = function() {","  return {","    transport: require('./transport')(),","","    /**","     * @ngdoc service","     * @name ss.publish:publish","     * @description","     * Extend the internal API with a publish object you can call from your own server-side code","     * @returns {object} API","     */","    api: function(transport) {","      var methods = {","","        /**","         * @ngdoc function","         * @name ss.publish#all","         * @methodOf ss.publish:publish","         * @param {string} name Name of the event","         * @param {any} first First parameter (open ended)","         * @description","         * Publish event to all active client browsers","         */","        all: function() {","          var event = arguments[0],","              params = (2 <= arguments.length ? __slice.call(arguments, 1) : []),","            obj = {","              t: 'all',","              e: event,","              p: params","            };","          transport.send(obj);","          if (!isInternal(event)) {","            return log.info('➙'.cyan, 'event:all'.grey, event);","          }","        },","        socketId: function() {","          var socketId = arguments[0],","              event = arguments[1],","              params = (3 <= arguments.length ? __slice.call(arguments, 2) : []),","              obj = {","                t: 'socketId',","                socketId: socketId,","                e: event,","                p: params","              };","          transport.send(obj);","          return log.info('➙'.cyan, ('event:socketId:' + socketId).grey, event);","        },","        users: function() {","          var users = arguments[0] instanceof Array? arguments[0] : [arguments[0]],","              event = arguments[1],","              params = (3 <= arguments.length ? __slice.call(arguments, 2) : []),","              obj = {","                t: 'user',","                users: users,","                e: event,","                p: params","              };","          transport.send(obj);","          return log.info('➙'.cyan, ('event:users:[' + (users.join(',')) + ']').grey, event);","        },","","          /**","           * @ngdoc function","           * @name ss.publish#channel","           * @methodOf ss.publish:publish","           * @param {string|array} channel Name of the channel(s)","           * @param {string} event Name of the event","           * @param {any} first First parameter (open ended)","           * @description","           * Publish event to all active client browsers in given channel","           */","        channels: function() {","          var channels = arguments[0] instanceof Array? arguments[0] : [arguments[0]],","              event = arguments[1],","              params = (3 <= arguments.length ? __slice.call(arguments, 2) : []),","              obj = {","                t: 'channel',","                channels: channels,","                e: event,","                p: params","              };","          transport.send(obj);","          return log.info('➙'.cyan, ('event:channels:[' + (channels.join(',')) + ']').grey, event);","        }","      };","","      // Alias 0.2 command","      methods.broadcast = methods.all;","      // Alias singles to plurals","      methods.channel = methods.channels;","      methods.user = methods.users;","","      // Return all methods","      return methods;","    }","  };","};","","// Private","","isInternal = function(event) {","  return event.substr(0, 5) === '__ss:';","};",""],"l":{"6":1,"10":1,"11":1,"22":0,"34":0,"41":0,"42":0,"43":0,"47":0,"56":0,"57":0,"60":0,"69":0,"70":0,"84":0,"93":0,"94":0,"99":0,"101":0,"102":0,"105":0,"112":1,"113":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/publish/transport.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/publish/transport.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":28}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":9},"end":{"line":13,"column":37}}},"3":{"name":"(anonymous_3)","line":19,"loc":{"start":{"line":19,"column":19},"end":{"line":19,"column":30}}},"4":{"name":"(anonymous_4)","line":32,"loc":{"start":{"line":32,"column":10},"end":{"line":32,"column":21}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":39,"column":2}},"2":{"start":{"line":9,"column":2},"end":{"line":9,"column":24}},"3":{"start":{"line":10,"column":2},"end":{"line":10,"column":19}},"4":{"start":{"line":11,"column":2},"end":{"line":11,"column":14}},"5":{"start":{"line":12,"column":2},"end":{"line":38,"column":4}},"6":{"start":{"line":14,"column":6},"end":{"line":14,"column":18}},"7":{"start":{"line":15,"column":6},"end":{"line":17,"column":7}},"8":{"start":{"line":16,"column":8},"end":{"line":16,"column":17}},"9":{"start":{"line":18,"column":6},"end":{"line":18,"column":19}},"10":{"start":{"line":19,"column":6},"end":{"line":30,"column":11}},"11":{"start":{"line":20,"column":8},"end":{"line":29,"column":9}},"12":{"start":{"line":21,"column":10},"end":{"line":21,"column":30}},"13":{"start":{"line":23,"column":10},"end":{"line":23,"column":51}},"14":{"start":{"line":24,"column":10},"end":{"line":28,"column":11}},"15":{"start":{"line":25,"column":12},"end":{"line":25,"column":36}},"16":{"start":{"line":27,"column":12},"end":{"line":27,"column":128}},"17":{"start":{"line":33,"column":6},"end":{"line":35,"column":7}},"18":{"start":{"line":34,"column":8},"end":{"line":34,"column":29}},"19":{"start":{"line":36,"column":6},"end":{"line":36,"column":31}}},"branchMap":{"1":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":6},"end":{"line":15,"column":6}},{"start":{"line":15,"column":6},"end":{"line":15,"column":6}}]},"2":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":8}},{"start":{"line":20,"column":8},"end":{"line":20,"column":8}}]},"3":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":10},"end":{"line":24,"column":10}},{"start":{"line":24,"column":10},"end":{"line":24,"column":10}}]},"4":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":6},"end":{"line":33,"column":6}},{"start":{"line":33,"column":6},"end":{"line":33,"column":6}}]}},"code":["// Publish Event Transport","// -----------------------","// Right now you can either use the internal transport or inbuilt Redis module","// The idea behind making this modular is to allow others to experiment with other message queues / servers","","'use strict';","","module.exports = function() {","  var config, transport;","  transport = null;","  config = {};","  return {","    use: function(nameOrModule, cfg) {","      var modPath;","      if (!cfg) {","        cfg = {};","      }","      config = cfg;","      transport = (function() {","        if (typeof nameOrModule === 'function') {","          return nameOrModule;","        } else {","          modPath = './transports/' + nameOrModule;","          if (require.resolve(modPath)) {","            return require(modPath);","          } else {","            throw new Error('Unable to find Publish Event Transport \\'' + nameOrModule + '\\' internally. Please pass a module');","          }","        }","      })();","    },","    load: function() {","      if (!transport) {","        this.use('internal');","      }","      return transport(config); //TODO should this be (ss,config) ?","    }","  };","};",""],"l":{"8":1,"9":1,"10":1,"11":1,"12":1,"14":0,"15":0,"16":0,"18":0,"19":0,"20":0,"21":0,"23":0,"24":0,"25":0,"27":0,"33":0,"34":0,"36":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/http/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/http/index.js","s":{"1":1,"2":1,"3":1,"4":10,"5":10,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":14,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0},"b":{"1":[10,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":1,"2":10,"3":0,"4":0,"5":14,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":25,"loc":{"start":{"line":25,"column":17},"end":{"line":25,"column":30}}},"2":{"name":"(anonymous_2)","line":28,"loc":{"start":{"line":28,"column":18},"end":{"line":28,"column":21}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":18},"end":{"line":42,"column":23}}},"4":{"name":"(anonymous_4)","line":68,"loc":{"start":{"line":68,"column":9},"end":{"line":68,"column":31}}},"5":{"name":"(anonymous_5)","line":82,"loc":{"start":{"line":82,"column":16},"end":{"line":82,"column":19}}},"6":{"name":"(anonymous_6)","line":95,"loc":{"start":{"line":95,"column":10},"end":{"line":95,"column":21}}},"7":{"name":"(anonymous_7)","line":101,"loc":{"start":{"line":101,"column":12},"end":{"line":101,"column":23}}},"8":{"name":"(anonymous_8)","line":116,"loc":{"start":{"line":116,"column":11},"end":{"line":116,"column":29}}},"9":{"name":"(anonymous_9)","line":121,"loc":{"start":{"line":121,"column":24},"end":{"line":121,"column":39}}},"10":{"name":"(anonymous_10)","line":122,"loc":{"start":{"line":122,"column":34},"end":{"line":122,"column":53}}},"11":{"name":"sessionMiddleware","line":132,"loc":{"start":{"line":132,"column":2},"end":{"line":132,"column":43}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":12,"column":6}},"2":{"start":{"line":25,"column":0},"end":{"line":135,"column":2}},"3":{"start":{"line":26,"column":2},"end":{"line":129,"column":4}},"4":{"start":{"line":29,"column":6},"end":{"line":39,"column":7}},"5":{"start":{"line":31,"column":8},"end":{"line":31,"column":51}},"6":{"start":{"line":32,"column":8},"end":{"line":32,"column":54}},"7":{"start":{"line":33,"column":8},"end":{"line":33,"column":53}},"8":{"start":{"line":36,"column":8},"end":{"line":36,"column":56}},"9":{"start":{"line":37,"column":8},"end":{"line":37,"column":55}},"10":{"start":{"line":38,"column":8},"end":{"line":38,"column":99}},"11":{"start":{"line":40,"column":6},"end":{"line":40,"column":30}},"12":{"start":{"line":43,"column":6},"end":{"line":43,"column":47}},"13":{"start":{"line":46,"column":6},"end":{"line":48,"column":7}},"14":{"start":{"line":47,"column":8},"end":{"line":47,"column":35}},"15":{"start":{"line":50,"column":6},"end":{"line":50,"column":28}},"16":{"start":{"line":69,"column":6},"end":{"line":69,"column":17}},"17":{"start":{"line":71,"column":6},"end":{"line":73,"column":7}},"18":{"start":{"line":72,"column":8},"end":{"line":72,"column":88}},"19":{"start":{"line":75,"column":6},"end":{"line":79,"column":7}},"20":{"start":{"line":76,"column":8},"end":{"line":78,"column":9}},"21":{"start":{"line":77,"column":10},"end":{"line":77,"column":38}},"22":{"start":{"line":83,"column":6},"end":{"line":83,"column":22}},"23":{"start":{"line":96,"column":6},"end":{"line":96,"column":31}},"24":{"start":{"line":97,"column":6},"end":{"line":97,"column":31}},"25":{"start":{"line":98,"column":6},"end":{"line":98,"column":29}},"26":{"start":{"line":117,"column":6},"end":{"line":127,"column":7}},"27":{"start":{"line":118,"column":8},"end":{"line":118,"column":35}},"28":{"start":{"line":120,"column":8},"end":{"line":126,"column":9}},"29":{"start":{"line":122,"column":12},"end":{"line":124,"column":15}},"30":{"start":{"line":123,"column":14},"end":{"line":123,"column":43}},"31":{"start":{"line":132,"column":2},"end":{"line":134,"column":3}},"32":{"start":{"line":133,"column":4},"end":{"line":133,"column":111}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":6},"end":{"line":29,"column":6}},{"start":{"line":29,"column":6},"end":{"line":29,"column":6}}]},"2":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":6},"end":{"line":46,"column":6}},{"start":{"line":46,"column":6},"end":{"line":46,"column":6}}]},"3":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":6},"end":{"line":71,"column":6}},{"start":{"line":71,"column":6},"end":{"line":71,"column":6}}]},"4":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":8},"end":{"line":76,"column":8}},{"start":{"line":76,"column":8},"end":{"line":76,"column":8}}]},"5":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":6},"end":{"line":117,"column":6}},{"start":{"line":117,"column":6},"end":{"line":117,"column":6}}]},"6":{"line":117,"type":"binary-expr","locations":[{"start":{"line":117,"column":10},"end":{"line":117,"column":12}},{"start":{"line":117,"column":16},"end":{"line":117,"column":40}}]},"7":{"line":133,"type":"cond-expr","locations":[{"start":{"line":133,"column":50},"end":{"line":133,"column":101}},{"start":{"line":133,"column":104},"end":{"line":133,"column":110}}]}},"code":["'use strict';","","var debug = require('debug')('socketstream:http'),","    cached = require('./cached'),","    settings = {           // User-configurable settings with sensible defaults","      port: 3000,","      'static': {","        maxAge: 2592000000    // (30 * 24 * 60 * 60 * 1000) cache static assets in the browser for 30 days","      },","      secure: false           // allow setting of the 'secure' cookie attribute when using SSL","                              // - see https://github.com/socketstream/socketstream/issues/349","    };","","/**"," * @ngdoc service"," * @name http.index:index"," * @function"," *"," * @description"," * HTTP Server"," * -----------"," * SocketStream does not concern itself with web servers. It simply provides a stack of Connect Middleware"," * which can be used by the application in any way it wishes."," */","module.exports = function(ss) {","  return {","    /* Return API */","    get middleware() {","      if (!this._middleware) {","        // Create new Connect app instance which can be accessed from your app.js file with ss.http.middleware","        this._middleware = ss.require('connect')();","        this._middleware.use(this.session.middleware);","        this._middleware.use(this.cached.middleware);","","        /* Alias app.use to indicate this will be added to the stack BEFORE SocketStream middleware */","        this._middleware.prepend = this._middleware.use;","        this._middleware.append = this._middleware.use;","        ss.log.warn('ss.http.middleware is deprecated, see socketstream-examples for the new way');","      }","      return this._middleware;","    },","    set middleware(mw) {","      debug('Setting SocketStream middleware');","","      // express support","      if (typeof mw.disable === 'function') {","        mw.disable('x-powered-by');","      }","","      this._middleware = mw;","    },","    cached: cached(ss),","    session: {","      middleware: sessionMiddleware","    },","","    /**","     * @ngdoc service","     * @name http.index:index#set","     * @methodOf http.index:index","     * @function","     *","     * @description","     * Merge optional settings","     *","     * @param {Object} newSettings Object with settins, @link settings","     */","    set: function(newSettings) {","      var s = '';","","      if (typeof newSettings !== 'object') {","        throw new Error('ss.http.set() takes an object e.g. {static: {maxAge: 60000}}');","      }","","      for (s in newSettings) {","        if (newSettings.hasOwnProperty(s)) {","          settings[s] = newSettings[s]","        }","      }","    },","","    get settings() {","      return settings;","    },","","    /**","     * @ngdoc service","     * @name http.index:index#load","     * @methodOf http.index:index","     * @function","     *","     * @description","     * Attached Middleware, Session store, staticCache, etc, to the this.middleware (`var app = connect()`)","     */","    load: function() {","      this.cached.loadStatic();","      this.cached.loadAssets();","      debug('http: loaded.');","    },","","    unload: function() {},","","    /**","     * @ngdoc service","     * @name http.index:index#route","     * @methodOf http.index:index","     * @function","     *","     * @description","     * Expose short-form routing API","     *","     * @param  {String}   url Url string for routing","     * @param  {Function} fn  Callback function for url","     * @return {Object}       res.serveClient(name) object","     */","    route: function(url, fn) {","      if (fn && typeof fn === 'function') {","        this.cached.route(url, fn);","      } else {","        return {","          serveClient: (function(name) {","            this.cached.route(url,function(req, res) {","              return res.serveClient(name);","            });","          }).bind(this)","        }","      }","    }","  };","","  // wrapped to allow using the middleware before the strategy is set","  function sessionMiddleware(req,res,next) {","    return ss.session.strategy.sessionMiddleware? ss.session.strategy.sessionMiddleware(req,res,next) : next();","  }","};",""],"l":{"3":1,"25":1,"26":1,"29":10,"31":10,"32":0,"33":0,"36":0,"37":0,"38":0,"40":0,"43":0,"46":0,"47":0,"50":0,"69":0,"71":0,"72":0,"75":0,"76":0,"77":0,"83":14,"96":0,"97":0,"98":0,"117":0,"118":0,"120":0,"122":0,"123":0,"132":1,"133":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/http/cached.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/http/cached.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":1,"49":8,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":1,"61":0,"62":0,"63":0,"64":1,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":1,"72":0,"73":0,"74":0,"75":0,"76":0,"77":1,"78":0,"79":0,"80":0,"81":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":8,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"fnMap":{"1":{"name":"cached","line":21,"loc":{"start":{"line":21,"column":17},"end":{"line":21,"column":37}}},"2":{"name":"KnownPoint","line":26,"loc":{"start":{"line":26,"column":1},"end":{"line":26,"column":40}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":31},"end":{"line":36,"column":56}}},"4":{"name":"error","line":50,"loc":{"start":{"line":50,"column":23},"end":{"line":50,"column":43}}},"5":{"name":"getPoint","line":62,"loc":{"start":{"line":62,"column":1},"end":{"line":62,"column":24}}},"6":{"name":"route","line":78,"loc":{"start":{"line":78,"column":1},"end":{"line":78,"column":35}}},"7":{"name":"(anonymous_7)","line":94,"loc":{"start":{"line":94,"column":16},"end":{"line":94,"column":19}}},"8":{"name":"(anonymous_8)","line":102,"loc":{"start":{"line":102,"column":16},"end":{"line":102,"column":27}}},"9":{"name":"(anonymous_9)","line":104,"loc":{"start":{"line":104,"column":82},"end":{"line":104,"column":94}}},"10":{"name":"(anonymous_10)","line":109,"loc":{"start":{"line":109,"column":20},"end":{"line":109,"column":34}}},"11":{"name":"(anonymous_11)","line":114,"loc":{"start":{"line":114,"column":16},"end":{"line":114,"column":27}}},"12":{"name":"(anonymous_12)","line":117,"loc":{"start":{"line":117,"column":30},"end":{"line":117,"column":42}}},"13":{"name":"(anonymous_13)","line":120,"loc":{"start":{"line":120,"column":22},"end":{"line":120,"column":36}}},"14":{"name":"assetPathServed","line":127,"loc":{"start":{"line":127,"column":4},"end":{"line":127,"column":39}}},"15":{"name":"sendInternal","line":134,"loc":{"start":{"line":134,"column":4},"end":{"line":134,"column":35}}},"16":{"name":"set","line":146,"loc":{"start":{"line":146,"column":4},"end":{"line":146,"column":41}}},"17":{"name":"cachedMiddleware","line":154,"loc":{"start":{"line":154,"column":1},"end":{"line":154,"column":43}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":10,"column":24}},"2":{"start":{"line":21,"column":0},"end":{"line":162,"column":2}},"3":{"start":{"line":24,"column":1},"end":{"line":24,"column":17}},"4":{"start":{"line":26,"column":1},"end":{"line":32,"column":2}},"5":{"start":{"line":27,"column":2},"end":{"line":27,"column":17}},"6":{"start":{"line":28,"column":4},"end":{"line":28,"column":33}},"7":{"start":{"line":28,"column":14},"end":{"line":28,"column":31}},"8":{"start":{"line":29,"column":4},"end":{"line":29,"column":47}},"9":{"start":{"line":29,"column":20},"end":{"line":29,"column":45}},"10":{"start":{"line":31,"column":2},"end":{"line":31,"column":21}},"11":{"start":{"line":34,"column":1},"end":{"line":34,"column":35}},"12":{"start":{"line":36,"column":1},"end":{"line":60,"column":3}},"13":{"start":{"line":37,"column":2},"end":{"line":43,"column":3}},"14":{"start":{"line":39,"column":3},"end":{"line":39,"column":64}},"15":{"start":{"line":40,"column":6},"end":{"line":40,"column":41}},"16":{"start":{"line":41,"column":3},"end":{"line":41,"column":25}},"17":{"start":{"line":42,"column":3},"end":{"line":42,"column":10}},"18":{"start":{"line":45,"column":2},"end":{"line":57,"column":3}},"19":{"start":{"line":46,"column":3},"end":{"line":46,"column":55}},"20":{"start":{"line":48,"column":3},"end":{"line":53,"column":4}},"21":{"start":{"line":50,"column":4},"end":{"line":52,"column":7}},"22":{"start":{"line":51,"column":5},"end":{"line":51,"column":42}},"23":{"start":{"line":55,"column":3},"end":{"line":55,"column":20}},"24":{"start":{"line":56,"column":3},"end":{"line":56,"column":10}},"25":{"start":{"line":59,"column":2},"end":{"line":59,"column":23}},"26":{"start":{"line":59,"column":14},"end":{"line":59,"column":21}},"27":{"start":{"line":62,"column":1},"end":{"line":75,"column":2}},"28":{"start":{"line":63,"column":2},"end":{"line":63,"column":10}},"29":{"start":{"line":64,"column":2},"end":{"line":72,"column":3}},"30":{"start":{"line":65,"column":3},"end":{"line":65,"column":37}},"31":{"start":{"line":67,"column":6},"end":{"line":69,"column":7}},"32":{"start":{"line":68,"column":8},"end":{"line":68,"column":20}},"33":{"start":{"line":70,"column":6},"end":{"line":70,"column":31}},"34":{"start":{"line":73,"column":2},"end":{"line":73,"column":55}},"35":{"start":{"line":74,"column":2},"end":{"line":74,"column":15}},"36":{"start":{"line":78,"column":1},"end":{"line":91,"column":2}},"37":{"start":{"line":79,"column":2},"end":{"line":79,"column":47}},"38":{"start":{"line":79,"column":31},"end":{"line":79,"column":45}},"39":{"start":{"line":81,"column":2},"end":{"line":81,"column":28}},"40":{"start":{"line":82,"column":2},"end":{"line":90,"column":3}},"41":{"start":{"line":83,"column":3},"end":{"line":83,"column":33}},"42":{"start":{"line":83,"column":13},"end":{"line":83,"column":31}},"43":{"start":{"line":84,"column":3},"end":{"line":84,"column":47}},"44":{"start":{"line":84,"column":19},"end":{"line":84,"column":45}},"45":{"start":{"line":86,"column":3},"end":{"line":86,"column":45}},"46":{"start":{"line":87,"column":3},"end":{"line":89,"column":4}},"47":{"start":{"line":88,"column":4},"end":{"line":88,"column":74}},"48":{"start":{"line":93,"column":1},"end":{"line":125,"column":6}},"49":{"start":{"line":95,"column":3},"end":{"line":95,"column":27}},"50":{"start":{"line":103,"column":6},"end":{"line":103,"column":78}},"51":{"start":{"line":104,"column":6},"end":{"line":107,"column":9}},"52":{"start":{"line":106,"column":8},"end":{"line":106,"column":39}},"53":{"start":{"line":109,"column":6},"end":{"line":111,"column":9}},"54":{"start":{"line":110,"column":8},"end":{"line":110,"column":62}},"55":{"start":{"line":115,"column":8},"end":{"line":118,"column":32}},"56":{"start":{"line":117,"column":44},"end":{"line":117,"column":53}},"57":{"start":{"line":120,"column":8},"end":{"line":122,"column":11}},"58":{"start":{"line":121,"column":10},"end":{"line":121,"column":71}},"59":{"start":{"line":123,"column":4},"end":{"line":123,"column":58}},"60":{"start":{"line":127,"column":4},"end":{"line":132,"column":5}},"61":{"start":{"line":128,"column":6},"end":{"line":130,"column":7}},"62":{"start":{"line":129,"column":8},"end":{"line":129,"column":38}},"63":{"start":{"line":131,"column":6},"end":{"line":131,"column":22}},"64":{"start":{"line":134,"column":4},"end":{"line":143,"column":5}},"65":{"start":{"line":135,"column":3},"end":{"line":135,"column":48}},"66":{"start":{"line":135,"column":32},"end":{"line":135,"column":46}},"67":{"start":{"line":136,"column":3},"end":{"line":136,"column":29}},"68":{"start":{"line":138,"column":3},"end":{"line":142,"column":4}},"69":{"start":{"line":139,"column":4},"end":{"line":139,"column":31}},"70":{"start":{"line":141,"column":4},"end":{"line":141,"column":41}},"71":{"start":{"line":146,"column":4},"end":{"line":152,"column":5}},"72":{"start":{"line":147,"column":3},"end":{"line":147,"column":48}},"73":{"start":{"line":147,"column":32},"end":{"line":147,"column":46}},"74":{"start":{"line":148,"column":3},"end":{"line":148,"column":52}},"75":{"start":{"line":150,"column":3},"end":{"line":150,"column":27}},"76":{"start":{"line":151,"column":3},"end":{"line":151,"column":29}},"77":{"start":{"line":154,"column":1},"end":{"line":161,"column":2}},"78":{"start":{"line":155,"column":2},"end":{"line":155,"column":28}},"79":{"start":{"line":157,"column":2},"end":{"line":159,"column":3}},"80":{"start":{"line":158,"column":3},"end":{"line":158,"column":37}},"81":{"start":{"line":160,"column":2},"end":{"line":160,"column":9}}},"branchMap":{"1":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":28,"column":4}},{"start":{"line":28,"column":4},"end":{"line":28,"column":4}}]},"2":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":4}},{"start":{"line":29,"column":4},"end":{"line":29,"column":4}}]},"3":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":37,"column":2}},{"start":{"line":37,"column":2},"end":{"line":37,"column":2}}]},"4":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":33},"end":{"line":39,"column":46}},{"start":{"line":39,"column":50},"end":{"line":39,"column":62}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":2},"end":{"line":45,"column":2}},{"start":{"line":45,"column":2},"end":{"line":45,"column":2}}]},"6":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":3},"end":{"line":48,"column":3}},{"start":{"line":48,"column":3},"end":{"line":48,"column":3}}]},"7":{"line":51,"type":"cond-expr","locations":[{"start":{"line":51,"column":30},"end":{"line":51,"column":34}},{"start":{"line":51,"column":37},"end":{"line":51,"column":40}}]},"8":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":2},"end":{"line":59,"column":2}},{"start":{"line":59,"column":2},"end":{"line":59,"column":2}}]},"9":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":2},"end":{"line":64,"column":2}},{"start":{"line":64,"column":2},"end":{"line":64,"column":2}}]},"10":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":6},"end":{"line":67,"column":6}},{"start":{"line":67,"column":6},"end":{"line":67,"column":6}}]},"11":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":10},"end":{"line":67,"column":30}},{"start":{"line":67,"column":34},"end":{"line":67,"column":55}}]},"12":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":14},"end":{"line":73,"column":30}},{"start":{"line":73,"column":34},"end":{"line":73,"column":54}}]},"13":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":2},"end":{"line":79,"column":2}},{"start":{"line":79,"column":2},"end":{"line":79,"column":2}}]},"14":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":2},"end":{"line":82,"column":2}},{"start":{"line":82,"column":2},"end":{"line":82,"column":2}}]},"15":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":3},"end":{"line":83,"column":3}},{"start":{"line":83,"column":3},"end":{"line":83,"column":3}}]},"16":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":3},"end":{"line":84,"column":3}},{"start":{"line":84,"column":3},"end":{"line":84,"column":3}}]},"17":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":3},"end":{"line":87,"column":3}},{"start":{"line":87,"column":3},"end":{"line":87,"column":3}}]},"18":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":6},"end":{"line":128,"column":6}},{"start":{"line":128,"column":6},"end":{"line":128,"column":6}}]},"19":{"line":135,"type":"if","locations":[{"start":{"line":135,"column":3},"end":{"line":135,"column":3}},{"start":{"line":135,"column":3},"end":{"line":135,"column":3}}]},"20":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":3},"end":{"line":138,"column":3}},{"start":{"line":138,"column":3},"end":{"line":138,"column":3}}]},"21":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":3},"end":{"line":147,"column":3}},{"start":{"line":147,"column":3},"end":{"line":147,"column":3}}]},"22":{"line":148,"type":"binary-expr","locations":[{"start":{"line":148,"column":15},"end":{"line":148,"column":28}},{"start":{"line":148,"column":32},"end":{"line":148,"column":51}}]},"23":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":2},"end":{"line":157,"column":2}},{"start":{"line":157,"column":2},"end":{"line":157,"column":2}}]}},"code":["'use strict';","/**"," * Ensure that content is up-to-date in edge caches"," */","","var parseurl = require('parseurl'),","\tdebug = require('debug')('http'),","\tsend = require('send'),","\tglob = require('glob'),","\tpath = require('path');","","/*"," Files in static directory are cached and files as is under root.",""," Files in assets directory are cached and served under `assets/` with their location in the file syste."," Files ending with .index.html are served as index files.",""," Known paths are remembered either pointing to a file on the fs or by in memory content."," */","","module.exports = function cached(ss) {","","\t// known endpoints are cached by path","\tvar byPath = {};","","\tfunction KnownPoint(url, fn, filePath) {","\t\tthis.url = url;","    if (fn) { this.handle = fn; }","    if (filePath) { this.filePath = filePath; }","","\t\tbyPath[url] = this;","\t}","","\tKnownPoint.prototype.options = {};","","\tKnownPoint.prototype.handle = function(req, res, next) {","\t\tif (this.content) {","      // res.statusCode = 303","\t\t\tres.setHeader('Content-Type', this.mimeType || 'text/plain');","      res.setHeader('Location', this.url)","\t\t\tres.end(this.content);","\t\t\treturn;","\t\t}","","\t\tif (this.filePath) {","\t\t\tvar stream = send(req, this.filePath, this.options);","","\t\t\tif (next) {","\t\t\t\t// forward non-404 errors","\t\t\t\tstream.on('error', function error(err) {","\t\t\t\t\tnext(err.status === 404? null : err);","\t\t\t\t});","\t\t\t}","","\t\t\tstream.pipe(res);","\t\t\treturn;","\t\t}","","\t\tif (next) { next(); }","\t};","","\tfunction getPoint(req) {","\t\tvar url;","\t\tif (typeof req === 'string') {","\t\t\turl = { path:req, pathname: req };","\t\t} else {","\t\t    if (req.method !== 'GET' && req.method !== 'HEAD') {","\t\t      return null;","\t\t    }","\t\t    url = parseurl(req,true);","","\t\t}","\t\tvar point = byPath[url.path] || byPath[url.pathname];","\t\treturn point;","\t}","","","\tfunction route(url, fn, filePath) {","\t\tif (url.charAt(0) !== '/') { url = '/'+url; }","\t\t// console.log('route defined',url);","\t\tvar point = getPoint(url);","\t\tif (point) {","\t\t\tif (fn) { point.handle = fn; }","\t\t\tif (filePath) { point.filePath = filePath; }","\t\t} else {","\t\t\tpoint = new KnownPoint(url, fn, filePath);","\t\t\tif (!fn) {","\t\t\t\tdebug('added known point %s pointing to static file %s',url,filePath);","\t\t\t}","\t\t}","\t}","","\treturn {","\t\tget middleware() {","\t\t\treturn cachedMiddleware;","\t\t},","","\t\troute: route,","\t\tsend: sendInternal,","\t\tset: set,","","    loadStatic: function() {","      var assets = path.relative(ss.client.dirs.static,ss.client.dirs.assets);","      var files = glob.sync('**/*',{cwd:ss.client.dirs.static,nodir:true}).filter(function(p) {","        //TODO exclude directories","        return p.indexOf(assets) !== 0;","      });","","      files.forEach(function(url) {","        route(url,null,path.join(ss.client.dirs.static, url));","      });","    },","","    loadAssets: function() {","        var files = glob.sync('**/*',{cwd:ss.client.dirs.assets,nodir:true})","                      .map(assetPathServed)","                      .filter(function(p) { return p; }),","            prefix = '/assets/'; // should this be configurable?","","        files.forEach(function(url) {","          route(prefix+url,null,path.join(ss.client.dirs.assets, url));","        });","\t\t\t\tdebug('route ready for assets %s', Object.keys(files))","\t    }","    };","","    function assetPathServed(filePath) {","      if (/\\.index\\.html/.test(filePath)) {","        return path.dirname(filePath);","      }","      return filePath; // URL path","    }","","    function sendInternal(url,res) {","\t\t\tif (url.charAt(0) !== '/') { url = '/'+url; }","\t\t\tvar point = getPoint(url);","\t\t\t// console.log(url,res,'sent');","\t\t\tif (point) {","\t\t\t\tpoint.handle(res.req, res);","\t\t\t} else {","\t\t\t\tss.log.error('Couldn\\'t serve', url);","\t\t\t}","    }","","    // assumed to be dev time frame, if this is to be used for production it should be enhanced","    function set(url, content, mimeType) {","\t\t\tif (url.charAt(0) !== '/') { url = '/'+url; }","\t\t\tvar point = getPoint(url) || new KnownPoint(url);","\t\t\t// console.info('new url:',url, mimeType);","\t\t\tpoint.content = content;","\t\t\tpoint.mimeType = mimeType;","    }","","\tfunction cachedMiddleware(req, res, next) {","\t\tvar point = getPoint(req);","\t\t// console.log('cmw',point,req.url);","\t\tif (point) {","\t\t\treturn point.handle(req,res,next);","\t\t}","\t\tnext();","\t}","};",""],"l":{"6":1,"21":1,"24":1,"26":1,"27":0,"28":0,"29":0,"31":0,"34":1,"36":1,"37":0,"39":0,"40":0,"41":0,"42":0,"45":0,"46":0,"48":0,"50":0,"51":0,"55":0,"56":0,"59":0,"62":1,"63":0,"64":0,"65":0,"67":0,"68":0,"70":0,"73":0,"74":0,"78":1,"79":0,"81":0,"82":0,"83":0,"84":0,"86":0,"87":0,"88":0,"93":1,"95":8,"103":0,"104":0,"106":0,"109":0,"110":0,"115":0,"117":0,"120":0,"121":0,"123":0,"127":1,"128":0,"129":0,"131":0,"134":1,"135":0,"136":0,"138":0,"139":0,"141":0,"146":1,"147":0,"148":0,"150":0,"151":0,"154":1,"155":0,"157":0,"158":0,"160":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":0,"20":1,"21":1,"22":1,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":1,"58":1,"59":1,"60":1,"61":2,"62":2,"63":2,"64":2,"65":2,"66":2,"67":2,"68":2,"69":14,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0},"b":{"1":[1,1],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[1,1],"13":[1,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0]},"f":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":2,"11":2,"12":2,"13":2,"14":2,"15":2,"16":2,"17":2,"18":14,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0},"fnMap":{"1":{"name":"setDefaultOptions","line":19,"loc":{"start":{"line":19,"column":0},"end":{"line":19,"column":36}}},"2":{"name":"(anonymous_2)","line":65,"loc":{"start":{"line":65,"column":17},"end":{"line":65,"column":30}}},"3":{"name":"(anonymous_3)","line":74,"loc":{"start":{"line":74,"column":20},"end":{"line":74,"column":35}}},"4":{"name":"reloadClients","line":89,"loc":{"start":{"line":89,"column":2},"end":{"line":89,"column":44}}},"5":{"name":"onChangeFiltered","line":94,"loc":{"start":{"line":94,"column":5},"end":{"line":94,"column":51}}},"6":{"name":"onChange","line":108,"loc":{"start":{"line":108,"column":5},"end":{"line":108,"column":43}}},"7":{"name":"(anonymous_7)","line":122,"loc":{"start":{"line":122,"column":46},"end":{"line":122,"column":56}}},"8":{"name":"(anonymous_8)","line":124,"loc":{"start":{"line":124,"column":50},"end":{"line":124,"column":60}}},"9":{"name":"(anonymous_9)","line":138,"loc":{"start":{"line":138,"column":10},"end":{"line":138,"column":21}}},"10":{"name":"(anonymous_10)","line":156,"loc":{"start":{"line":156,"column":14},"end":{"line":156,"column":17}}},"11":{"name":"(anonymous_11)","line":159,"loc":{"start":{"line":159,"column":14},"end":{"line":159,"column":17}}},"12":{"name":"(anonymous_12)","line":162,"loc":{"start":{"line":162,"column":16},"end":{"line":162,"column":19}}},"13":{"name":"(anonymous_13)","line":165,"loc":{"start":{"line":165,"column":17},"end":{"line":165,"column":20}}},"14":{"name":"(anonymous_14)","line":168,"loc":{"start":{"line":168,"column":13},"end":{"line":168,"column":16}}},"15":{"name":"(anonymous_15)","line":171,"loc":{"start":{"line":171,"column":16},"end":{"line":171,"column":19}}},"16":{"name":"(anonymous_16)","line":174,"loc":{"start":{"line":174,"column":16},"end":{"line":174,"column":19}}},"17":{"name":"(anonymous_17)","line":177,"loc":{"start":{"line":177,"column":15},"end":{"line":177,"column":18}}},"18":{"name":"(anonymous_18)","line":201,"loc":{"start":{"line":201,"column":19},"end":{"line":201,"column":22}}},"19":{"name":"(anonymous_19)","line":206,"loc":{"start":{"line":206,"column":9},"end":{"line":206,"column":29}}},"20":{"name":"(anonymous_20)","line":217,"loc":{"start":{"line":217,"column":27},"end":{"line":217,"column":38}}},"21":{"name":"(anonymous_21)","line":241,"loc":{"start":{"line":241,"column":17},"end":{"line":241,"column":32}}},"22":{"name":"(anonymous_22)","line":250,"loc":{"start":{"line":250,"column":16},"end":{"line":250,"column":31}}},"23":{"name":"(anonymous_23)","line":261,"loc":{"start":{"line":261,"column":47},"end":{"line":261,"column":61}}},"24":{"name":"(anonymous_24)","line":283,"loc":{"start":{"line":283,"column":12},"end":{"line":283,"column":27}}},"25":{"name":"(anonymous_25)","line":324,"loc":{"start":{"line":324,"column":10},"end":{"line":324,"column":49}}},"26":{"name":"(anonymous_26)","line":326,"loc":{"start":{"line":326,"column":34},"end":{"line":326,"column":49}}},"27":{"name":"(anonymous_27)","line":333,"loc":{"start":{"line":333,"column":18},"end":{"line":333,"column":29}}},"28":{"name":"(anonymous_28)","line":338,"loc":{"start":{"line":338,"column":25},"end":{"line":338,"column":43}}},"29":{"name":"(anonymous_29)","line":344,"loc":{"start":{"line":344,"column":13},"end":{"line":344,"column":35}}},"30":{"name":"(anonymous_30)","line":347,"loc":{"start":{"line":347,"column":15},"end":{"line":347,"column":37}}},"31":{"name":"(anonymous_31)","line":350,"loc":{"start":{"line":350,"column":15},"end":{"line":350,"column":37}}},"32":{"name":"(anonymous_32)","line":359,"loc":{"start":{"line":359,"column":10},"end":{"line":359,"column":21}}},"33":{"name":"(anonymous_33)","line":361,"loc":{"start":{"line":361,"column":27},"end":{"line":361,"column":45}}},"34":{"name":"(anonymous_34)","line":376,"loc":{"start":{"line":376,"column":12},"end":{"line":376,"column":23}}},"35":{"name":"(anonymous_35)","line":383,"loc":{"start":{"line":383,"column":12},"end":{"line":383,"column":23}}}},"statementMap":{"1":{"start":{"line":9,"column":0},"end":{"line":9,"column":18}},"2":{"start":{"line":11,"column":0},"end":{"line":14,"column":39}},"3":{"start":{"line":17,"column":0},"end":{"line":17,"column":17}},"4":{"start":{"line":19,"column":0},"end":{"line":45,"column":1}},"5":{"start":{"line":22,"column":2},"end":{"line":22,"column":39}},"6":{"start":{"line":24,"column":2},"end":{"line":24,"column":42}},"7":{"start":{"line":26,"column":2},"end":{"line":26,"column":71}},"8":{"start":{"line":27,"column":2},"end":{"line":27,"column":32}},"9":{"start":{"line":28,"column":2},"end":{"line":28,"column":50}},"10":{"start":{"line":29,"column":2},"end":{"line":29,"column":38}},"11":{"start":{"line":30,"column":2},"end":{"line":32,"column":4}},"12":{"start":{"line":34,"column":2},"end":{"line":44,"column":4}},"13":{"start":{"line":47,"column":0},"end":{"line":47,"column":27}},"14":{"start":{"line":50,"column":0},"end":{"line":50,"column":17}},"15":{"start":{"line":65,"column":0},"end":{"line":392,"column":2}},"16":{"start":{"line":67,"column":2},"end":{"line":67,"column":54}},"17":{"start":{"line":71,"column":2},"end":{"line":71,"column":53}},"18":{"start":{"line":74,"column":2},"end":{"line":76,"column":4}},"19":{"start":{"line":75,"column":4},"end":{"line":75,"column":82}},"20":{"start":{"line":79,"column":2},"end":{"line":79,"column":30}},"21":{"start":{"line":82,"column":2},"end":{"line":87,"column":8}},"22":{"start":{"line":89,"column":2},"end":{"line":134,"column":3}},"23":{"start":{"line":90,"column":5},"end":{"line":92,"column":54}},"24":{"start":{"line":94,"column":5},"end":{"line":105,"column":6}},"25":{"start":{"line":95,"column":9},"end":{"line":95,"column":61}},"26":{"start":{"line":96,"column":9},"end":{"line":96,"column":36}},"27":{"start":{"line":97,"column":9},"end":{"line":99,"column":10}},"28":{"start":{"line":98,"column":13},"end":{"line":98,"column":70}},"29":{"start":{"line":100,"column":9},"end":{"line":102,"column":10}},"30":{"start":{"line":101,"column":13},"end":{"line":101,"column":34}},"31":{"start":{"line":104,"column":9},"end":{"line":104,"column":41}},"32":{"start":{"line":108,"column":5},"end":{"line":131,"column":6}},"33":{"start":{"line":109,"column":7},"end":{"line":110,"column":78}},"34":{"start":{"line":114,"column":7},"end":{"line":116,"column":8}},"35":{"start":{"line":115,"column":11},"end":{"line":115,"column":79}},"36":{"start":{"line":115,"column":70},"end":{"line":115,"column":78}},"37":{"start":{"line":119,"column":7},"end":{"line":119,"column":27}},"38":{"start":{"line":120,"column":7},"end":{"line":120,"column":98}},"39":{"start":{"line":120,"column":40},"end":{"line":120,"column":80}},"40":{"start":{"line":120,"column":81},"end":{"line":120,"column":97}},"41":{"start":{"line":121,"column":7},"end":{"line":121,"column":98}},"42":{"start":{"line":121,"column":40},"end":{"line":121,"column":80}},"43":{"start":{"line":121,"column":81},"end":{"line":121,"column":97}},"44":{"start":{"line":122,"column":7},"end":{"line":128,"column":21}},"45":{"start":{"line":123,"column":11},"end":{"line":123,"column":56}},"46":{"start":{"line":124,"column":11},"end":{"line":126,"column":25}},"47":{"start":{"line":125,"column":15},"end":{"line":125,"column":46}},"48":{"start":{"line":127,"column":12},"end":{"line":127,"column":43}},"49":{"start":{"line":130,"column":7},"end":{"line":130,"column":25}},"50":{"start":{"line":133,"column":5},"end":{"line":133,"column":41}},"51":{"start":{"line":137,"column":2},"end":{"line":391,"column":4}},"52":{"start":{"line":139,"column":6},"end":{"line":139,"column":92}},"53":{"start":{"line":141,"column":6},"end":{"line":149,"column":7}},"54":{"start":{"line":142,"column":8},"end":{"line":142,"column":62}},"55":{"start":{"line":145,"column":8},"end":{"line":145,"column":42}},"56":{"start":{"line":146,"column":8},"end":{"line":146,"column":35}},"57":{"start":{"line":147,"column":8},"end":{"line":147,"column":36}},"58":{"start":{"line":148,"column":8},"end":{"line":148,"column":35}},"59":{"start":{"line":151,"column":6},"end":{"line":151,"column":26}},"60":{"start":{"line":153,"column":6},"end":{"line":153,"column":18}},"61":{"start":{"line":157,"column":8},"end":{"line":157,"column":54}},"62":{"start":{"line":160,"column":8},"end":{"line":160,"column":52}},"63":{"start":{"line":163,"column":8},"end":{"line":163,"column":54}},"64":{"start":{"line":166,"column":8},"end":{"line":166,"column":55}},"65":{"start":{"line":169,"column":8},"end":{"line":169,"column":51}},"66":{"start":{"line":172,"column":8},"end":{"line":172,"column":54}},"67":{"start":{"line":175,"column":8},"end":{"line":175,"column":54}},"68":{"start":{"line":178,"column":8},"end":{"line":178,"column":53}},"69":{"start":{"line":202,"column":6},"end":{"line":202,"column":66}},"70":{"start":{"line":207,"column":6},"end":{"line":207,"column":28}},"71":{"start":{"line":208,"column":6},"end":{"line":210,"column":7}},"72":{"start":{"line":209,"column":8},"end":{"line":209,"column":84}},"73":{"start":{"line":211,"column":6},"end":{"line":211,"column":20}},"74":{"start":{"line":212,"column":6},"end":{"line":237,"column":7}},"75":{"start":{"line":213,"column":8},"end":{"line":236,"column":9}},"76":{"start":{"line":214,"column":10},"end":{"line":214,"column":27}},"77":{"start":{"line":215,"column":10},"end":{"line":235,"column":11}},"78":{"start":{"line":217,"column":12},"end":{"line":232,"column":18}},"79":{"start":{"line":218,"column":14},"end":{"line":218,"column":31}},"80":{"start":{"line":219,"column":14},"end":{"line":219,"column":29}},"81":{"start":{"line":220,"column":14},"end":{"line":230,"column":15}},"82":{"start":{"line":221,"column":16},"end":{"line":229,"column":17}},"83":{"start":{"line":222,"column":18},"end":{"line":222,"column":27}},"84":{"start":{"line":224,"column":18},"end":{"line":226,"column":19}},"85":{"start":{"line":225,"column":20},"end":{"line":225,"column":35}},"86":{"start":{"line":228,"column":18},"end":{"line":228,"column":52}},"87":{"start":{"line":231,"column":14},"end":{"line":231,"column":31}},"88":{"start":{"line":234,"column":12},"end":{"line":234,"column":42}},"89":{"start":{"line":238,"column":6},"end":{"line":238,"column":22}},"90":{"start":{"line":242,"column":6},"end":{"line":244,"column":7}},"91":{"start":{"line":243,"column":8},"end":{"line":243,"column":87}},"92":{"start":{"line":245,"column":6},"end":{"line":245,"column":41}},"93":{"start":{"line":246,"column":6},"end":{"line":246,"column":33}},"94":{"start":{"line":251,"column":6},"end":{"line":253,"column":7}},"95":{"start":{"line":252,"column":8},"end":{"line":252,"column":86}},"96":{"start":{"line":254,"column":6},"end":{"line":254,"column":42}},"97":{"start":{"line":255,"column":6},"end":{"line":255,"column":41}},"98":{"start":{"line":256,"column":6},"end":{"line":256,"column":33}},"99":{"start":{"line":260,"column":6},"end":{"line":265,"column":7}},"100":{"start":{"line":261,"column":8},"end":{"line":264,"column":11}},"101":{"start":{"line":262,"column":10},"end":{"line":262,"column":47}},"102":{"start":{"line":263,"column":10},"end":{"line":263,"column":38}},"103":{"start":{"line":284,"column":6},"end":{"line":286,"column":7}},"104":{"start":{"line":285,"column":8},"end":{"line":285,"column":81}},"105":{"start":{"line":288,"column":6},"end":{"line":298,"column":8}},"106":{"start":{"line":299,"column":6},"end":{"line":299,"column":34}},"107":{"start":{"line":301,"column":6},"end":{"line":301,"column":42}},"108":{"start":{"line":303,"column":6},"end":{"line":303,"column":20}},"109":{"start":{"line":326,"column":6},"end":{"line":328,"column":9}},"110":{"start":{"line":327,"column":8},"end":{"line":327,"column":31}},"111":{"start":{"line":329,"column":6},"end":{"line":329,"column":52}},"112":{"start":{"line":334,"column":6},"end":{"line":334,"column":34}},"113":{"start":{"line":335,"column":6},"end":{"line":335,"column":34}},"114":{"start":{"line":336,"column":6},"end":{"line":336,"column":46}},"115":{"start":{"line":338,"column":6},"end":{"line":340,"column":9}},"116":{"start":{"line":339,"column":8},"end":{"line":339,"column":40}},"117":{"start":{"line":345,"column":8},"end":{"line":345,"column":50}},"118":{"start":{"line":348,"column":8},"end":{"line":348,"column":52}},"119":{"start":{"line":351,"column":8},"end":{"line":351,"column":52}},"120":{"start":{"line":360,"column":6},"end":{"line":364,"column":7}},"121":{"start":{"line":361,"column":8},"end":{"line":363,"column":11}},"122":{"start":{"line":362,"column":10},"end":{"line":362,"column":39}},"123":{"start":{"line":365,"column":6},"end":{"line":365,"column":24}},"124":{"start":{"line":372,"column":6},"end":{"line":372,"column":52}},"125":{"start":{"line":373,"column":6},"end":{"line":373,"column":61}},"126":{"start":{"line":377,"column":6},"end":{"line":377,"column":32}},"127":{"start":{"line":378,"column":6},"end":{"line":378,"column":37}},"128":{"start":{"line":379,"column":6},"end":{"line":379,"column":26}},"129":{"start":{"line":380,"column":6},"end":{"line":380,"column":28}},"130":{"start":{"line":384,"column":8},"end":{"line":384,"column":21}},"131":{"start":{"line":385,"column":8},"end":{"line":385,"column":35}},"132":{"start":{"line":386,"column":8},"end":{"line":386,"column":30}},"133":{"start":{"line":387,"column":8},"end":{"line":387,"column":28}},"134":{"start":{"line":388,"column":8},"end":{"line":388,"column":94}},"135":{"start":{"line":388,"column":35},"end":{"line":388,"column":64}},"136":{"start":{"line":388,"column":65},"end":{"line":388,"column":92}},"137":{"start":{"line":389,"column":8},"end":{"line":389,"column":82}},"138":{"start":{"line":389,"column":31},"end":{"line":389,"column":56}},"139":{"start":{"line":389,"column":57},"end":{"line":389,"column":80}}},"branchMap":{"1":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":25},"end":{"line":24,"column":32}},{"start":{"line":24,"column":36},"end":{"line":24,"column":41}}]},"2":{"line":90,"type":"binary-expr","locations":[{"start":{"line":90,"column":26},"end":{"line":90,"column":42}},{"start":{"line":90,"column":46},"end":{"line":90,"column":48}}]},"3":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":21},"end":{"line":91,"column":45}},{"start":{"line":91,"column":49},"end":{"line":91,"column":52}}]},"4":{"line":92,"type":"binary-expr","locations":[{"start":{"line":92,"column":21},"end":{"line":92,"column":45}},{"start":{"line":92,"column":49},"end":{"line":92,"column":53}}]},"5":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":9},"end":{"line":97,"column":9}},{"start":{"line":97,"column":9},"end":{"line":97,"column":9}}]},"6":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":9},"end":{"line":100,"column":9}},{"start":{"line":100,"column":9},"end":{"line":100,"column":9}}]},"7":{"line":110,"type":"cond-expr","locations":[{"start":{"line":110,"column":55},"end":{"line":110,"column":66}},{"start":{"line":110,"column":69},"end":{"line":110,"column":77}}]},"8":{"line":114,"type":"if","locations":[{"start":{"line":114,"column":7},"end":{"line":114,"column":7}},{"start":{"line":114,"column":7},"end":{"line":114,"column":7}}]},"9":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":11},"end":{"line":115,"column":11}},{"start":{"line":115,"column":11},"end":{"line":115,"column":11}}]},"10":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":7},"end":{"line":120,"column":7}},{"start":{"line":120,"column":7},"end":{"line":120,"column":7}}]},"11":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":7},"end":{"line":121,"column":7}},{"start":{"line":121,"column":7},"end":{"line":121,"column":7}}]},"12":{"line":139,"type":"binary-expr","locations":[{"start":{"line":139,"column":28},"end":{"line":139,"column":47}},{"start":{"line":139,"column":51},"end":{"line":139,"column":91}}]},"13":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":6},"end":{"line":141,"column":6}},{"start":{"line":141,"column":6},"end":{"line":141,"column":6}}]},"14":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":6},"end":{"line":208,"column":6}},{"start":{"line":208,"column":6},"end":{"line":208,"column":6}}]},"15":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":8},"end":{"line":213,"column":8}},{"start":{"line":213,"column":8},"end":{"line":213,"column":8}}]},"16":{"line":215,"type":"if","locations":[{"start":{"line":215,"column":10},"end":{"line":215,"column":10}},{"start":{"line":215,"column":10},"end":{"line":215,"column":10}}]},"17":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":16},"end":{"line":221,"column":16}},{"start":{"line":221,"column":16},"end":{"line":221,"column":16}}]},"18":{"line":224,"type":"if","locations":[{"start":{"line":224,"column":18},"end":{"line":224,"column":18}},{"start":{"line":224,"column":18},"end":{"line":224,"column":18}}]},"19":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":6},"end":{"line":242,"column":6}},{"start":{"line":242,"column":6},"end":{"line":242,"column":6}}]},"20":{"line":242,"type":"binary-expr","locations":[{"start":{"line":242,"column":10},"end":{"line":242,"column":14}},{"start":{"line":242,"column":18},"end":{"line":242,"column":42}}]},"21":{"line":245,"type":"binary-expr","locations":[{"start":{"line":245,"column":28},"end":{"line":245,"column":32}},{"start":{"line":245,"column":36},"end":{"line":245,"column":40}}]},"22":{"line":251,"type":"if","locations":[{"start":{"line":251,"column":6},"end":{"line":251,"column":6}},{"start":{"line":251,"column":6},"end":{"line":251,"column":6}}]},"23":{"line":251,"type":"binary-expr","locations":[{"start":{"line":251,"column":10},"end":{"line":251,"column":14}},{"start":{"line":251,"column":18},"end":{"line":251,"column":42}}]},"24":{"line":254,"type":"binary-expr","locations":[{"start":{"line":254,"column":29},"end":{"line":254,"column":33}},{"start":{"line":254,"column":37},"end":{"line":254,"column":41}}]},"25":{"line":255,"type":"binary-expr","locations":[{"start":{"line":255,"column":28},"end":{"line":255,"column":32}},{"start":{"line":255,"column":36},"end":{"line":255,"column":40}}]},"26":{"line":260,"type":"if","locations":[{"start":{"line":260,"column":6},"end":{"line":260,"column":6}},{"start":{"line":260,"column":6},"end":{"line":260,"column":6}}]},"27":{"line":260,"type":"binary-expr","locations":[{"start":{"line":260,"column":10},"end":{"line":260,"column":30}},{"start":{"line":260,"column":34},"end":{"line":260,"column":85}}]},"28":{"line":284,"type":"if","locations":[{"start":{"line":284,"column":6},"end":{"line":284,"column":6}},{"start":{"line":284,"column":6},"end":{"line":284,"column":6}}]},"29":{"line":360,"type":"if","locations":[{"start":{"line":360,"column":6},"end":{"line":360,"column":6}},{"start":{"line":360,"column":6},"end":{"line":360,"column":6}}]},"30":{"line":388,"type":"if","locations":[{"start":{"line":388,"column":8},"end":{"line":388,"column":8}},{"start":{"line":388,"column":8},"end":{"line":388,"column":8}}]},"31":{"line":389,"type":"if","locations":[{"start":{"line":389,"column":8},"end":{"line":389,"column":8}},{"start":{"line":389,"column":8},"end":{"line":389,"column":8}}]}},"code":["// Client Asset Manager","// --------------------","// The Client Asset Manager allows you to define multiple single-page 'clients' which can be served on","// different URLs or to different devices. Note: The Client Asset Manager deliberately makes extensive use","// of synchronous code. This is because all operations only ever run once on startup (when packing the assets)","// unless you are running in dev mode","'use strict';","","require('colors');","","var shortid = require('shortid'),","    path = require('path'),","    log = require('../utils/log'),","    systemAssets = require('./system');","","// Set defaults","var options = {};","","function setDefaultOptions(options) {","","  // Determine if assets should be (re)packed on startup","  var packEnv = process.env['SS_PACK'];","","  options.packedAssets = packEnv || false;","","  options.liveReload = ['code', 'css', 'static', 'templates', 'views'];","  options.startInBundle = false;","  options.defaultEntryInit = 'require(\"/entry\");';","  options.entryModuleName = undefined;","  options.urls = {","    assets: '/assets/'","  };","  // in 0.5 these will be relative paths","  options.dirs = {","    client: '/client',","    code: '/client/code',","    system: '/client/code/system', // will be an array after load","    css: '/client/css',","    static: '/client/static',","    assets: '/client/static/assets',","    templates: '/client/templates',","    views: '/client/views',","    workers: '/client/workers'","  };","}","","setDefaultOptions(options);","","// Store each client as an object","var clients = {};","","","/**"," * @ngdoc service"," * @name client"," * @function"," *"," * @description"," * Client serving, bundling, development, building."," * -----------"," * One or more clients are defined and will be served in production as a single HTML, CSS, and JS file."," *"," * This is for the module returned by `require('socketstream').client`."," */","module.exports = function(ss) {","  // make bundler methods available for default and other implementations","  ss.bundler = require('./bundler/index')(ss,options);","","  // extend http response API","  // Get hold of the 'response' object so we can extend it later","  var res = require('http').ServerResponse.prototype;","","  // Append the 'serveClient' method to the HTTP Response object","  res.serveClient = function(name) {","    ss.http.cached.send('assets/' + name + '/' + clients[name].id + '.html',this);","  };","","  // Alias res.serveClient to keep compatibility with existing apps","  res.serve = res.serveClient;","","  // reloading tracking","  var lastRun = { updateCSS: {at:Date.now()}, reload: {at:Date.now()} },","      cssExtensions = ['.css', '.styl', '.stylus', '.less'],","      consoleMessage = {","        updateCSS: 'CSS files changed. Updating browser...',","        reload: 'Client files changed. Reloading browser...'","      };","","  function reloadClients(changedPath,event) {","     var customOnChange = options.onChange || {},","         delayTime = customOnChange.delayTime || 100,","         guardTime = customOnChange.guardTime || 1000;","","     function onChangeFiltered(path, event,action) {","         ss.log.info('✎'.green, consoleMessage[action].grey);","         var pubs ='__ss:' + action;","         if (customOnChange.publish) {","             pubs = options.onChange.publish(path, event,action,pubs);","         }","         if (pubs) {","             ss.publish.all(pubs);","         }","","         lastRun[action].at = Date.now();","     }","","     // reload the browser","     function onChange(changedPath, event) {","       var _ref = path.extname(changedPath),","           action = cssExtensions.indexOf(_ref) >= 0 ? 'updateCSS' : 'reload';","       //first change is with delayTime delay , thereafter only once there has been no further changes for guardTime seconds","","       //validate the change","       if (customOnChange.validate) {","           if (!customOnChange.validate(changedPath, event,action)) { return ;} //ignore changes if the app says-so","       }","","       //avoid multiple rapid changes","       var delay=delayTime;","       if (lastRun[action].guardTime) { clearTimeout(lastRun[action].guardTime); delay=guardTime;}","       if (lastRun[action].delayTime) { clearTimeout(lastRun[action].delayTime); delay=delayTime;}","       lastRun[action].delayTime = setTimeout(function(){","           onChangeFiltered(changedPath, event, action);","           lastRun[action].guardTime = setTimeout(function(){","               lastRun[action].guardTime=null;","               }, delay);","            lastRun[action].delayTime=null;","           }, delay);","","       return Date.now();","     }","","     return onChange(changedPath, event);","  }","","  // Return API","  return {","    init: function() {","      this.templateEngine = this.templateEngine || require('./template_engine')(ss,options);","","      if (this.formatters == null) {","        this.formatters = require('./formatters')(ss,options);","","        // Load default code formatters","        this.formatters.add('javascript');","        this.formatters.add('css');","        this.formatters.add('html');","        this.formatters.add('map');","      }","","      systemAssets.load();","","      return this;","    },","    dirs: {","      get root() {","        return path.join(ss.root,options.dirs.client);","      },","      get code() {","        return path.join(ss.root,options.dirs.code);","      },","      get system() {","        return path.join(ss.root,options.dirs.system);","      },","      get workers() {","        return path.join(ss.root,options.dirs.workers);","      },","      get css() {","        return path.join(ss.root,options.dirs.css);","      },","      get static() {","        return path.join(ss.root,options.dirs.static);","      },","      get assets() {","        return path.join(ss.root,options.dirs.assets);","      },","      get views() {","        return path.join(ss.root,options.dirs.views);","      }","    },","","    /**","     * @ngdoc service","     * @name client.formatters:formatters","     *","     * @description","     * This is for the module returned by `require('socketstream').client.formatters`.","     */","    formatters: null,","    /**","     * @ngdoc service","     * @name client.templateEngine:templateEngine","     *","     * @description","     * This is for the module returned by `require('socketstream').client.templateEngine`.","     */","    templateEngine: null,","    assets: systemAssets,","    options: options,","","    get faviconPath() {","      return path.join(ss.root,options.dirs.static,'favicon.ico'); //TODO find the one present","    },","","    // Merge optional options","    set: function(newOption) {","      var k, v, y, _results;","      if (typeof newOption !== 'object') {","        throw new Error('ss.client.set() takes an object e.g. {liveReload: false}');","      }","      _results = [];","      for (k in newOption) {","        if (newOption.hasOwnProperty(k)) {","          v = newOption[k];","          if (v instanceof Object) {","            //jshint -W083","            _results.push((function() {","              var _results1, x;","              _results1 = [];","              for (x in v) {","                if (v.hasOwnProperty(x)) {","                  y = v[x];","","                  if (!options[k]) {","                    options[k]= {};","                  }","","                  _results1.push(options[k][x] = y);","                }","              }","              return _results1;","            })());","          } else {","            _results.push(options[k] = v);","          }","        }","      }","      return _results;","    },","","    servePacked: function(opts) {","      if (opts && typeof opts !== 'object') {","        throw new Error('Options passed to ss.client.servePacked() must be an object');","      }","      options.servePacked = opts || true;","      options.liveReload = false;","    },","","    // Tell the asset manager to pack and minimise all assets","    packAssets: function(opts) {","      if (opts && typeof opts !== 'object') {","        throw new Error('Options passed to ss.client.packAssets() must be an object');","      }","      options.packedAssets = opts || true;","      options.servePacked = opts || true;","      options.liveReload = false;","","      // As it's safe to assume we're running in production mode at this point, if your app is not catching uncaught","      // errors with its own custom error handling code, step in and prevent any exceptions from taking the server down","      if (options.packedAssets && process.listeners('uncaughtException').length === 0) {","        return process.on('uncaughtException', function(err) {","          log.error('Uncaught Exception!'.red);","          return log.error(err.stack);","        });","      }","    },","","    // Define a new Single Page Client","    /**","     * @ngdoc service","     * @name client.define","     * @function","     * @param {string} name Logical name of the client","     * @param {object} paths Paths of css, code, tmpl, view","     * @returns {{name: *} ClientDefinition} definition Client Definition","     * @description","     * Define a client view to serve.","     *","     *     ss.http.route('/my-view', function(req,res)","     *        res.serveClient('my-view');","     *     });","     */","    define: function(name) {","      if (clients[name]) {","        throw new Error('Client name \\'' + name + '\\' has already been defined');","      }","      // if a function is used construct a bundler with it otherwise use default bundler","      var client = clients[name] = {","        name: name,","        paths: {},","        uniqueId: shortid.generate(),","        includes: {","          css: true,","          html: true,","          system: true,","          initCode: true","        }","      };","      client.id = client.uniqueId;","","      ss.bundler.define(client,arguments);","","      return client;","    },","","    /**","     * Standard plugins or ones loaded by require. These plugins do not need to be loaded","     * in production.","     * - bundler","     * - formatter","     * - template engine","     */","    plugins: {},","","    /**","     * @ngdoc service","     * @name client.task","     * @function","     * @param {string} client Name of client","     * @param {string} name Name of task","     * @param {string} dependents Array of other client tasks to execute","     * @param {function} fn Task execution","     */","    task: function(client, name, dependents, fn) {","      // should dependents be translated for other client tasks? Perhaps identify global tasks by a prefix or by lookup","      dependents = dependents.map(function(task) {","        return client+':'+task;","      });","      ss.tasks.add(client+':'+name, dependents, fn);","    },","","    // experimental interface to reload cache of contents for all clients","    reloadCached: function() {","      ss.http.cached.loadStatic();","      ss.http.cached.loadAssets();","      ss.bundler.updateCachedOndemandAssets();","","      ss.bundler.forEach(function(bundler) {","        bundler.updateCachedDevAssets();","      });","    },","","    livereload: {","      added: function(changedPath) {","        return reloadClients(changedPath,'added');","      },","      changed: function(changedPath) {","        return reloadClients(changedPath,'changed');","      },","      removed: function(changedPath) {","        return reloadClients(changedPath,'removed');","      }","    },","","    // experimental interface to reload all clients","    reloadClients : reloadClients,","","    // Listen and serve incoming asset requests","    load: function() {","      if (options.servePacked) {","        ss.bundler.forEach(function(bundler) {","          bundler.useLatestsPackedId();","        });","      }","      ss.bundler.load();","      //TODO convert options.dirs to relative paths stripping the lead '/' if present","","      // Cache instances of code formatters and template engines here","      // This may change in the future as I don't like hanging system objects","      // on the 'ss' internal API object, but for now it solves a problem","      // we were having when repl.start() would erase vars cached inside a module","      ss.client.formatters = this.formatters.load();","      ss.client.templateEngines = this.templateEngine.load();","    },","","    unload: function() {","      ss.client.formatters = {};","      ss.client.templateEngines = {};","      ss.bundler.unload();","      systemAssets.unload();","    },","","    forget: function() {","        clients = {};","        setDefaultOptions(options);","        systemAssets.unload();","        ss.bundler.forget();","        if (this.templateEngine) { this.templateEngine.forget(); this.templateEngine = null; }","        if (this.formatters) { this.formatters.forget(); this.formatters = null; }","    }","  };","};",""],"l":{"9":1,"11":1,"17":1,"19":1,"22":1,"24":1,"26":1,"27":1,"28":1,"29":1,"30":1,"34":1,"47":1,"50":1,"65":1,"67":1,"71":1,"74":1,"75":0,"79":1,"82":1,"89":1,"90":0,"94":1,"95":0,"96":0,"97":0,"98":0,"100":0,"101":0,"104":0,"108":1,"109":0,"114":0,"115":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"127":0,"130":0,"133":0,"137":1,"139":1,"141":1,"142":1,"145":1,"146":1,"147":1,"148":1,"151":1,"153":1,"157":2,"160":2,"163":2,"166":2,"169":2,"172":2,"175":2,"178":2,"202":14,"207":0,"208":0,"209":0,"211":0,"212":0,"213":0,"214":0,"215":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"224":0,"225":0,"228":0,"231":0,"234":0,"238":0,"242":0,"243":0,"245":0,"246":0,"251":0,"252":0,"254":0,"255":0,"256":0,"260":0,"261":0,"262":0,"263":0,"284":0,"285":0,"288":0,"299":0,"301":0,"303":0,"326":0,"327":0,"329":0,"334":0,"335":0,"336":0,"338":0,"339":0,"345":0,"348":0,"351":0,"360":0,"361":0,"362":0,"365":0,"372":0,"373":0,"377":0,"378":0,"379":0,"380":0,"384":0,"385":0,"386":0,"387":0,"388":0,"389":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/system/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/system/index.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":2,"11":0,"12":2,"13":0,"14":0,"15":0,"16":0,"17":2,"18":0,"19":2,"20":2,"21":2,"22":1,"23":0,"24":0,"25":0,"26":0,"27":1,"28":1,"29":0,"30":1,"31":1,"32":2,"33":2,"34":2,"35":2,"36":2},"b":{"1":[0,0],"2":[0,2],"3":[2,2],"4":[0,0,0,0,0,0,0,2,2],"5":[0,2],"6":[0,1]},"f":{"1":0,"2":2,"3":0,"4":1,"5":2},"fnMap":{"1":{"name":"pushUniqueAsset","line":21,"loc":{"start":{"line":21,"column":0},"end":{"line":21,"column":41}}},"2":{"name":"(anonymous_2)","line":43,"loc":{"start":{"line":43,"column":26},"end":{"line":43,"column":66}}},"3":{"name":"(anonymous_3)","line":88,"loc":{"start":{"line":88,"column":17},"end":{"line":88,"column":28}}},"4":{"name":"(anonymous_4)","line":96,"loc":{"start":{"line":96,"column":15},"end":{"line":96,"column":26}}},"5":{"name":"(anonymous_5)","line":102,"loc":{"start":{"line":102,"column":44},"end":{"line":102,"column":63}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":10,"column":42}},"2":{"start":{"line":13,"column":0},"end":{"line":19,"column":2}},"3":{"start":{"line":21,"column":0},"end":{"line":29,"column":1}},"4":{"start":{"line":22,"column":2},"end":{"line":22,"column":32}},"5":{"start":{"line":23,"column":2},"end":{"line":27,"column":3}},"6":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"7":{"start":{"line":25,"column":6},"end":{"line":25,"column":23}},"8":{"start":{"line":28,"column":2},"end":{"line":28,"column":26}},"9":{"start":{"line":43,"column":0},"end":{"line":86,"column":2}},"10":{"start":{"line":44,"column":2},"end":{"line":46,"column":3}},"11":{"start":{"line":45,"column":4},"end":{"line":45,"column":17}},"12":{"start":{"line":48,"column":2},"end":{"line":85,"column":3}},"13":{"start":{"line":52,"column":6},"end":{"line":52,"column":95}},"14":{"start":{"line":55,"column":6},"end":{"line":55,"column":90}},"15":{"start":{"line":58,"column":6},"end":{"line":58,"column":84}},"16":{"start":{"line":61,"column":6},"end":{"line":68,"column":9}},"17":{"start":{"line":71,"column":6},"end":{"line":84,"column":7}},"18":{"start":{"line":72,"column":8},"end":{"line":72,"column":78}},"19":{"start":{"line":74,"column":8},"end":{"line":74,"column":40}},"20":{"start":{"line":75,"column":8},"end":{"line":82,"column":10}},"21":{"start":{"line":83,"column":8},"end":{"line":83,"column":36}},"22":{"start":{"line":88,"column":0},"end":{"line":93,"column":2}},"23":{"start":{"line":89,"column":2},"end":{"line":89,"column":19}},"24":{"start":{"line":90,"column":2},"end":{"line":90,"column":22}},"25":{"start":{"line":91,"column":2},"end":{"line":91,"column":24}},"26":{"start":{"line":92,"column":2},"end":{"line":92,"column":24}},"27":{"start":{"line":96,"column":0},"end":{"line":111,"column":2}},"28":{"start":{"line":97,"column":2},"end":{"line":97,"column":48}},"29":{"start":{"line":97,"column":40},"end":{"line":97,"column":47}},"30":{"start":{"line":101,"column":2},"end":{"line":101,"column":51}},"31":{"start":{"line":102,"column":2},"end":{"line":110,"column":5}},"32":{"start":{"line":103,"column":4},"end":{"line":103,"column":49}},"33":{"start":{"line":104,"column":4},"end":{"line":104,"column":33}},"34":{"start":{"line":105,"column":4},"end":{"line":105,"column":38}},"35":{"start":{"line":106,"column":4},"end":{"line":106,"column":93}},"36":{"start":{"line":107,"column":4},"end":{"line":109,"column":7}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":4}},{"start":{"line":24,"column":4},"end":{"line":24,"column":4}}]},"2":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":2},"end":{"line":44,"column":2}},{"start":{"line":44,"column":2},"end":{"line":44,"column":2}}]},"3":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":6},"end":{"line":44,"column":22}},{"start":{"line":44,"column":26},"end":{"line":44,"column":47}}]},"4":{"line":48,"type":"switch","locations":[{"start":{"line":49,"column":4},"end":{"line":49,"column":17}},{"start":{"line":50,"column":4},"end":{"line":52,"column":95}},{"start":{"line":53,"column":4},"end":{"line":55,"column":90}},{"start":{"line":56,"column":4},"end":{"line":56,"column":17}},{"start":{"line":57,"column":4},"end":{"line":58,"column":84}},{"start":{"line":59,"column":4},"end":{"line":59,"column":15}},{"start":{"line":60,"column":4},"end":{"line":68,"column":9}},{"start":{"line":69,"column":4},"end":{"line":69,"column":15}},{"start":{"line":70,"column":4},"end":{"line":84,"column":7}}]},"5":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":6},"end":{"line":71,"column":6}},{"start":{"line":71,"column":6},"end":{"line":71,"column":6}}]},"6":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":2},"end":{"line":97,"column":2}},{"start":{"line":97,"column":2},"end":{"line":97,"column":2}}]}},"code":["'use strict';","","// System Assets","// -------------","// Loads system libraries and modules for the client. Also exposes an internal API","// which other modules can use to send system assets to the client","","var fs = require('fs'),","    pathlib = require('path'),","    fsUtils = require('../../utils/file');","","// Allow internal modules to deliver assets to the browser","var assets = exports.assets = {","  libs: [],","  modules: {},","  constants: {},","  locals: {},","  startCode: []","};","","function pushUniqueAsset(listName,asset) {","  var list = assets[listName],i;","  for(i=list.length-1; i>=0; --i) {","    if (list[i].name === asset.name) {","      list.splice(i,1);","    }","  }","  return list.push(asset);","}","","/**"," * @ngdoc function"," * @name ss.client:client#send"," * @methodOf ss.client:client"," * @param {'code','lib','module'} type - `code`, `lib`, `module`."," * @param {string} name - Module name for require."," * @param {string} content - The JS code"," * @param {Object} options - Allows you to specify `compress` and `coffee` format flags."," * @description"," * Allow other libs to send assets to the client. add new System Library or Module"," */","","var send = exports.send = function (type, name, content, options) {","  if (options === null || options === undefined) {","    options = {};","  }","","  switch (type) {","    case 'const':","    case 'constant':","      //jshint -W093","      return (assets.constants[name] = {value:content,name:name,type:'const',options:options});","    case 'local':","      //jshint -W093","      return (assets.locals[name] = { value:content,name:name,type:type,options:options});","    case 'start':","    case 'code':","      return assets.startCode.push({content:content,options:options, type:'start'});","    case 'lib':","    case 'library':","      return pushUniqueAsset('libs',{","        name: name,","        type: 'lib',","        dir: pathlib.join(__dirname,'libs'),","        path: pathlib.join(__dirname,'libs',name + '.js'),","        content: content,","        options: options","      });","    case 'mod':","    case 'module':","      if (assets.modules[name]) {","        throw new Error('System module name \\'' + name + '\\' already exists');","      } else {","        name = name.replace(/\\.js$/,'');","        assets.modules[name] = {","          name: name,","          type: 'mod',","          dir: pathlib.join(__dirname,'modules'),","          path: pathlib.join(__dirname,'modules',name + '.js'),","          content: content,","          options: options","        };","        return assets.modules[name];","      }","  }","};","","exports.unload = function() {","  assets.libs = [];","  assets.modules = {};","  assets.constants = {};","  assets.startCode = [];","};","","// Load all system libs and modules","exports.load = function() {","  if (assets.modules['eventemitter2']) {return;}","  ","  // System Modules. Including main SocketStream client code","  // Load order is not important","  var modDir = pathlib.join(__dirname, '/modules');","  fsUtils.readDirSync(modDir).files.forEach(function(fileName) {","    var code = fs.readFileSync(fileName, 'utf8');","    var sp = fileName.split('.');","    var extension = sp[sp.length - 1];","    var modName = fileName.substr(modDir.length + 1).replace('.js','').replace('.min.js','');","    return send('mod', modName, code, {","      coffee: extension === 'coffee'","    });","  });","};",""],"l":{"8":1,"13":1,"21":1,"22":0,"23":0,"24":0,"25":0,"28":0,"43":1,"44":2,"45":0,"48":2,"52":0,"55":0,"58":0,"61":0,"71":2,"72":0,"74":2,"75":2,"83":2,"88":1,"89":0,"90":0,"91":0,"92":0,"96":1,"97":1,"101":1,"102":1,"103":2,"104":2,"105":2,"106":2,"107":2}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/index.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":1,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":1,"46":0,"47":1,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":1,"105":0,"106":0,"107":1,"108":0,"109":0,"110":0,"111":0,"112":0,"113":1,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":1,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":1,"174":0,"175":0,"176":0,"177":0,"178":0,"179":1,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":1,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":1,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":1,"243":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0,0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0,0],"61":[0,0]},"f":{"1":0,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0},"fnMap":{"1":{"name":"getBundler","line":35,"loc":{"start":{"line":35,"column":0},"end":{"line":35,"column":27}}},"2":{"name":"(anonymous_2)","line":73,"loc":{"start":{"line":73,"column":17},"end":{"line":73,"column":38}}},"3":{"name":"systemModule","line":78,"loc":{"start":{"line":78,"column":2},"end":{"line":78,"column":35}}},"4":{"name":"create","line":98,"loc":{"start":{"line":98,"column":12},"end":{"line":98,"column":37}}},"5":{"name":"defineBundler","line":117,"loc":{"start":{"line":117,"column":12},"end":{"line":117,"column":48}}},"6":{"name":"(anonymous_6)","line":146,"loc":{"start":{"line":146,"column":13},"end":{"line":146,"column":31}}},"7":{"name":"(anonymous_7)","line":153,"loc":{"start":{"line":153,"column":20},"end":{"line":153,"column":37}}},"8":{"name":"onlyModuleEntry","line":158,"loc":{"start":{"line":158,"column":6},"end":{"line":158,"column":34}}},"9":{"name":"onlyModuleIndex","line":161,"loc":{"start":{"line":161,"column":6},"end":{"line":161,"column":34}}},"10":{"name":"diskToRequire","line":164,"loc":{"start":{"line":164,"column":6},"end":{"line":164,"column":34}}},"11":{"name":"(anonymous_11)","line":192,"loc":{"start":{"line":192,"column":10},"end":{"line":192,"column":21}}},"12":{"name":"(anonymous_12)","line":194,"loc":{"start":{"line":194,"column":19},"end":{"line":194,"column":37}}},"13":{"name":"(anonymous_13)","line":204,"loc":{"start":{"line":204,"column":12},"end":{"line":204,"column":23}}},"14":{"name":"(anonymous_14)","line":213,"loc":{"start":{"line":213,"column":12},"end":{"line":213,"column":23}}},"15":{"name":"loadFile","line":220,"loc":{"start":{"line":220,"column":14},"end":{"line":220,"column":67}}},"16":{"name":"minifyCSS","line":240,"loc":{"start":{"line":240,"column":15},"end":{"line":240,"column":41}}},"17":{"name":"(anonymous_17)","line":242,"loc":{"start":{"line":242,"column":31},"end":{"line":242,"column":46}}},"18":{"name":"minifyJS_","line":250,"loc":{"start":{"line":250,"column":14},"end":{"line":250,"column":40}}},"19":{"name":"(anonymous_19)","line":252,"loc":{"start":{"line":252,"column":26},"end":{"line":252,"column":39}}},"20":{"name":"minifyJSFile","line":258,"loc":{"start":{"line":258,"column":18},"end":{"line":258,"column":64}}},"21":{"name":"(anonymous_21)","line":274,"loc":{"start":{"line":274,"column":17},"end":{"line":274,"column":33}}},"22":{"name":"relativePath","line":276,"loc":{"start":{"line":276,"column":6},"end":{"line":276,"column":40}}},"23":{"name":"prefixPath","line":281,"loc":{"start":{"line":281,"column":6},"end":{"line":281,"column":34}}},"24":{"name":"entries","line":290,"loc":{"start":{"line":290,"column":6},"end":{"line":290,"column":38}}},"25":{"name":"(anonymous_25)","line":296,"loc":{"start":{"line":296,"column":24},"end":{"line":296,"column":40}}},"26":{"name":"(anonymous_26)","line":327,"loc":{"start":{"line":327,"column":14},"end":{"line":327,"column":31}}},"27":{"name":"(anonymous_27)","line":359,"loc":{"start":{"line":359,"column":14},"end":{"line":359,"column":42}}},"28":{"name":"(anonymous_28)","line":386,"loc":{"start":{"line":386,"column":22},"end":{"line":386,"column":33}}},"29":{"name":"(anonymous_29)","line":409,"loc":{"start":{"line":409,"column":16},"end":{"line":409,"column":27}}},"30":{"name":"(anonymous_30)","line":416,"loc":{"start":{"line":416,"column":40},"end":{"line":416,"column":54}}},"31":{"name":"(anonymous_31)","line":434,"loc":{"start":{"line":434,"column":19},"end":{"line":434,"column":34}}},"32":{"name":"(anonymous_32)","line":435,"loc":{"start":{"line":435,"column":52},"end":{"line":435,"column":67}}},"33":{"name":"(anonymous_33)","line":440,"loc":{"start":{"line":440,"column":15},"end":{"line":440,"column":32}}},"34":{"name":"describeConstant","line":455,"loc":{"start":{"line":455,"column":6},"end":{"line":455,"column":43}}},"35":{"name":"(anonymous_35)","line":478,"loc":{"start":{"line":478,"column":15},"end":{"line":478,"column":32}}},"36":{"name":"(anonymous_36)","line":479,"loc":{"start":{"line":479,"column":50},"end":{"line":479,"column":63}}},"37":{"name":"packAssetSet","line":491,"loc":{"start":{"line":491,"column":18},"end":{"line":491,"column":78}}},"38":{"name":"iterator","line":497,"loc":{"start":{"line":497,"column":6},"end":{"line":497,"column":41}}},"39":{"name":"(anonymous_39)","line":508,"loc":{"start":{"line":508,"column":40},"end":{"line":508,"column":57}}},"40":{"name":"andThen","line":515,"loc":{"start":{"line":515,"column":6},"end":{"line":515,"column":37}}},"41":{"name":"(anonymous_41)","line":517,"loc":{"start":{"line":517,"column":62},"end":{"line":517,"column":74}}},"42":{"name":"UpdateCachedOndemandAssets","line":525,"loc":{"start":{"line":525,"column":32},"end":{"line":525,"column":70}}},"43":{"name":"(anonymous_43)","line":528,"loc":{"start":{"line":528,"column":20},"end":{"line":528,"column":34}}},"44":{"name":"(anonymous_44)","line":533,"loc":{"start":{"line":533,"column":20},"end":{"line":533,"column":34}}},"45":{"name":"entries","line":545,"loc":{"start":{"line":545,"column":13},"end":{"line":545,"column":49}}},"46":{"name":"pushMainEntries","line":582,"loc":{"start":{"line":582,"column":6},"end":{"line":582,"column":37}}},"47":{"name":"(anonymous_47)","line":589,"loc":{"start":{"line":589,"column":51},"end":{"line":589,"column":66}}},"48":{"name":"isAssetType","line":600,"loc":{"start":{"line":600,"column":6},"end":{"line":600,"column":34}}},"49":{"name":"(anonymous_49)","line":615,"loc":{"start":{"line":615,"column":29},"end":{"line":615,"column":45}}},"50":{"name":"(anonymous_50)","line":620,"loc":{"start":{"line":620,"column":24},"end":{"line":620,"column":46}}},"51":{"name":"(anonymous_51)","line":629,"loc":{"start":{"line":629,"column":20},"end":{"line":629,"column":34}}},"52":{"name":"(anonymous_52)","line":639,"loc":{"start":{"line":639,"column":16},"end":{"line":639,"column":40}}},"53":{"name":"formatKb","line":648,"loc":{"start":{"line":648,"column":0},"end":{"line":648,"column":24}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":12,"column":36}},"2":{"start":{"line":32,"column":0},"end":{"line":33,"column":21}},"3":{"start":{"line":35,"column":0},"end":{"line":53,"column":1}},"4":{"start":{"line":36,"column":2},"end":{"line":36,"column":62}},"5":{"start":{"line":36,"column":36},"end":{"line":36,"column":60}},"6":{"start":{"line":38,"column":2},"end":{"line":38,"column":48}},"7":{"start":{"line":38,"column":24},"end":{"line":38,"column":46}},"8":{"start":{"line":40,"column":2},"end":{"line":44,"column":3}},"9":{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},"10":{"start":{"line":42,"column":6},"end":{"line":42,"column":36}},"11":{"start":{"line":45,"column":2},"end":{"line":47,"column":3}},"12":{"start":{"line":46,"column":4},"end":{"line":46,"column":35}},"13":{"start":{"line":48,"column":2},"end":{"line":50,"column":3}},"14":{"start":{"line":49,"column":4},"end":{"line":49,"column":33}},"15":{"start":{"line":52,"column":2},"end":{"line":52,"column":82}},"16":{"start":{"line":73,"column":0},"end":{"line":646,"column":2}},"17":{"start":{"line":75,"column":2},"end":{"line":76,"column":57}},"18":{"start":{"line":78,"column":2},"end":{"line":94,"column":3}},"19":{"start":{"line":79,"column":4},"end":{"line":79,"column":36}},"20":{"start":{"line":80,"column":4},"end":{"line":80,"column":42}},"21":{"start":{"line":81,"column":4},"end":{"line":93,"column":5}},"22":{"start":{"line":82,"column":6},"end":{"line":82,"column":85}},"23":{"start":{"line":83,"column":6},"end":{"line":92,"column":8}},"24":{"start":{"line":96,"column":2},"end":{"line":645,"column":4}},"25":{"start":{"line":99,"column":6},"end":{"line":99,"column":41}},"26":{"start":{"line":100,"column":6},"end":{"line":104,"column":7}},"27":{"start":{"line":101,"column":8},"end":{"line":103,"column":9}},"28":{"start":{"line":102,"column":10},"end":{"line":102,"column":38}},"29":{"start":{"line":105,"column":6},"end":{"line":105,"column":21}},"30":{"start":{"line":119,"column":6},"end":{"line":121,"column":18}},"31":{"start":{"line":123,"column":6},"end":{"line":131,"column":7}},"32":{"start":{"line":124,"column":8},"end":{"line":124,"column":134}},"33":{"start":{"line":125,"column":8},"end":{"line":125,"column":32}},"34":{"start":{"line":126,"column":8},"end":{"line":126,"column":59}},"35":{"start":{"line":128,"column":8},"end":{"line":128,"column":75}},"36":{"start":{"line":129,"column":8},"end":{"line":129,"column":32}},"37":{"start":{"line":130,"column":8},"end":{"line":130,"column":40}},"38":{"start":{"line":132,"column":6},"end":{"line":132,"column":35}},"39":{"start":{"line":147,"column":6},"end":{"line":150,"column":7}},"40":{"start":{"line":148,"column":10},"end":{"line":148,"column":38}},"41":{"start":{"line":149,"column":10},"end":{"line":149,"column":36}},"42":{"start":{"line":155,"column":6},"end":{"line":156,"column":20}},"43":{"start":{"line":158,"column":6},"end":{"line":160,"column":7}},"44":{"start":{"line":159,"column":8},"end":{"line":159,"column":45}},"45":{"start":{"line":161,"column":6},"end":{"line":163,"column":7}},"46":{"start":{"line":162,"column":8},"end":{"line":162,"column":45}},"47":{"start":{"line":164,"column":6},"end":{"line":166,"column":7}},"48":{"start":{"line":165,"column":8},"end":{"line":165,"column":44}},"49":{"start":{"line":168,"column":6},"end":{"line":187,"column":7}},"50":{"start":{"line":169,"column":8},"end":{"line":169,"column":40}},"51":{"start":{"line":171,"column":8},"end":{"line":186,"column":9}},"52":{"start":{"line":173,"column":10},"end":{"line":173,"column":40}},"53":{"start":{"line":174,"column":10},"end":{"line":174,"column":52}},"54":{"start":{"line":175,"column":10},"end":{"line":177,"column":11}},"55":{"start":{"line":176,"column":12},"end":{"line":176,"column":49}},"56":{"start":{"line":178,"column":10},"end":{"line":178,"column":52}},"57":{"start":{"line":179,"column":10},"end":{"line":181,"column":11}},"58":{"start":{"line":180,"column":12},"end":{"line":180,"column":50}},"59":{"start":{"line":184,"column":10},"end":{"line":184,"column":41}},"60":{"start":{"line":185,"column":10},"end":{"line":185,"column":96}},"61":{"start":{"line":189,"column":6},"end":{"line":189,"column":37}},"62":{"start":{"line":193,"column":6},"end":{"line":193,"column":18}},"63":{"start":{"line":194,"column":6},"end":{"line":200,"column":9}},"64":{"start":{"line":195,"column":8},"end":{"line":195,"column":49}},"65":{"start":{"line":196,"column":8},"end":{"line":196,"column":36}},"66":{"start":{"line":197,"column":8},"end":{"line":199,"column":9}},"67":{"start":{"line":198,"column":12},"end":{"line":198,"column":27}},"68":{"start":{"line":201,"column":6},"end":{"line":201,"column":48}},"69":{"start":{"line":205,"column":6},"end":{"line":210,"column":7}},"70":{"start":{"line":206,"column":8},"end":{"line":209,"column":9}},"71":{"start":{"line":207,"column":10},"end":{"line":207,"column":31}},"72":{"start":{"line":208,"column":10},"end":{"line":208,"column":36}},"73":{"start":{"line":214,"column":6},"end":{"line":214,"column":23}},"74":{"start":{"line":215,"column":6},"end":{"line":215,"column":20}},"75":{"start":{"line":221,"column":6},"end":{"line":221,"column":49}},"76":{"start":{"line":222,"column":6},"end":{"line":222,"column":71}},"77":{"start":{"line":223,"column":6},"end":{"line":226,"column":7}},"78":{"start":{"line":224,"column":8},"end":{"line":225,"column":137}},"79":{"start":{"line":227,"column":6},"end":{"line":230,"column":7}},"80":{"start":{"line":228,"column":8},"end":{"line":229,"column":123}},"81":{"start":{"line":233,"column":6},"end":{"line":237,"column":7}},"82":{"start":{"line":234,"column":8},"end":{"line":234,"column":80}},"83":{"start":{"line":236,"column":8},"end":{"line":236,"column":26}},"84":{"start":{"line":241,"column":6},"end":{"line":241,"column":25}},"85":{"start":{"line":242,"column":6},"end":{"line":245,"column":20}},"86":{"start":{"line":243,"column":8},"end":{"line":243,"column":43}},"87":{"start":{"line":244,"column":8},"end":{"line":244,"column":59}},"88":{"start":{"line":246,"column":6},"end":{"line":246,"column":110}},"89":{"start":{"line":247,"column":6},"end":{"line":247,"column":22}},"90":{"start":{"line":251,"column":6},"end":{"line":251,"column":22}},"91":{"start":{"line":252,"column":6},"end":{"line":254,"column":9}},"92":{"start":{"line":253,"column":8},"end":{"line":253,"column":80}},"93":{"start":{"line":255,"column":6},"end":{"line":255,"column":28}},"94":{"start":{"line":259,"column":6},"end":{"line":259,"column":68}},"95":{"start":{"line":260,"column":6},"end":{"line":260,"column":29}},"96":{"start":{"line":261,"column":6},"end":{"line":261,"column":38}},"97":{"start":{"line":263,"column":6},"end":{"line":263,"column":29}},"98":{"start":{"line":264,"column":6},"end":{"line":264,"column":35}},"99":{"start":{"line":265,"column":6},"end":{"line":265,"column":25}},"100":{"start":{"line":266,"column":6},"end":{"line":266,"column":47}},"101":{"start":{"line":267,"column":6},"end":{"line":269,"column":7}},"102":{"start":{"line":268,"column":8},"end":{"line":268,"column":138}},"103":{"start":{"line":270,"column":6},"end":{"line":270,"column":26}},"104":{"start":{"line":276,"column":6},"end":{"line":279,"column":7}},"105":{"start":{"line":277,"column":10},"end":{"line":277,"column":78}},"106":{"start":{"line":278,"column":10},"end":{"line":278,"column":105}},"107":{"start":{"line":281,"column":6},"end":{"line":288,"column":7}},"108":{"start":{"line":282,"column":10},"end":{"line":282,"column":40}},"109":{"start":{"line":283,"column":10},"end":{"line":285,"column":11}},"110":{"start":{"line":284,"column":12},"end":{"line":284,"column":24}},"111":{"start":{"line":286,"column":10},"end":{"line":286,"column":36}},"112":{"start":{"line":287,"column":10},"end":{"line":287,"column":35}},"113":{"start":{"line":290,"column":6},"end":{"line":299,"column":7}},"114":{"start":{"line":291,"column":8},"end":{"line":293,"column":9}},"115":{"start":{"line":292,"column":10},"end":{"line":292,"column":20}},"116":{"start":{"line":294,"column":8},"end":{"line":294,"column":58}},"117":{"start":{"line":296,"column":8},"end":{"line":298,"column":11}},"118":{"start":{"line":297,"column":10},"end":{"line":297,"column":46}},"119":{"start":{"line":301,"column":6},"end":{"line":301,"column":44}},"120":{"start":{"line":302,"column":6},"end":{"line":302,"column":47}},"121":{"start":{"line":303,"column":6},"end":{"line":303,"column":71}},"122":{"start":{"line":305,"column":6},"end":{"line":307,"column":7}},"123":{"start":{"line":306,"column":8},"end":{"line":306,"column":55}},"124":{"start":{"line":309,"column":6},"end":{"line":309,"column":19}},"125":{"start":{"line":328,"column":6},"end":{"line":328,"column":65}},"126":{"start":{"line":329,"column":6},"end":{"line":329,"column":59}},"127":{"start":{"line":330,"column":6},"end":{"line":330,"column":42}},"128":{"start":{"line":332,"column":6},"end":{"line":352,"column":8}},"129":{"start":{"line":360,"column":6},"end":{"line":363,"column":8}},"130":{"start":{"line":364,"column":6},"end":{"line":369,"column":7}},"131":{"start":{"line":365,"column":8},"end":{"line":367,"column":9}},"132":{"start":{"line":366,"column":10},"end":{"line":366,"column":30}},"133":{"start":{"line":368,"column":8},"end":{"line":368,"column":35}},"134":{"start":{"line":371,"column":6},"end":{"line":378,"column":7}},"135":{"start":{"line":373,"column":10},"end":{"line":373,"column":36}},"136":{"start":{"line":374,"column":10},"end":{"line":374,"column":16}},"137":{"start":{"line":376,"column":10},"end":{"line":376,"column":34}},"138":{"start":{"line":377,"column":10},"end":{"line":377,"column":16}},"139":{"start":{"line":380,"column":6},"end":{"line":380,"column":48}},"140":{"start":{"line":381,"column":6},"end":{"line":381,"column":91}},"141":{"start":{"line":383,"column":6},"end":{"line":383,"column":20}},"142":{"start":{"line":387,"column":6},"end":{"line":389,"column":7}},"143":{"start":{"line":388,"column":8},"end":{"line":388,"column":101}},"144":{"start":{"line":390,"column":6},"end":{"line":396,"column":8}},"145":{"start":{"line":410,"column":6},"end":{"line":410,"column":21}},"146":{"start":{"line":411,"column":6},"end":{"line":417,"column":8}},"147":{"start":{"line":416,"column":56},"end":{"line":416,"column":77}},"148":{"start":{"line":416,"column":78},"end":{"line":416,"column":97}},"149":{"start":{"line":435,"column":6},"end":{"line":437,"column":9}},"150":{"start":{"line":436,"column":8},"end":{"line":436,"column":39}},"151":{"start":{"line":441,"column":6},"end":{"line":441,"column":28}},"152":{"start":{"line":444,"column":6},"end":{"line":446,"column":7}},"153":{"start":{"line":445,"column":8},"end":{"line":445,"column":50}},"154":{"start":{"line":449,"column":6},"end":{"line":453,"column":7}},"155":{"start":{"line":450,"column":8},"end":{"line":452,"column":9}},"156":{"start":{"line":451,"column":10},"end":{"line":451,"column":66}},"157":{"start":{"line":455,"column":6},"end":{"line":459,"column":7}},"158":{"start":{"line":456,"column":8},"end":{"line":456,"column":62}},"159":{"start":{"line":458,"column":8},"end":{"line":458,"column":20}},"160":{"start":{"line":462,"column":6},"end":{"line":462,"column":20}},"161":{"start":{"line":463,"column":6},"end":{"line":466,"column":7}},"162":{"start":{"line":464,"column":8},"end":{"line":464,"column":101}},"163":{"start":{"line":465,"column":8},"end":{"line":465,"column":32}},"164":{"start":{"line":467,"column":6},"end":{"line":467,"column":18}},"165":{"start":{"line":479,"column":6},"end":{"line":480,"column":112}},"166":{"start":{"line":479,"column":65},"end":{"line":479,"column":83}},"167":{"start":{"line":482,"column":6},"end":{"line":484,"column":7}},"168":{"start":{"line":483,"column":8},"end":{"line":483,"column":93}},"169":{"start":{"line":486,"column":6},"end":{"line":486,"column":32}},"170":{"start":{"line":488,"column":6},"end":{"line":488,"column":101}},"171":{"start":{"line":492,"column":6},"end":{"line":492,"column":39}},"172":{"start":{"line":495,"column":6},"end":{"line":495,"column":83}},"173":{"start":{"line":497,"column":6},"end":{"line":513,"column":7}},"174":{"start":{"line":498,"column":8},"end":{"line":503,"column":10}},"175":{"start":{"line":504,"column":8},"end":{"line":512,"column":9}},"176":{"start":{"line":505,"column":10},"end":{"line":505,"column":61}},"177":{"start":{"line":508,"column":10},"end":{"line":511,"column":13}},"178":{"start":{"line":510,"column":12},"end":{"line":510,"column":56}},"179":{"start":{"line":515,"column":6},"end":{"line":520,"column":7}},"180":{"start":{"line":516,"column":8},"end":{"line":516,"column":54}},"181":{"start":{"line":517,"column":8},"end":{"line":517,"column":120}},"182":{"start":{"line":517,"column":76},"end":{"line":517,"column":114}},"183":{"start":{"line":518,"column":8},"end":{"line":518,"column":103}},"184":{"start":{"line":519,"column":8},"end":{"line":519,"column":15}},"185":{"start":{"line":527,"column":6},"end":{"line":527,"column":84}},"186":{"start":{"line":528,"column":6},"end":{"line":530,"column":14}},"187":{"start":{"line":529,"column":8},"end":{"line":529,"column":125}},"188":{"start":{"line":532,"column":6},"end":{"line":532,"column":83}},"189":{"start":{"line":533,"column":6},"end":{"line":535,"column":14}},"190":{"start":{"line":534,"column":8},"end":{"line":534,"column":127}},"191":{"start":{"line":547,"column":6},"end":{"line":550,"column":17}},"192":{"start":{"line":552,"column":6},"end":{"line":580,"column":7}},"193":{"start":{"line":554,"column":10},"end":{"line":554,"column":30}},"194":{"start":{"line":555,"column":10},"end":{"line":555,"column":25}},"195":{"start":{"line":556,"column":10},"end":{"line":556,"column":55}},"196":{"start":{"line":557,"column":10},"end":{"line":557,"column":16}},"197":{"start":{"line":561,"column":10},"end":{"line":561,"column":48}},"198":{"start":{"line":562,"column":10},"end":{"line":562,"column":44}},"199":{"start":{"line":563,"column":10},"end":{"line":563,"column":87}},"200":{"start":{"line":565,"column":10},"end":{"line":565,"column":71}},"201":{"start":{"line":566,"column":10},"end":{"line":566,"column":30}},"202":{"start":{"line":567,"column":10},"end":{"line":567,"column":24}},"203":{"start":{"line":569,"column":10},"end":{"line":569,"column":53}},"204":{"start":{"line":570,"column":10},"end":{"line":572,"column":11}},"205":{"start":{"line":571,"column":12},"end":{"line":571,"column":64}},"206":{"start":{"line":573,"column":10},"end":{"line":573,"column":16}},"207":{"start":{"line":576,"column":10},"end":{"line":576,"column":31}},"208":{"start":{"line":577,"column":10},"end":{"line":577,"column":26}},"209":{"start":{"line":578,"column":10},"end":{"line":578,"column":53}},"210":{"start":{"line":579,"column":10},"end":{"line":579,"column":16}},"211":{"start":{"line":582,"column":6},"end":{"line":598,"column":7}},"212":{"start":{"line":583,"column":8},"end":{"line":583,"column":40}},"213":{"start":{"line":584,"column":8},"end":{"line":588,"column":9}},"214":{"start":{"line":585,"column":10},"end":{"line":585,"column":19}},"215":{"start":{"line":587,"column":10},"end":{"line":587,"column":39}},"216":{"start":{"line":589,"column":8},"end":{"line":597,"column":11}},"217":{"start":{"line":590,"column":10},"end":{"line":590,"column":45}},"218":{"start":{"line":591,"column":10},"end":{"line":591,"column":58}},"219":{"start":{"line":592,"column":10},"end":{"line":592,"column":57}},"220":{"start":{"line":593,"column":10},"end":{"line":593,"column":122}},"221":{"start":{"line":594,"column":10},"end":{"line":596,"column":11}},"222":{"start":{"line":595,"column":12},"end":{"line":595,"column":33}},"223":{"start":{"line":600,"column":6},"end":{"line":612,"column":7}},"224":{"start":{"line":601,"column":8},"end":{"line":603,"column":9}},"225":{"start":{"line":602,"column":10},"end":{"line":602,"column":23}},"226":{"start":{"line":604,"column":8},"end":{"line":604,"column":56}},"227":{"start":{"line":605,"column":8},"end":{"line":607,"column":9}},"228":{"start":{"line":606,"column":10},"end":{"line":606,"column":23}},"229":{"start":{"line":608,"column":8},"end":{"line":610,"column":9}},"230":{"start":{"line":609,"column":10},"end":{"line":609,"column":101}},"231":{"start":{"line":611,"column":8},"end":{"line":611,"column":55}},"232":{"start":{"line":615,"column":6},"end":{"line":617,"column":9}},"233":{"start":{"line":616,"column":8},"end":{"line":616,"column":23}},"234":{"start":{"line":622,"column":6},"end":{"line":625,"column":7}},"235":{"start":{"line":623,"column":8},"end":{"line":623,"column":66}},"236":{"start":{"line":624,"column":8},"end":{"line":624,"column":66}},"237":{"start":{"line":626,"column":6},"end":{"line":626,"column":20}},"238":{"start":{"line":630,"column":6},"end":{"line":633,"column":7}},"239":{"start":{"line":632,"column":8},"end":{"line":632,"column":23}},"240":{"start":{"line":634,"column":6},"end":{"line":634,"column":36}},"241":{"start":{"line":640,"column":6},"end":{"line":641,"column":9}},"242":{"start":{"line":648,"column":0},"end":{"line":650,"column":1}},"243":{"start":{"line":649,"column":2},"end":{"line":649,"column":64}}},"branchMap":{"1":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":2}},{"start":{"line":36,"column":2},"end":{"line":36,"column":2}}]},"2":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":2},"end":{"line":38,"column":2}},{"start":{"line":38,"column":2},"end":{"line":38,"column":2}}]},"3":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":40,"column":2}},{"start":{"line":40,"column":2},"end":{"line":40,"column":2}}]},"4":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":41,"column":4}},{"start":{"line":41,"column":4},"end":{"line":41,"column":4}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":2},"end":{"line":45,"column":2}},{"start":{"line":45,"column":2},"end":{"line":45,"column":2}}]},"6":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":2},"end":{"line":48,"column":2}},{"start":{"line":48,"column":2},"end":{"line":48,"column":2}}]},"7":{"line":52,"type":"binary-expr","locations":[{"start":{"line":52,"column":37},"end":{"line":52,"column":48}},{"start":{"line":52,"column":52},"end":{"line":52,"column":65}},{"start":{"line":52,"column":69},"end":{"line":52,"column":78}}]},"8":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":4},"end":{"line":81,"column":4}},{"start":{"line":81,"column":4},"end":{"line":81,"column":4}}]},"9":{"line":82,"type":"cond-expr","locations":[{"start":{"line":82,"column":31},"end":{"line":82,"column":42}},{"start":{"line":82,"column":44},"end":{"line":82,"column":84}}]},"10":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":6},"end":{"line":100,"column":6}},{"start":{"line":100,"column":6},"end":{"line":100,"column":6}}]},"11":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":6},"end":{"line":123,"column":6}},{"start":{"line":123,"column":6},"end":{"line":123,"column":6}}]},"12":{"line":124,"type":"cond-expr","locations":[{"start":{"line":124,"column":66},"end":{"line":124,"column":78}},{"start":{"line":124,"column":79},"end":{"line":124,"column":86}}]},"13":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":8},"end":{"line":171,"column":8}},{"start":{"line":171,"column":8},"end":{"line":171,"column":8}}]},"14":{"line":171,"type":"binary-expr","locations":[{"start":{"line":171,"column":12},"end":{"line":171,"column":28}},{"start":{"line":171,"column":32},"end":{"line":171,"column":60}}]},"15":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":10},"end":{"line":175,"column":10}},{"start":{"line":175,"column":10},"end":{"line":175,"column":10}}]},"16":{"line":179,"type":"if","locations":[{"start":{"line":179,"column":10},"end":{"line":179,"column":10}},{"start":{"line":179,"column":10},"end":{"line":179,"column":10}}]},"17":{"line":179,"type":"binary-expr","locations":[{"start":{"line":179,"column":14},"end":{"line":179,"column":19}},{"start":{"line":179,"column":23},"end":{"line":179,"column":34}}]},"18":{"line":189,"type":"binary-expr","locations":[{"start":{"line":189,"column":13},"end":{"line":189,"column":23}},{"start":{"line":189,"column":27},"end":{"line":189,"column":36}}]},"19":{"line":197,"type":"if","locations":[{"start":{"line":197,"column":8},"end":{"line":197,"column":8}},{"start":{"line":197,"column":8},"end":{"line":197,"column":8}}]},"20":{"line":206,"type":"if","locations":[{"start":{"line":206,"column":8},"end":{"line":206,"column":8}},{"start":{"line":206,"column":8},"end":{"line":206,"column":8}}]},"21":{"line":221,"type":"binary-expr","locations":[{"start":{"line":221,"column":17},"end":{"line":221,"column":32}},{"start":{"line":221,"column":36},"end":{"line":221,"column":48}}]},"22":{"line":222,"type":"binary-expr","locations":[{"start":{"line":222,"column":18},"end":{"line":222,"column":27}},{"start":{"line":222,"column":31},"end":{"line":222,"column":70}}]},"23":{"line":222,"type":"binary-expr","locations":[{"start":{"line":222,"column":52},"end":{"line":222,"column":61}},{"start":{"line":222,"column":65},"end":{"line":222,"column":69}}]},"24":{"line":223,"type":"if","locations":[{"start":{"line":223,"column":6},"end":{"line":223,"column":6}},{"start":{"line":223,"column":6},"end":{"line":223,"column":6}}]},"25":{"line":225,"type":"binary-expr","locations":[{"start":{"line":225,"column":12},"end":{"line":225,"column":16}},{"start":{"line":225,"column":18},"end":{"line":225,"column":27}}]},"26":{"line":227,"type":"if","locations":[{"start":{"line":227,"column":6},"end":{"line":227,"column":6}},{"start":{"line":227,"column":6},"end":{"line":227,"column":6}}]},"27":{"line":253,"type":"cond-expr","locations":[{"start":{"line":253,"column":37},"end":{"line":253,"column":47}},{"start":{"line":253,"column":50},"end":{"line":253,"column":79}}]},"28":{"line":267,"type":"if","locations":[{"start":{"line":267,"column":6},"end":{"line":267,"column":6}},{"start":{"line":267,"column":6},"end":{"line":267,"column":6}}]},"29":{"line":277,"type":"binary-expr","locations":[{"start":{"line":277,"column":30},"end":{"line":277,"column":51}},{"start":{"line":277,"column":55},"end":{"line":277,"column":77}}]},"30":{"line":278,"type":"cond-expr","locations":[{"start":{"line":278,"column":32},"end":{"line":278,"column":65}},{"start":{"line":278,"column":68},"end":{"line":278,"column":104}}]},"31":{"line":283,"type":"if","locations":[{"start":{"line":283,"column":10},"end":{"line":283,"column":10}},{"start":{"line":283,"column":10},"end":{"line":283,"column":10}}]},"32":{"line":291,"type":"if","locations":[{"start":{"line":291,"column":8},"end":{"line":291,"column":8}},{"start":{"line":291,"column":8},"end":{"line":291,"column":8}}]},"33":{"line":294,"type":"cond-expr","locations":[{"start":{"line":294,"column":44},"end":{"line":294,"column":48}},{"start":{"line":294,"column":51},"end":{"line":294,"column":57}}]},"34":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":27},"end":{"line":303,"column":37}},{"start":{"line":303,"column":41},"end":{"line":303,"column":56}}]},"35":{"line":305,"type":"if","locations":[{"start":{"line":305,"column":6},"end":{"line":305,"column":6}},{"start":{"line":305,"column":6},"end":{"line":305,"column":6}}]},"36":{"line":364,"type":"if","locations":[{"start":{"line":364,"column":6},"end":{"line":364,"column":6}},{"start":{"line":364,"column":6},"end":{"line":364,"column":6}}]},"37":{"line":365,"type":"if","locations":[{"start":{"line":365,"column":8},"end":{"line":365,"column":8}},{"start":{"line":365,"column":8},"end":{"line":365,"column":8}}]},"38":{"line":371,"type":"switch","locations":[{"start":{"line":372,"column":8},"end":{"line":374,"column":16}},{"start":{"line":375,"column":8},"end":{"line":377,"column":16}}]},"39":{"line":381,"type":"cond-expr","locations":[{"start":{"line":381,"column":30},"end":{"line":381,"column":52}},{"start":{"line":381,"column":56},"end":{"line":381,"column":89}}]},"40":{"line":381,"type":"binary-expr","locations":[{"start":{"line":381,"column":56},"end":{"line":381,"column":72}},{"start":{"line":381,"column":76},"end":{"line":381,"column":89}}]},"41":{"line":387,"type":"if","locations":[{"start":{"line":387,"column":6},"end":{"line":387,"column":6}},{"start":{"line":387,"column":6},"end":{"line":387,"column":6}}]},"42":{"line":449,"type":"if","locations":[{"start":{"line":449,"column":6},"end":{"line":449,"column":6}},{"start":{"line":449,"column":6},"end":{"line":449,"column":6}}]},"43":{"line":480,"type":"cond-expr","locations":[{"start":{"line":480,"column":42},"end":{"line":480,"column":84}},{"start":{"line":480,"column":87},"end":{"line":480,"column":111}}]},"44":{"line":482,"type":"if","locations":[{"start":{"line":482,"column":6},"end":{"line":482,"column":6}},{"start":{"line":482,"column":6},"end":{"line":482,"column":6}}]},"45":{"line":482,"type":"binary-expr","locations":[{"start":{"line":482,"column":10},"end":{"line":482,"column":53}},{"start":{"line":482,"column":57},"end":{"line":482,"column":89}}]},"46":{"line":483,"type":"cond-expr","locations":[{"start":{"line":483,"column":45},"end":{"line":483,"column":87}},{"start":{"line":483,"column":90},"end":{"line":483,"column":92}}]},"47":{"line":504,"type":"if","locations":[{"start":{"line":504,"column":8},"end":{"line":504,"column":8}},{"start":{"line":504,"column":8},"end":{"line":504,"column":8}}]},"48":{"line":517,"type":"binary-expr","locations":[{"start":{"line":517,"column":83},"end":{"line":517,"column":92}},{"start":{"line":517,"column":96},"end":{"line":517,"column":113}}]},"49":{"line":552,"type":"switch","locations":[{"start":{"line":553,"column":8},"end":{"line":557,"column":16}},{"start":{"line":559,"column":8},"end":{"line":559,"column":18}},{"start":{"line":560,"column":8},"end":{"line":573,"column":16}},{"start":{"line":575,"column":8},"end":{"line":579,"column":16}}]},"50":{"line":570,"type":"if","locations":[{"start":{"line":570,"column":10},"end":{"line":570,"column":10}},{"start":{"line":570,"column":10},"end":{"line":570,"column":10}}]},"51":{"line":584,"type":"if","locations":[{"start":{"line":584,"column":8},"end":{"line":584,"column":8}},{"start":{"line":584,"column":8},"end":{"line":584,"column":8}}]},"52":{"line":584,"type":"binary-expr","locations":[{"start":{"line":584,"column":12},"end":{"line":584,"column":29}},{"start":{"line":584,"column":33},"end":{"line":584,"column":56}}]},"53":{"line":591,"type":"binary-expr","locations":[{"start":{"line":591,"column":22},"end":{"line":591,"column":31}},{"start":{"line":591,"column":35},"end":{"line":591,"column":57}}]},"54":{"line":592,"type":"cond-expr","locations":[{"start":{"line":592,"column":43},"end":{"line":592,"column":49}},{"start":{"line":592,"column":50},"end":{"line":592,"column":56}}]},"55":{"line":594,"type":"if","locations":[{"start":{"line":594,"column":10},"end":{"line":594,"column":10}},{"start":{"line":594,"column":10},"end":{"line":594,"column":10}}]},"56":{"line":601,"type":"if","locations":[{"start":{"line":601,"column":8},"end":{"line":601,"column":8}},{"start":{"line":601,"column":8},"end":{"line":601,"column":8}}]},"57":{"line":605,"type":"if","locations":[{"start":{"line":605,"column":8},"end":{"line":605,"column":8}},{"start":{"line":605,"column":8},"end":{"line":605,"column":8}}]},"58":{"line":608,"type":"if","locations":[{"start":{"line":608,"column":8},"end":{"line":608,"column":8}},{"start":{"line":608,"column":8},"end":{"line":608,"column":8}}]},"59":{"line":622,"type":"if","locations":[{"start":{"line":622,"column":6},"end":{"line":622,"column":6}},{"start":{"line":622,"column":6},"end":{"line":622,"column":6}}]},"60":{"line":622,"type":"binary-expr","locations":[{"start":{"line":622,"column":10},"end":{"line":622,"column":14}},{"start":{"line":622,"column":18},"end":{"line":622,"column":27}},{"start":{"line":622,"column":31},"end":{"line":622,"column":53}}]},"61":{"line":630,"type":"if","locations":[{"start":{"line":630,"column":6},"end":{"line":630,"column":6}},{"start":{"line":630,"column":6},"end":{"line":630,"column":6}}]}},"code":["// Client-Side Bundler of assets in development and production","'use strict';","","var fs = require('fs'),","    path = require('path'),","    async = require('async'),","    debug = require('debug')('socketstream:bundler'),","    log = require('../../utils/log'),","    CleanCSS = require('clean-css'),","    system = require('../system'),","    glob = require('glob'),","    uglifyjs = require('uglify-js');","","/**"," * {const|local|start|lib|mod} AssetType"," *"," * {'css'|'html'|'worker'|'js'} AssetBundleType"," * @typedef {"," *  name:string,"," *  path:string,"," *  dir:string,"," *  content:string,"," *  options:string,"," *  type:string"," *  } AssetEntry"," */","","/**"," * Bundler by client name"," * @type {{}}"," */","var bundlers = {},","    bundlerById = {};","","function getBundler(client){","  if (typeof client === \"string\") { return bundlers[client]; }","","  if (client.bundler) { return client.bundler; }","","  if (client.ts) {","    if (bundlerById[client.ts]) {","      return bundlerById[client.ts];","    }","  }","  if (typeof client.client === \"string\") {","    return bundlers[client.client];","  }","  if (typeof client.name === \"string\") {","    return bundlers[client.name];","  }","","  throw new Error('Unknown client '+(client.name || client.client || client.ts) );","}","","/**"," * @ngdoc service"," * @name bundler"," * @function"," * @description"," * Bundlers included."," */","","/**"," * @ngdoc service"," * @name ss.bundler:bundler"," * @function"," *"," * @description"," * Client bundling API"," * -----------"," * Client bundling API for implementing a custom bundler."," */","module.exports = function(ss,options) {","","  var proto = require('./proto')(ss, bundlers, bundlerById, options),","      compressor = uglifyjs.Compressor({warnings:false});","","  function systemModule(name,wrap) {","    name = name.replace(/\\.js$/,'');","    var mod = system.assets.modules[name];","    if (mod) {","      var code = wrap===false? mod.content: ss.bundler.wrapModule(name, mod.content);","      return {","        file: mod.name,","        name: mod.name,","        path: mod.path,","        dir: mod.dir,","        content: code,","        options: mod.options,","        type: mod.type,","        includeType: 'system'","      };","    }","  }","","  return {","","    create: function create(bundler) {","      var created = Object.create(proto);","      if (bundler) {","        for(var key in bundler) {","          created[key] = bundler[key];","        }","      }","      return created;","    },","","    /**","     * @ngdoc method","     * @name ss.bundler:bundler#define","     * @methodOf ss.bundler:bundler","     * @function","     * [Internal] Define the bundler for a client (do not call directly)","     * @param {string} client object to store the definition in","     * @param {object} args arguments passed to define","     */","    define: function defineBundler(client,args) {","","      var name = args[0],","          pathsOrPlugin = args[1],","          bundler;","","      if (typeof pathsOrPlugin === \"string\") {","        bundler = bundlers[name] = ss.require(options.servePacked?'production':args[1],'client/bundler','default')(ss,client,options);","        bundler.client = client;","        bundler.define(args[2], args[3], args[4], args[5]);","      } else {","        bundler = bundlers[name] = require('./default')(ss,client,options); //TODO production bundler switch","        bundler.client = client;","        bundler.define(args[1],args[2]);","      }","      bundler.useLatestsPackedId();","    },","","    /**","     * @ngdoc method","     * @name ss.bundler:bundler#get","     * @methodOf ss.bundler:bundler","     * @function","     * @description","     * Determine the bundler for a client","     * @param {object|string} client Query params with client=name or an actual client object","     */","    get: getBundler,","","    forEach: function(fn,that) {","      for(var key in bundlers) {","          var bundler = bundlers[key];","          fn.call(that,bundler,key);","      }","    },","","    findEntryPoint: function(client) {","","      var firstIndex, // if no entry point, use first index found","          firstFile;  // if no entry and index, use first file found","","      function onlyModuleEntry(f) {","        return f.substring(0,6) === 'entry.';","      }","      function onlyModuleIndex(f) {","        return f.substring(0,6) === 'index.';","      }","      function diskToRequire(rel) {","        return '/' + rel.replace(/\\\\/g,'/');","      }","","      for(var i = 0,rel; (rel = client.paths.code[i]); ++i) {","        var p = path.join(ss.root, rel);","        //TODO if not exists error handling","        if (fs.existsSync(p) && fs.statSync(p).isDirectory()) {","","          var files = fs.readdirSync(p);","          var entry = files.filter(onlyModuleEntry);","          if (entry.length) {","            return diskToRequire(rel) + '/entry';","          }","          var index = files.filter(onlyModuleIndex);","          if (index && !firstIndex) {","            firstIndex = diskToRequire(rel) + '/';","          }","        }","        else {","          firstFile = diskToRequire(rel);","          firstFile = firstFile.substring(0, firstFile.length - path.extname(firstFile).length);","        }","      }","","      return firstIndex || firstFile;","    },","","    load: function() {","      var ids = []","      this.forEach(function(bundler) {","        bundlerById[bundler.client.id] = bundler;","        ids.push(bundler.client.id);","        if (bundler.load) {","            bundler.load();","        }","      });","      debug('loaded clients %s', ids.join(' '));","    },","","    unload: function() {","      for(var n in bundlers) {","        if (bundlers[n].unload) {","          bundlers[n].unload();","          bundlers[n].unload = null;","        }","      }","    },","","    forget: function() {","      bundlerById = {};","      bundlers = {};","    },","","    // API for implementing bundlers","","    loadFile: function loadFile(entry, opts, formatter, cb, errCb) {","      var type = entry.assetType || entry.bundle;","      formatter = formatter || ss.client.formatters[entry.ext || type];","      if (!formatter) {","        throw new Error('Unsupported file extension \\'.' + entry.ext + '\\' when we were expecting some type of ' +","          ((type||'unknown').toUpperCase()) + ' file. Please provide a formatter for ' + (entry.file) + ' or move it to /client/static');","      }","      if (formatter.assetType !== type) {","        throw new Error('Unable to render \\'' + entry.file + '\\' as this appears to be a ' + (type.toUpperCase()) +","          ' file. Expecting some type of ' + (type.toUpperCase()) + ' file in ' + (path.dirname(entry.file)) + ' instead');","      }","","      // Use the formatter to pre-process the asset before bundling","      try {","        return formatter.call(this.clientFilePath(entry.file), opts, cb, errCb);","      } catch (err) {","        return errCb(err);","      }","    },","","    minifyCSS: function minifyCSS(files) {","      var origLength = 0;","      var minified = files.map(function(entry){","        origLength += entry.content.length;","        return new CleanCSS().minify(entry.content).styles; // this could also be an async call","      }).join('\\n');","      log.info(('  Minified CSS from ' + (formatKb(origLength)) + ' to ' + (formatKb(minified.length))).grey);","      return minified;","    },","","    minifyJS: function minifyJS_(files) {","      var that = this;","      var min = files.map(function(js) {","        return js.options.minified ? js.content : that.minifyJSFile(js.content);","      });","      return min.join('\\n');","    },","","    minifyJSFile: function minifyJSFile(originalCode, fileName) {","      var ast = uglifyjs.parse(originalCode, { filename:fileName });","      ast.figure_out_scope();","      ast = ast.transform(compressor);","","      ast.figure_out_scope();","      ast.compute_char_frequency();","      ast.mangle_names();","      var minifiedCode = ast.print_to_string();","      if (fileName) {","        log.info(('  Minified ' + fileName + ' from ' + (formatKb(originalCode.length)) + ' to ' + (formatKb(minifiedCode.length))).grey);","      }","      return minifiedCode;","    },","","    // input is decorated and returned","    sourcePaths: function(paths) {","","      function relativePath(p, dirType) {","          var relativeStart = p.indexOf('./') === 0 || p.indexOf('../') === 0;","          return relativeStart? prefixPath(options.dirs.client,p) : prefixPath(options.dirs[dirType], p);","      }","","      function prefixPath(base,p) {","          base = base.replace(/^\\//,'');","          if (p === '*') {","            return base;","          }","          p = p.replace(/\\/\\*$/,'');","          return path.join(base,p);","      }","","      function entries(from, dirType) {","        if (from == null) {","          return [];","        }","        var list = (from instanceof Array)? from : [from];","","        return list.map(function(value) {","          return relativePath(value, dirType);","        });","      }","","      paths.css = entries(paths.css, 'css');","      paths.code = entries(paths.code, 'code');","      paths.tmpl = entries(paths.tmpl || paths.templates, 'templates');","","      if (paths.view) {","        paths.view = relativePath(paths.view, 'views');","      }","","      return paths;","    },","","      /**","       * @ngdoc method","       * @name ss.bundler:bundler#destsFor","       * @methodOf ss.bundler:bundler","       * @function","       * @description","       * The define client method of all bundlers must return the file locations for the client.","       *","       *     return ss.bundler.destsFor(client);","       *","       * To offer a very different way to define the entry-points for assets the bundler can tweak","       * the paths or replace them.","       * @param {object} client Object describing the client.","       * @returns {object} Destinations paths, relPaths, dir, containerDir","       */","    destsFor: function(client) {","      var containerDir = path.join(ss.root, options.dirs.assets);","      var clientDir = path.join(containerDir, client.name);","      var assetsUrl = options.urls.assets;","","      return {","","        //TODO perhaps mixin the abs versions by SS","        urls: {","          html: assetsUrl + client.name + '/' + client.id + '.html',","          js: assetsUrl + client.name + '/' + client.id + '.js',","          css: assetsUrl + client.name + '/' + client.id + '.css'","        },","        paths: {","          html: path.join(clientDir, client.id + '.html'),","          js: path.join(clientDir, client.id + '.js'),","          css: path.join(clientDir, client.id + '.css')","        },","        relPaths: {","          html: path.join(options.dirs.assets, client.name, client.id + '.html'),","          js: path.join(options.dirs.assets, client.name, client.id + '.js'),","          css: path.join(options.dirs.assets, client.name, client.id + '.css')","        },","        dir: clientDir,","        containerDir: containerDir","      };","    },","","    /**","     @param bundle {String} tmpl/code/css","     @param file {String} Path relative to project","     */","    entryFor: function(bundle,file,part2) {","      var result = {","        bundle: bundle,","        file:file","      };","      if (part2) {","        if (part2.charAt(0) !== '/') {","          part2 = '/' + part2;","        }","        result.file = file + part2;","      }","","      switch(bundle) {","        case 'tmpl':","          result.assetType = 'html';","          break;","        case 'worker':","          result.assetType = 'js';","          break;","      }","","      var extension = path.extname(result.file);","      result.ext = extension? extension.substring(1) : (result.assetType || result.bundle);","","      return result;","    },","","    browserifyLoader: function() {","      if (!this.browserifyContent) {","        this.browserifyContent = fs.readFileSync(path.join(__dirname,'browserify.client.js'),'utf8');","      }","      return {","        type: 'mod',","        file: 'loader',","        includeType: 'system',","        names: ['browserify.client.js'],","        content: this.browserifyContent","      };","    },","","    /**","     * @ngdoc method","     * @name ss.bundler:bundler#systemLibs","     * @methodOf ss.bundler:bundler","     * @function","     * @description","     * A single entry for all system libraries.","     *","     * @returns {AssetEntry} Entry","     */","    systemLibs: function() {","      var names = [];","      return {","        type: 'mod',","        file: 'libs',","        includeType: 'system',","        names: names,","        content: system.assets.libs.map(function(lib) { names.push(lib.name); return lib.content; }).join('\\n')","      };","    },","","    /**","     * @ngdoc method","     * @name ss.bundler:bundler#systemModule","     * @methodOf ss.bundler:bundler","     * @function","     * @description","     * Describe a system module.","     *","     * @param {String} name Name of the system module to return in a descriptor","     * @param {boolean} wrap Shall the content be wrapped in `require.define`. Default is true.","     * @returns {AssetEntry} Entry","     */","    systemModule: systemModule,","","    systemModules: function(wrap) {","      return Object.keys(system.assets.modules).map(function(name) {","        return systemModule(name,wrap);","      });","    },","","    constants: function(client) {","      var constants = {}, k;","","      // mixin system constants","      for(k in system.assets.constants) {","        constants[k] = system.assets.constants[k];","      }","","      // mixin client constants","      if (client.constants) {","        for(k in client.constants) {","          constants[k] = describeConstant(k, client.constants[k]);","        }","      }","","      function describeConstant(key,value) {","        var desc = { name:key, value:value, type:'constant' };","        // perhaps add, value = function support","        return desc;","      }","","      // list of constants","      var list = [];","      for(k in constants) {","        constants[k].content = 'var '+constants[k].name+'='+ JSON.stringify(constants[k].value) +';';","        list.push(constants[k]);","      }","      return list;","    },","","    /**","     * Default start/init codes to load the client view.","     *","     * Called in default bundler startCode.","     *","     * @param client Client Object","     * @returns {[{content: *, options: {}, type:'start'}]} Single Entry for inclusion in entries()","     */","    startCode: function(client) {","      var startCode = system.assets.startCode.map(function(ic) { return ic.content; }),","        entryInit = client.entryInitPath? 'require(\"' + client.entryInitPath + '\");' : options.defaultEntryInit;","","      if (typeof options.entryModuleName === 'string' || options.entryModuleName === null) {","        entryInit = options.entryModuleName? 'require(\"/'+options.entryModuleName+'\");' : '';","      }","","      startCode.push(entryInit);","","      return [{ content: startCode.join('\\n'), options: {}, type: 'start', includeType:'initCode' }];","    },","","    packAssetSet: function packAssetSet(assetType, client, postProcess, done) {","      var bundler = getBundler(client);","","      // if this goes away, drop async dependency. manage with orchestrator?","      async.mapSeries(bundler.entries(assetType,system.assets), iterator, andThen);","","      function iterator(entry, callback) {","        var options = {","          constants: bundler.constants(),","          locals: bundler.locals(),","          //pathPrefix: entry.importedBy,","          compress: true","        };","        if (typeof entry.content === \"string\") {","          callback(null, {content:entry.content,options:{}});","        }","        else {","          bundler.asset(entry, options, function(output) {","            //TODO if err, flag has errors","            callback(null, {content:output,options:{}});","          });","        }","      }","","      function andThen(err, results) {","        var fileName = bundler.dests.paths[assetType];","        fs.writeFileSync(fileName, postProcess(results.filter(function(f) { return f.content && f.content !== ';'; })));","        log.info('✓'.green, 'Packed', results.length, 'files into', bundler.dests.relPaths[assetType]);","        done();","      }","    },","","    //TODO task for generating the on-demand stuff to target assets dir","    //TODO dynamic rule for this, so it can be reapplied when directory changes","    updateCachedOndemandAssets: function UpdateCachedOndemandAssets() {","","      var files = glob.sync('**/*.js', {cwd: path.join(ss.root,options.dirs.code)}); //TODO need root *.js as well","      files.forEach(function(rel) {","        ss.http.cached.route('assets/ondemand/'+ (rel.replace('\\\\','/')), null, path.join(ss.root, options.dirs.code, rel) );","      },this);","","      files = glob.sync('**/*.js', {cwd: path.join(ss.root,options.dirs.workers)}); //TODO need root *.js as well","      files.forEach(function(rel) {","        ss.http.cached.route('assets/workers/'+ (rel.replace('\\\\','/')), null, path.join(ss.root, options.dirs.workers, rel) );","      },this);","    },","","    /**","     * Make a list of asset entries for JS/CSS bundle.","     *","     * @param client","     * @param assetType","     * @returns {Array}","     */","    entries: function entries(client, assetType) {","","      var _entries = [],","          bundler = getBundler(client),","          includeType,","          bundle;","","      switch(assetType) {","        case 'css':","          includeType = 'css';","          bundle = 'css';","          client.paths['css'].forEach(pushMainEntries);","          break;","","        case 'js':","        case 'worker':","          var loader = bundler.module('loader');","          var libs = bundler.module('libs');","          var mods = bundler.module.apply(bundler, Object.keys(system.assets.modules));","","          _entries = _entries.concat(loader).concat(libs).concat(mods);","          includeType = false;","          bundle = 'js';","          //TODO worker instead of code ?","          client.paths.code.forEach(pushMainEntries);","          if (options.startInBundle) {","            _entries = _entries.concat(bundler.module('start'));","          }","          break;","","        case 'tmpl':","          includeType = 'html';","          bundle = 'tmpl';","          client.paths.tmpl.forEach(pushMainEntries);","          break;","      }","","      function pushMainEntries(from) {","        var p = path.join(ss.root,from);","        if (!fs.existsSync(p) || fs.statSync(p).isFile()) {","          p = from;","        } else {","          p = path.join(from,'**','*');","        }","        return glob.sync(p, {cwd:ss.root}).forEach(function(file) {","          var extension = path.extname(file);","          extension = extension && extension.substring(1); // argh!","          var assetType = bundle==='tmpl'? 'html':bundle;","          var entry = {file:file,importedBy:from,includeType:includeType,ext:extension,bundle:bundle,assetType:assetType};","          if (isAssetType(entry)) {","            _entries.push(entry);","          }","        });","      }","","      function isAssetType(entry) {","        if (ss.client.formatters == null) {","          return false;","        }","        var formatter = ss.client.formatters[entry.ext];","        if (formatter == null) {","          return false;","        }","        if (formatter.assetType === undefined) {","          throw new Error('Unable to render \\''+entry.file+'\\' as the formatter has no asset type.');","        }","        return formatter.assetType === entry.assetType;","      }","","      // entries with blank ones stripped out","      return _entries.filter(function(entry) {","        return !!entry;","      });","    },","","    injectTailIfNeeded: function(output,opts) {","      // If passing optional tails for main view","      if (opts && opts.tail && !options.startInBundle) {","        output = output.replace('</body>', opts.tail + '</body>');","        output = output.replace('</BODY>', opts.tail + '</BODY>');","      }","      return output;","    },","","    clientFilePath: function(rel) {","      if (typeof rel === 'object') {","        // entry object","        rel = rel.file;","      }","      return path.join(ss.root,rel);","    },","","    formatKb: formatKb,","","    wrapModule: function(modPath, code) {","      return 'require.define(\"' + modPath + '\", function (require, module, exports, __dirname, __filename){\\n' + code + '\\n});'+","      '';","            //TODO  '\\n//# sourceMappingURL='+modPath+'.js\\n';","    }","","  };","};","","function formatKb(size) {","  return '' + (Math.round((size / 1024) * 1000) / 1000) + ' KB';","}",""],"l":{"4":1,"32":1,"35":1,"36":0,"38":0,"40":0,"41":0,"42":0,"45":0,"46":0,"48":0,"49":0,"52":0,"73":1,"75":1,"78":1,"79":0,"80":0,"81":0,"82":0,"83":0,"96":1,"99":0,"100":0,"101":0,"102":0,"105":0,"119":0,"123":0,"124":0,"125":0,"126":0,"128":0,"129":0,"130":0,"132":0,"147":0,"148":0,"149":0,"155":0,"158":1,"159":0,"161":1,"162":0,"164":1,"165":0,"168":0,"169":0,"171":0,"173":0,"174":0,"175":0,"176":0,"178":0,"179":0,"180":0,"184":0,"185":0,"189":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"201":0,"205":0,"206":0,"207":0,"208":0,"214":0,"215":0,"221":0,"222":0,"223":0,"224":0,"227":0,"228":0,"233":0,"234":0,"236":0,"241":0,"242":0,"243":0,"244":0,"246":0,"247":0,"251":0,"252":0,"253":0,"255":0,"259":0,"260":0,"261":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"270":0,"276":1,"277":0,"278":0,"281":1,"282":0,"283":0,"284":0,"286":0,"287":0,"290":1,"291":0,"292":0,"294":0,"296":0,"297":0,"301":0,"302":0,"303":0,"305":0,"306":0,"309":0,"328":0,"329":0,"330":0,"332":0,"360":0,"364":0,"365":0,"366":0,"368":0,"371":0,"373":0,"374":0,"376":0,"377":0,"380":0,"381":0,"383":0,"387":0,"388":0,"390":0,"410":0,"411":0,"416":0,"435":0,"436":0,"441":0,"444":0,"445":0,"449":0,"450":0,"451":0,"455":1,"456":0,"458":0,"462":0,"463":0,"464":0,"465":0,"467":0,"479":0,"482":0,"483":0,"486":0,"488":0,"492":0,"495":0,"497":1,"498":0,"504":0,"505":0,"508":0,"510":0,"515":1,"516":0,"517":0,"518":0,"519":0,"527":0,"528":0,"529":0,"532":0,"533":0,"534":0,"547":0,"552":0,"554":0,"555":0,"556":0,"557":0,"561":0,"562":0,"563":0,"565":0,"566":0,"567":0,"569":0,"570":0,"571":0,"573":0,"576":0,"577":0,"578":0,"579":0,"582":1,"583":0,"584":0,"585":0,"587":0,"589":0,"590":0,"591":0,"592":0,"593":0,"594":0,"595":0,"600":1,"601":0,"602":0,"604":0,"605":0,"606":0,"608":0,"609":0,"611":0,"615":0,"616":0,"622":0,"623":0,"624":0,"626":0,"630":0,"632":0,"634":0,"640":0,"648":1,"649":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/proto.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/proto.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":0,"54":0,"55":1,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":1,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":1,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":1,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":1,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":1,"146":0,"147":1,"148":0},"b":{"1":[0,0],"2":[0,0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0]},"f":{"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":7},"end":{"line":11,"column":29}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":6},"end":{"line":15,"column":28}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":17},"end":{"line":41,"column":62}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":10},"end":{"line":52,"column":21}}},"5":{"name":"(anonymous_5)","line":62,"loc":{"start":{"line":62,"column":12},"end":{"line":62,"column":23}}},"6":{"name":"(anonymous_6)","line":73,"loc":{"start":{"line":73,"column":17},"end":{"line":73,"column":28}}},"7":{"name":"(anonymous_7)","line":77,"loc":{"start":{"line":77,"column":25},"end":{"line":77,"column":36}}},"8":{"name":"(anonymous_8)","line":109,"loc":{"start":{"line":109,"column":12},"end":{"line":109,"column":58}}},"9":{"name":"(anonymous_9)","line":115,"loc":{"start":{"line":115,"column":20},"end":{"line":115,"column":34}}},"10":{"name":"(anonymous_10)","line":119,"loc":{"start":{"line":119,"column":14},"end":{"line":119,"column":36}}},"11":{"name":"resolveAssetLink","line":126,"loc":{"start":{"line":126,"column":2},"end":{"line":126,"column":42}}},"12":{"name":"entries","line":172,"loc":{"start":{"line":172,"column":2},"end":{"line":172,"column":43}}},"13":{"name":"(anonymous_13)","line":175,"loc":{"start":{"line":175,"column":75},"end":{"line":175,"column":91}}},"14":{"name":"systemModule","line":192,"loc":{"start":{"line":192,"column":2},"end":{"line":192,"column":42}}},"15":{"name":"constants","line":224,"loc":{"start":{"line":224,"column":2},"end":{"line":224,"column":23}}},"16":{"name":"locals","line":244,"loc":{"start":{"line":244,"column":2},"end":{"line":244,"column":20}}},"17":{"name":"htmlTags","line":277,"loc":{"start":{"line":277,"column":2},"end":{"line":277,"column":31}}},"18":{"name":"(anonymous_18)","line":282,"loc":{"start":{"line":282,"column":52},"end":{"line":282,"column":68}}},"19":{"name":"(anonymous_19)","line":294,"loc":{"start":{"line":294,"column":25},"end":{"line":294,"column":41}}},"20":{"name":"wrapCode","line":315,"loc":{"start":{"line":315,"column":2},"end":{"line":315,"column":39}}},"21":{"name":"UpdateCachedDevAssets","line":366,"loc":{"start":{"line":366,"column":2},"end":{"line":366,"column":35}}},"22":{"name":"(anonymous_22)","line":368,"loc":{"start":{"line":368,"column":35},"end":{"line":368,"column":53}}},"23":{"name":"(anonymous_23)","line":379,"loc":{"start":{"line":379,"column":32},"end":{"line":379,"column":48}}},"24":{"name":"(anonymous_24)","line":380,"loc":{"start":{"line":380,"column":32},"end":{"line":380,"column":49}}},"25":{"name":"(anonymous_25)","line":388,"loc":{"start":{"line":388,"column":31},"end":{"line":388,"column":47}}},"26":{"name":"(anonymous_26)","line":390,"loc":{"start":{"line":390,"column":40},"end":{"line":390,"column":54}}},"27":{"name":"(anonymous_27)","line":395,"loc":{"start":{"line":395,"column":34},"end":{"line":395,"column":51}}},"28":{"name":"toMinifiedCSS","line":420,"loc":{"start":{"line":420,"column":2},"end":{"line":420,"column":32}}},"29":{"name":"toMinifiedJS","line":435,"loc":{"start":{"line":435,"column":2},"end":{"line":435,"column":31}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":8,"column":30}},"2":{"start":{"line":10,"column":0},"end":{"line":38,"column":2}},"3":{"start":{"line":12,"column":4},"end":{"line":12,"column":76}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":87}},"5":{"start":{"line":16,"column":4},"end":{"line":16,"column":34}},"6":{"start":{"line":17,"column":4},"end":{"line":34,"column":5}},"7":{"start":{"line":19,"column":8},"end":{"line":19,"column":28}},"8":{"start":{"line":20,"column":8},"end":{"line":20,"column":14}},"9":{"start":{"line":24,"column":8},"end":{"line":24,"column":33}},"10":{"start":{"line":25,"column":8},"end":{"line":25,"column":14}},"11":{"start":{"line":28,"column":8},"end":{"line":28,"column":27}},"12":{"start":{"line":29,"column":8},"end":{"line":29,"column":14}},"13":{"start":{"line":32,"column":8},"end":{"line":32,"column":31}},"14":{"start":{"line":33,"column":8},"end":{"line":33,"column":14}},"15":{"start":{"line":36,"column":4},"end":{"line":36,"column":72}},"16":{"start":{"line":41,"column":0},"end":{"line":439,"column":2}},"17":{"start":{"line":43,"column":2},"end":{"line":122,"column":4}},"18":{"start":{"line":74,"column":6},"end":{"line":74,"column":52}},"19":{"start":{"line":78,"column":6},"end":{"line":103,"column":7}},"20":{"start":{"line":79,"column":8},"end":{"line":91,"column":9}},"21":{"start":{"line":80,"column":10},"end":{"line":80,"column":38}},"22":{"start":{"line":81,"column":10},"end":{"line":81,"column":96}},"23":{"start":{"line":82,"column":10},"end":{"line":82,"column":44}},"24":{"start":{"line":83,"column":10},"end":{"line":83,"column":42}},"25":{"start":{"line":84,"column":10},"end":{"line":86,"column":11}},"26":{"start":{"line":85,"column":12},"end":{"line":85,"column":45}},"27":{"start":{"line":87,"column":10},"end":{"line":87,"column":35}},"28":{"start":{"line":88,"column":10},"end":{"line":88,"column":34}},"29":{"start":{"line":90,"column":10},"end":{"line":90,"column":33}},"30":{"start":{"line":92,"column":8},"end":{"line":97,"column":9}},"31":{"start":{"line":93,"column":10},"end":{"line":93,"column":47}},"32":{"start":{"line":94,"column":10},"end":{"line":96,"column":11}},"33":{"start":{"line":95,"column":12},"end":{"line":95,"column":53}},"34":{"start":{"line":98,"column":8},"end":{"line":98,"column":96}},"35":{"start":{"line":101,"column":8},"end":{"line":101,"column":32}},"36":{"start":{"line":102,"column":8},"end":{"line":102,"column":46}},"37":{"start":{"line":104,"column":6},"end":{"line":104,"column":25}},"38":{"start":{"line":110,"column":6},"end":{"line":110,"column":61}},"39":{"start":{"line":116,"column":6},"end":{"line":116,"column":44}},"40":{"start":{"line":120,"column":6},"end":{"line":120,"column":46}},"41":{"start":{"line":126,"column":2},"end":{"line":147,"column":3}},"42":{"start":{"line":127,"column":4},"end":{"line":129,"column":94}},"43":{"start":{"line":130,"column":4},"end":{"line":146,"column":5}},"44":{"start":{"line":131,"column":6},"end":{"line":143,"column":7}},"45":{"start":{"line":132,"column":8},"end":{"line":137,"column":10}},"46":{"start":{"line":138,"column":8},"end":{"line":138,"column":26}},"47":{"start":{"line":139,"column":13},"end":{"line":143,"column":7}},"48":{"start":{"line":140,"column":8},"end":{"line":140,"column":20}},"49":{"start":{"line":142,"column":8},"end":{"line":142,"column":79}},"50":{"start":{"line":145,"column":6},"end":{"line":145,"column":25}},"51":{"start":{"line":172,"column":2},"end":{"line":178,"column":3}},"52":{"start":{"line":174,"column":4},"end":{"line":174,"column":40}},"53":{"start":{"line":175,"column":4},"end":{"line":177,"column":7}},"54":{"start":{"line":176,"column":6},"end":{"line":176,"column":67}},"55":{"start":{"line":192,"column":2},"end":{"line":222,"column":3}},"56":{"start":{"line":193,"column":4},"end":{"line":195,"column":29}},"57":{"start":{"line":198,"column":4},"end":{"line":219,"column":5}},"58":{"start":{"line":199,"column":6},"end":{"line":218,"column":7}},"59":{"start":{"line":201,"column":10},"end":{"line":201,"column":54}},"60":{"start":{"line":202,"column":10},"end":{"line":202,"column":16}},"61":{"start":{"line":204,"column":10},"end":{"line":204,"column":48}},"62":{"start":{"line":205,"column":10},"end":{"line":205,"column":16}},"63":{"start":{"line":207,"column":10},"end":{"line":207,"column":65}},"64":{"start":{"line":208,"column":10},"end":{"line":210,"column":11}},"65":{"start":{"line":209,"column":12},"end":{"line":209,"column":67}},"66":{"start":{"line":211,"column":10},"end":{"line":211,"column":16}},"67":{"start":{"line":216,"column":10},"end":{"line":216,"column":54}},"68":{"start":{"line":217,"column":10},"end":{"line":217,"column":16}},"69":{"start":{"line":221,"column":4},"end":{"line":221,"column":19}},"70":{"start":{"line":224,"column":2},"end":{"line":242,"column":3}},"71":{"start":{"line":225,"column":4},"end":{"line":225,"column":23}},"72":{"start":{"line":228,"column":4},"end":{"line":230,"column":5}},"73":{"start":{"line":229,"column":6},"end":{"line":229,"column":51}},"74":{"start":{"line":234,"column":4},"end":{"line":234,"column":29}},"75":{"start":{"line":235,"column":4},"end":{"line":239,"column":5}},"76":{"start":{"line":236,"column":6},"end":{"line":238,"column":7}},"77":{"start":{"line":237,"column":8},"end":{"line":237,"column":40}},"78":{"start":{"line":241,"column":4},"end":{"line":241,"column":18}},"79":{"start":{"line":244,"column":2},"end":{"line":262,"column":3}},"80":{"start":{"line":245,"column":4},"end":{"line":245,"column":23}},"81":{"start":{"line":248,"column":4},"end":{"line":250,"column":5}},"82":{"start":{"line":249,"column":6},"end":{"line":249,"column":48}},"83":{"start":{"line":254,"column":4},"end":{"line":254,"column":29}},"84":{"start":{"line":255,"column":4},"end":{"line":259,"column":5}},"85":{"start":{"line":256,"column":6},"end":{"line":258,"column":7}},"86":{"start":{"line":257,"column":8},"end":{"line":257,"column":37}},"87":{"start":{"line":261,"column":4},"end":{"line":261,"column":18}},"88":{"start":{"line":277,"column":2},"end":{"line":298,"column":3}},"89":{"start":{"line":278,"column":4},"end":{"line":278,"column":14}},"90":{"start":{"line":281,"column":4},"end":{"line":283,"column":5}},"91":{"start":{"line":282,"column":6},"end":{"line":282,"column":121}},"92":{"start":{"line":282,"column":70},"end":{"line":282,"column":91}},"93":{"start":{"line":285,"column":4},"end":{"line":297,"column":5}},"94":{"start":{"line":286,"column":6},"end":{"line":286,"column":27}},"95":{"start":{"line":288,"column":6},"end":{"line":288,"column":61}},"96":{"start":{"line":289,"column":6},"end":{"line":289,"column":38}},"97":{"start":{"line":292,"column":6},"end":{"line":292,"column":39}},"98":{"start":{"line":293,"column":6},"end":{"line":293,"column":25}},"99":{"start":{"line":294,"column":6},"end":{"line":296,"column":9}},"100":{"start":{"line":295,"column":8},"end":{"line":295,"column":42}},"101":{"start":{"line":315,"column":2},"end":{"line":364,"column":3}},"102":{"start":{"line":316,"column":4},"end":{"line":316,"column":40}},"103":{"start":{"line":319,"column":4},"end":{"line":321,"column":5}},"104":{"start":{"line":320,"column":6},"end":{"line":320,"column":18}},"105":{"start":{"line":324,"column":4},"end":{"line":330,"column":5}},"106":{"start":{"line":325,"column":6},"end":{"line":329,"column":7}},"107":{"start":{"line":326,"column":8},"end":{"line":328,"column":9}},"108":{"start":{"line":327,"column":10},"end":{"line":327,"column":22}},"109":{"start":{"line":332,"column":4},"end":{"line":334,"column":37}},"110":{"start":{"line":335,"column":4},"end":{"line":337,"column":5}},"111":{"start":{"line":336,"column":6},"end":{"line":336,"column":59}},"112":{"start":{"line":341,"column":4},"end":{"line":362,"column":5}},"113":{"start":{"line":343,"column":6},"end":{"line":343,"column":69}},"114":{"start":{"line":347,"column":6},"end":{"line":347,"column":34}},"115":{"start":{"line":350,"column":6},"end":{"line":361,"column":7}},"116":{"start":{"line":353,"column":8},"end":{"line":357,"column":9}},"117":{"start":{"line":354,"column":10},"end":{"line":354,"column":46}},"118":{"start":{"line":355,"column":10},"end":{"line":355,"column":19}},"119":{"start":{"line":356,"column":10},"end":{"line":356,"column":41}},"120":{"start":{"line":358,"column":8},"end":{"line":358,"column":64}},"121":{"start":{"line":360,"column":8},"end":{"line":360,"column":32}},"122":{"start":{"line":363,"column":4},"end":{"line":363,"column":48}},"123":{"start":{"line":366,"column":2},"end":{"line":407,"column":3}},"124":{"start":{"line":367,"column":4},"end":{"line":367,"column":68}},"125":{"start":{"line":368,"column":4},"end":{"line":370,"column":7}},"126":{"start":{"line":369,"column":6},"end":{"line":369,"column":67}},"127":{"start":{"line":372,"column":4},"end":{"line":377,"column":6}},"128":{"start":{"line":379,"column":4},"end":{"line":384,"column":12}},"129":{"start":{"line":380,"column":6},"end":{"line":383,"column":20}},"130":{"start":{"line":381,"column":8},"end":{"line":381,"column":81}},"131":{"start":{"line":382,"column":8},"end":{"line":382,"column":67}},"132":{"start":{"line":386,"column":4},"end":{"line":386,"column":21}},"133":{"start":{"line":388,"column":4},"end":{"line":400,"column":12}},"134":{"start":{"line":389,"column":6},"end":{"line":399,"column":7}},"135":{"start":{"line":390,"column":8},"end":{"line":393,"column":11}},"136":{"start":{"line":391,"column":10},"end":{"line":391,"column":58}},"137":{"start":{"line":392,"column":10},"end":{"line":392,"column":48}},"138":{"start":{"line":395,"column":8},"end":{"line":398,"column":22}},"139":{"start":{"line":396,"column":10},"end":{"line":396,"column":82}},"140":{"start":{"line":397,"column":10},"end":{"line":397,"column":68}},"141":{"start":{"line":402,"column":4},"end":{"line":406,"column":5}},"142":{"start":{"line":403,"column":6},"end":{"line":403,"column":41}},"143":{"start":{"line":404,"column":10},"end":{"line":404,"column":75}},"144":{"start":{"line":405,"column":6},"end":{"line":405,"column":64}},"145":{"start":{"line":420,"column":2},"end":{"line":422,"column":3}},"146":{"start":{"line":421,"column":4},"end":{"line":421,"column":39}},"147":{"start":{"line":435,"column":2},"end":{"line":437,"column":3}},"148":{"start":{"line":436,"column":4},"end":{"line":436,"column":38}}},"branchMap":{"1":{"line":12,"type":"cond-expr","locations":[{"start":{"line":12,"column":22},"end":{"line":12,"column":57}},{"start":{"line":12,"column":61},"end":{"line":12,"column":75}}]},"2":{"line":17,"type":"switch","locations":[{"start":{"line":18,"column":6},"end":{"line":20,"column":14}},{"start":{"line":22,"column":6},"end":{"line":22,"column":17}},{"start":{"line":23,"column":6},"end":{"line":25,"column":14}},{"start":{"line":27,"column":6},"end":{"line":29,"column":14}},{"start":{"line":31,"column":6},"end":{"line":33,"column":14}}]},"3":{"line":17,"type":"cond-expr","locations":[{"start":{"line":17,"column":18},"end":{"line":17,"column":28}},{"start":{"line":17,"column":31},"end":{"line":17,"column":35}}]},"4":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":6},"end":{"line":78,"column":6}},{"start":{"line":78,"column":6},"end":{"line":78,"column":6}}]},"5":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":10},"end":{"line":84,"column":10}},{"start":{"line":84,"column":10},"end":{"line":84,"column":10}}]},"6":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":8},"end":{"line":92,"column":8}},{"start":{"line":92,"column":8},"end":{"line":92,"column":8}}]},"7":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":10},"end":{"line":94,"column":10}},{"start":{"line":94,"column":10},"end":{"line":94,"column":10}}]},"8":{"line":94,"type":"binary-expr","locations":[{"start":{"line":94,"column":14},"end":{"line":94,"column":34}},{"start":{"line":94,"column":38},"end":{"line":94,"column":61}}]},"9":{"line":98,"type":"binary-expr","locations":[{"start":{"line":98,"column":25},"end":{"line":98,"column":48}},{"start":{"line":98,"column":52},"end":{"line":98,"column":71}},{"start":{"line":98,"column":75},"end":{"line":98,"column":95}}]},"10":{"line":129,"type":"cond-expr","locations":[{"start":{"line":129,"column":35},"end":{"line":129,"column":83}},{"start":{"line":129,"column":87},"end":{"line":129,"column":93}}]},"11":{"line":129,"type":"cond-expr","locations":[{"start":{"line":129,"column":60},"end":{"line":129,"column":74}},{"start":{"line":129,"column":77},"end":{"line":129,"column":83}}]},"12":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":4},"end":{"line":130,"column":4}},{"start":{"line":130,"column":4},"end":{"line":130,"column":4}}]},"13":{"line":131,"type":"if","locations":[{"start":{"line":131,"column":6},"end":{"line":131,"column":6}},{"start":{"line":131,"column":6},"end":{"line":131,"column":6}}]},"14":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":13},"end":{"line":139,"column":13}},{"start":{"line":139,"column":13},"end":{"line":139,"column":13}}]},"15":{"line":176,"type":"cond-expr","locations":[{"start":{"line":176,"column":32},"end":{"line":176,"column":59}},{"start":{"line":176,"column":62},"end":{"line":176,"column":66}}]},"16":{"line":199,"type":"switch","locations":[{"start":{"line":200,"column":8},"end":{"line":202,"column":16}},{"start":{"line":203,"column":8},"end":{"line":205,"column":16}},{"start":{"line":206,"column":8},"end":{"line":211,"column":16}},{"start":{"line":215,"column":8},"end":{"line":217,"column":16}}]},"17":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":10},"end":{"line":208,"column":10}},{"start":{"line":208,"column":10},"end":{"line":208,"column":10}}]},"18":{"line":235,"type":"if","locations":[{"start":{"line":235,"column":4},"end":{"line":235,"column":4}},{"start":{"line":235,"column":4},"end":{"line":235,"column":4}}]},"19":{"line":255,"type":"if","locations":[{"start":{"line":255,"column":4},"end":{"line":255,"column":4}},{"start":{"line":255,"column":4},"end":{"line":255,"column":4}}]},"20":{"line":281,"type":"if","locations":[{"start":{"line":281,"column":4},"end":{"line":281,"column":4}},{"start":{"line":281,"column":4},"end":{"line":281,"column":4}}]},"21":{"line":285,"type":"if","locations":[{"start":{"line":285,"column":4},"end":{"line":285,"column":4}},{"start":{"line":285,"column":4},"end":{"line":285,"column":4}}]},"22":{"line":319,"type":"if","locations":[{"start":{"line":319,"column":4},"end":{"line":319,"column":4}},{"start":{"line":319,"column":4},"end":{"line":319,"column":4}}]},"23":{"line":324,"type":"if","locations":[{"start":{"line":324,"column":4},"end":{"line":324,"column":4}},{"start":{"line":324,"column":4},"end":{"line":324,"column":4}}]},"24":{"line":324,"type":"binary-expr","locations":[{"start":{"line":324,"column":8},"end":{"line":324,"column":42}},{"start":{"line":324,"column":46},"end":{"line":324,"column":53}},{"start":{"line":324,"column":57},"end":{"line":324,"column":87}}]},"25":{"line":326,"type":"if","locations":[{"start":{"line":326,"column":8},"end":{"line":326,"column":8}},{"start":{"line":326,"column":8},"end":{"line":326,"column":8}}]},"26":{"line":335,"type":"if","locations":[{"start":{"line":335,"column":4},"end":{"line":335,"column":4}},{"start":{"line":335,"column":4},"end":{"line":335,"column":4}}]},"27":{"line":341,"type":"if","locations":[{"start":{"line":341,"column":4},"end":{"line":341,"column":4}},{"start":{"line":341,"column":4},"end":{"line":341,"column":4}}]},"28":{"line":350,"type":"if","locations":[{"start":{"line":350,"column":6},"end":{"line":350,"column":6}},{"start":{"line":350,"column":6},"end":{"line":350,"column":6}}]},"29":{"line":353,"type":"if","locations":[{"start":{"line":353,"column":8},"end":{"line":353,"column":8}},{"start":{"line":353,"column":8},"end":{"line":353,"column":8}}]},"30":{"line":389,"type":"if","locations":[{"start":{"line":389,"column":6},"end":{"line":389,"column":6}},{"start":{"line":389,"column":6},"end":{"line":389,"column":6}}]},"31":{"line":391,"type":"binary-expr","locations":[{"start":{"line":391,"column":32},"end":{"line":391,"column":51}},{"start":{"line":391,"column":55},"end":{"line":391,"column":57}}]}},"code":["'use strict';","// prototype for bundlers created with ss.bundler.create(..)","","var fs = require('fs'),","    path = require('path'),","    shortid = require('shortid'),","    system = require('../system'),","    view = require('../view');","","var htmlTag = {","  css: function(dests,entry) {","    var url = entry? (dests.urls.css + '?_=' + entry.file) : dests.urls.css;","    return '<link href=\"' + url + '\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\">';","  },","  js: function(dests,entry) {","    var url = dests.urls.js + '?';","    switch(entry? entry.type : null) {","      case null:","        url = dests.urls.js;","        break;","","      case 'mod':","      case 'module':","        url += 'mod='+entry.file;","        break;","","      case 'start':","        url += 'mod=start';","        break;","","      default:","        url += '_='+entry.file;","        break;","    }","","    return '<script src=\"' + url + '\" type=\"text/javascript\"></script>';","  }","};","","","module.exports = function(ss, bundlers, bundlerById, options) {","","  return {","    /**","     * @ngdoc method","     * @name bundler.default:default#load","     * @methodOf bundler.default:default","     * @function","     * @description","     * Called when the server is started. Does nothing.","     */","    load: function() {},","","    /**","     * @ngdoc method","     * @name bundler.default:default#unload","     * @methodOf bundler.default:default","     * @function","     * @description","     * Called when the server is stopped. Does nothing.","     */","    unload: function() {},","","    entries: entries,","    module: systemModule,","    toMinifiedCSS: toMinifiedCSS,","    toMinifiedJS: toMinifiedJS,","","    constants: constants,","    locals: locals,","    htmlTags: htmlTags,","","    updateDests: function() {","      this.dests = ss.bundler.destsFor(this.client);","    },","","    useLatestsPackedId : function() {","      if (options.servePacked) {","        try {","          this.latestPackedId = false;","          var files = fs.readdirSync(path.join(ss.root, options.dirs.assets, this.client.name));","          var latestId = files.sort().pop();","          var id = latestId.split('.')[0];","          if (!shortid.isValid(id)) {","            throw 'Invalid Client ID length';","          }","          this.latestPackedId = id;","          this.packNeeded = false;","        } catch (e) {","          this.packNeeded = true;","        }","        if (this.latestPackedId) {","          this.client.id = this.latestPackedId;","          if (options.packedAssets && options.packedAssets.id) {","            this.client.id = options.packedAssets.id;","          }","        }","        this.client.id = options.packedAssets.id || this.latestPackedId || this.client.uniqueId;","","      } else {","        this.packNeeded = false;","        this.client.id = this.client.uniqueId;","      }","      this.updateDests();","    },","","    wrapCode: wrapCode,","","    format: function(entry, options, formatter,cb, errCb) {","      ss.bundler.loadFile(entry,options,formatter,cb, errCb); //TODO call loadFile 'html'","    },","","    updateCachedDevAssets: UpdateCachedDevAssets,","","    clientFilePath: function(rel) {","      return ss.bundler.clientFilePath(rel);","    },","","    entryFor: function(bundle,file) {","      return ss.bundler.entryFor(bundle,file);","    }","  };","","  // When packing assets the default path to the CSS or JS file can be overridden","  // either with a string or a function, typically pointing to an resource on a CDN","  function resolveAssetLink(client, type) {","    var defaultPath = '/assets/' + client.name + '/' + client.id + '.' + type,","      pack = options.packedAssets,","      link = pack !== undefined ? (pack.cdn !== undefined ? pack.cdn[type] : void 0) : void 0;","    if (link) {","      if (typeof link === 'function') {","        var file = {","          id: client.id,","          name: client.name,","          extension: type,","          path: defaultPath","        };","        return link(file);","      } else if (typeof link === 'string') {","        return link;","      } else {","        throw new Error('CDN ' + type + ' param must be a Function or String');","      }","    } else {","      return defaultPath;","    }","  }","","  /**","   * @ngdoc method","   * @name bundler.default:default#entries","   * @methodOf bundler.default:default","   * @function","   * @description","   * Provides the view and the pack functions with a","   * list of entries for an asset type relative to the client directory.","   * The default implementation is used.","   *","   * An entry describes:","   * - file: source file name relative to client directory","   * - importedFrom: Pulled in by require in other file","   * - content: If pre-loaded","   * - type: If system asset it will have type lib/mod","   * - bundle: which production bundle (html, tmpl, css, js, worker)","   * - assetType: css, js, html","   * - extension: source file extension","   *","   * @param {String} assetType js/css/tmpl","   * @param {Object} systemAssets Collection of libs, modules, initCode","   * @returns {[AssetEntry]} List of output entries","   */","  function entries(assetType,systemAssets) {","    // jshint validthis:true","    var includes = this.client.includes;","    return ss.bundler.entries(this.client, assetType, systemAssets).filter(function(entry) {","      return entry.includeType? includes[entry.includeType] : true;","    });","  }","","  /**","   * @ngdoc method","   * @name bundler.default:default#system","   * @methodOf bundler.default:default","   * @function","   * @description","   * Return entries for the loader/start/module depending on includes.system client config and system assets.","   * Multiple arguments will attempt to add module for the name.","   * Special module names are 'loader' and 'start'.","   *","   * @returns {AssetEntry} Resource entries array","   */","  function systemModule(/* first_name */) {","    var entries = [],","        // jshint validthis:true","        client = this.client;","","    /*jshint -W084 */","    for(var i= 0,name; name = arguments[i]; ++i) {","      switch(name) {","        case 'loader':","          entries.push(ss.bundler.browserifyLoader());","          break;","        case 'libs':","          entries.push(ss.bundler.systemLibs());","          break;","        case 'start':","          entries = entries.concat(ss.bundler.constants(client));","          if (client.includes.initCode) {","            entries = entries.concat(ss.bundler.startCode(client));","          }","          break;","","        //case \"eventemitter2\":","        //case \"socketstream\":","        default:","          entries.push(ss.bundler.systemModule(name));","          break;","      }","    }","","    return entries;","  }","","  function constants() {","    var result = {}, k;","","    // mixin system constants","    for(k in system.assets.constants) {","      result[k] = system.assets.constants[k].value;","    }","","    // mixin client constants","    // jshint validthis:true","    var client = this.client;","    if (client.constants) {","      for(k in client.constants) {","        result[k] = client.constants[k];","      }","    }","","    return result;","  }","","  function locals() {","    var result = {}, k;","","    // mixin system locals","    for(k in system.assets.locals) {","      result[k] = system.assets.locals[k].value;","    }","","    // mixin client constants","    // jshint validthis:true","    var client = this.client;","    if (client.locals) {","      for(k in client.locals) {","        result[k] = client.locals[k];","      }","    }","","    return result;","  }","","  /**","   * @ngdoc method","   * @name bundler.default:default#htmlTags","   * @methodOf bundler.default:default","   * @function","   * @description","   * Function called by view.js to build the view HTML","   *","   *","   * @param {String} type Either start/js/css","   * @param {Boolean} pack Pack with resolveAssetLink ?","   * @returns {[String]} List of script tag strings","   */","  function htmlTags(type,pack) {","    var dests;","","    // jshint validthis:true","    if (type === 'start') {","      return ['<script>' + this.module('start').map(function(value) { return value.content; }).join('\\n') + '</script>'];","    }","","    if (pack) {","      dests = { urls: {} };","      // jshint validthis:true","      dests.urls[type] = resolveAssetLink(this.client, type);","      return [ htmlTag[type](dests) ];","    } else {","      // jshint validthis:true","      var entries = this.entries(type);","      dests = this.dests;","      return entries.map(function(entry) {","        return htmlTag[type](dests,entry);","      });","    }","  }","","  /**","   * @ngdoc method","   * @name bundler.default:default#wrapCode","   * @methodOf bundler.default:default","   * @function","   * @description","   * Before client-side code is sent to the browser any file which is NOT a library (e.g. /client/code/libs)","   * is wrapped in a module wrapper (to keep vars local and allow you to require() one file in another).","   *","   * The 'system' directory is a special case - any module placed in this dir will not have a leading slash","   *","   * @param {String} assetType js/css/tmpl","   * @param {Object} systemAssets Collection of libs, modules, initCode","   * @returns {[AssetEntry]} List of output entries","   */","  function wrapCode(code, entry, opts) {","    var pathAry = entry.file.split('/');","","    // Don't touch the code if it's in a 'libs' directory","    if (pathAry.indexOf('libs') >= 0) { //TODO [code,libs] & options.dirs.libs location","      return code;","    }","","    // if it's configured in excludes, return raw code","    if (pathAry.indexOf('entry.js') === -1 && options && options.browserifyExcludePaths) {","      for(var i, p; (p = options.browserifyExcludePaths[i]); ++i) {","        if ( entry.file.split( p )[0] === '' ) {","          return code;","        }","      }","    }","","    var last = pathAry[pathAry.length-1],","      modPath,","      extPos = last.lastIndexOf('.');","    if (extPos > -1) {","      pathAry[pathAry.length-1] = last.substring(0,extPos);","    }","","    //TODO configurable system locations with array instead of string","    // Don't add a leading slash if this is a 'system' module","    if (entry.file.indexOf(options.dirs['system'].substring(1)) === 0) { //TODO [code,system] & improve test to allow parallel system dir","      // Take everything after the /system/ part of the path","      modPath = pathAry.slice(pathAry.indexOf('system')+1).join('/');","    } else {","","      // Otherwise treat as a regular module","      modPath = pathAry.join('/');","","      // Work out namespace for module","      if (opts.pathPrefix) {","","        // Ignore any filenames in the path","        if (opts.pathPrefix.indexOf('.') > 0) {","          var sp = opts.pathPrefix.split('/');","          sp.pop();","          opts.pathPrefix = sp.join('/');","        }","        modPath = '/' + path.substr(opts.pathPrefix.length + 1);","      } else {","        modPath = '/' + modPath;","      }","    }","    return ss.bundler.wrapModule(modPath, code);","  }","","  function UpdateCachedDevAssets() {","    var url = 'assets/'+this.client.name+'/'+this.client.id+'.html';","    view(ss, this.client, options, function(content) {","      ss.http.cached.set(url, content, 'text/html; charset=utf-8');","    });","","    var common = {","      constants: this.constants(),","      locals: this.locals(),","      client: this.client.name,","      clientId: this.client.id","    };","","    this.entries('css').forEach(function(entry) {","      this.asset(entry, common, function(output) {","        url = 'assets/'+this.client.name+'/'+this.client.id+'.css?_='+entry.file;","        ss.http.cached.set(url, output, 'text/css; charset=utf-8');","      }.bind(this));","    },this);","","    var modules = {};","","    this.entries('js').forEach(function(entry) {","      if (entry.type === 'mod') {","        this.module(entry.file).forEach(function(mod) {","          modules[entry.file] = modules[entry.file] || [];","          modules[entry.file].push(mod.content);","        });","      } else {","        this.asset(entry, common, function(output) {","          url = 'assets/'+this.client.name+'/'+this.client.id+'.js?_='+entry.file;","          ss.http.cached.set(url, output, 'text/js; charset=utf-8');","        }.bind(this));","      }","    },this);","","    for(var n in modules) {","      var output = modules[n].join('\\n');","          url = 'assets/'+this.client.name+'/'+this.client.id+'.js?mod='+n;","      ss.http.cached.set(url, output, 'text/js; charset=utf-8');","    }","  }","","  /**","   * @ngdoc method","   * @name bundler.default:default#toMinifiedCSS","   * @methodOf bundler.default:default","   * @function","   * @description","   * Minify JavaScript using CleanCSS","   *","   * @param {Array} files Entries with file path and content to be minified","   * @returns {String} Minified content","   */","  function toMinifiedCSS(files) {","    return ss.bundler.minifyCSS(files);","  }","","  /**","   * @ngdoc method","   * @name bundler.default:default#toMinifiedJS","   * @methodOf bundler.default:default","   * @function","   * @description","   * Minify JavaScript using Uglify","   *","   * @param {Array} files Entries with file path and content to be minified","   * @returns {String} Minified content","   */","  function toMinifiedJS(files) {","    return ss.bundler.minifyJS(files);","  }","","};",""],"l":{"4":1,"10":1,"12":0,"13":0,"16":0,"17":0,"19":0,"20":0,"24":0,"25":0,"28":0,"29":0,"32":0,"33":0,"36":0,"41":1,"43":1,"74":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"87":0,"88":0,"90":0,"92":0,"93":0,"94":0,"95":0,"98":0,"101":0,"102":0,"104":0,"110":0,"116":0,"120":0,"126":1,"127":0,"130":0,"131":0,"132":0,"138":0,"139":0,"140":0,"142":0,"145":0,"172":1,"174":0,"175":0,"176":0,"192":1,"193":0,"198":0,"199":0,"201":0,"202":0,"204":0,"205":0,"207":0,"208":0,"209":0,"211":0,"216":0,"217":0,"221":0,"224":1,"225":0,"228":0,"229":0,"234":0,"235":0,"236":0,"237":0,"241":0,"244":1,"245":0,"248":0,"249":0,"254":0,"255":0,"256":0,"257":0,"261":0,"277":1,"278":0,"281":0,"282":0,"285":0,"286":0,"288":0,"289":0,"292":0,"293":0,"294":0,"295":0,"315":1,"316":0,"319":0,"320":0,"324":0,"325":0,"326":0,"327":0,"332":0,"335":0,"336":0,"341":0,"343":0,"347":0,"350":0,"353":0,"354":0,"355":0,"356":0,"358":0,"360":0,"363":0,"366":1,"367":0,"368":0,"369":0,"372":0,"379":0,"380":0,"381":0,"382":0,"386":0,"388":0,"389":0,"390":0,"391":0,"392":0,"395":0,"396":0,"397":0,"402":0,"403":0,"404":0,"405":0,"420":1,"421":0,"435":1,"436":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/view.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/view.js","s":{"1":1,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":17},"end":{"line":6,"column":51}}},"2":{"name":"templates","line":10,"loc":{"start":{"line":10,"column":2},"end":{"line":10,"column":23}}},"3":{"name":"(anonymous_3)","line":13,"loc":{"start":{"line":13,"column":44},"end":{"line":13,"column":59}}},"4":{"name":"headers","line":19,"loc":{"start":{"line":19,"column":2},"end":{"line":19,"column":21}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":54,"column":2}},"2":{"start":{"line":7,"column":2},"end":{"line":8,"column":39}},"3":{"start":{"line":10,"column":2},"end":{"line":17,"column":3}},"4":{"start":{"line":11,"column":4},"end":{"line":12,"column":20}},"5":{"start":{"line":13,"column":4},"end":{"line":15,"column":7}},"6":{"start":{"line":14,"column":6},"end":{"line":14,"column":31}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":18}},"8":{"start":{"line":19,"column":2},"end":{"line":32,"column":3}},"9":{"start":{"line":21,"column":4},"end":{"line":21,"column":20}},"10":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"11":{"start":{"line":25,"column":6},"end":{"line":25,"column":70}},"12":{"start":{"line":29,"column":4},"end":{"line":29,"column":67}},"13":{"start":{"line":31,"column":4},"end":{"line":31,"column":18}},"14":{"start":{"line":35,"column":2},"end":{"line":35,"column":47}},"15":{"start":{"line":38,"column":2},"end":{"line":38,"column":40}},"16":{"start":{"line":39,"column":2},"end":{"line":42,"column":3}},"17":{"start":{"line":40,"column":4},"end":{"line":40,"column":38}},"18":{"start":{"line":41,"column":4},"end":{"line":41,"column":15}},"19":{"start":{"line":45,"column":2},"end":{"line":52,"column":4}},"20":{"start":{"line":53,"column":2},"end":{"line":53,"column":84}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":4}},{"start":{"line":24,"column":4},"end":{"line":24,"column":4}}]},"2":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":2},"end":{"line":39,"column":2}},{"start":{"line":39,"column":2},"end":{"line":39,"column":2}}]}},"code":["// Client Views","// ------------","// Generates HTML output for each single-page view","'use strict';","","module.exports = function(ss, client, options, cb) {","  var templateEngine = require('./template_engine')(ss, options), //TODO why not use the one in client/index ?","      bundler = ss.bundler.get(client);","","  function templates() {","    var files = bundler.entries('tmpl'),","        output = [];","    templateEngine.generate(bundler, files, function(html) {","      return output.push(html);","    });","    return output;","  }","","  function headers() {","    // Return an array of headers. Order is important!","    var output = [];","","    // Send all CSS","    if (client.includes.css) {","      output = output.concat( bundler.htmlTags('css',!!client.pack) );","    }","","    // Send Application Code","    output = output.concat( bundler.htmlTags('js',!!client.pack) );","","    return output;","  }","","  // Add links to CSS and JS files","  var includes = headers().concat(templates());","","  // In future constants might be placed at beginning of headers","  var start = bundler.htmlTags('start');","  if (options.startInBundle) {","    includes = includes.concat(start);","    start = [];","  }","","  // Output HTML","  var htmlOptions = {","    constants: bundler.constants(),","    locals: bundler.locals(),","    headers: includes.join(''),","    tail: start.join(''),","    compress: options.packedAssets,","    filename: client.paths.view","  };","  return bundler.asset(bundler.entryFor('html',client.paths.view), htmlOptions, cb);","};",""],"l":{"6":1,"7":0,"10":1,"11":0,"13":0,"14":0,"16":0,"19":1,"21":0,"24":0,"25":0,"29":0,"31":0,"35":0,"38":0,"39":0,"40":0,"41":0,"45":0,"53":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/template_engine.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/template_engine.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":1,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0,0],"18":[0,0],"19":[0,0,0],"20":[0,0],"21":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":17},"end":{"line":16,"column":38}}},"2":{"name":"(anonymous_2)","line":58,"loc":{"start":{"line":58,"column":9},"end":{"line":58,"column":46}}},"3":{"name":"(anonymous_3)","line":66,"loc":{"start":{"line":66,"column":22},"end":{"line":66,"column":36}}},"4":{"name":"(anonymous_4)","line":76,"loc":{"start":{"line":76,"column":68},"end":{"line":76,"column":82}}},"5":{"name":"(anonymous_5)","line":91,"loc":{"start":{"line":91,"column":10},"end":{"line":91,"column":21}}},"6":{"name":"(anonymous_6)","line":93,"loc":{"start":{"line":93,"column":19},"end":{"line":93,"column":33}}},"7":{"name":"(anonymous_7)","line":94,"loc":{"start":{"line":94,"column":32},"end":{"line":94,"column":46}}},"8":{"name":"(anonymous_8)","line":102,"loc":{"start":{"line":102,"column":12},"end":{"line":102,"column":23}}},"9":{"name":"(anonymous_9)","line":125,"loc":{"start":{"line":125,"column":14},"end":{"line":125,"column":43}}},"10":{"name":"(anonymous_10)","line":131,"loc":{"start":{"line":131,"column":27},"end":{"line":131,"column":42}}},"11":{"name":"(anonymous_11)","line":146,"loc":{"start":{"line":146,"column":27},"end":{"line":146,"column":44}}},"12":{"name":"(anonymous_12)","line":159,"loc":{"start":{"line":159,"column":11},"end":{"line":159,"column":25}}},"13":{"name":"selectEngine","line":169,"loc":{"start":{"line":169,"column":2},"end":{"line":169,"column":27}}},"14":{"name":"wrapTemplate","line":181,"loc":{"start":{"line":181,"column":2},"end":{"line":181,"column":85}}},"15":{"name":"suggestedId","line":203,"loc":{"start":{"line":203,"column":2},"end":{"line":203,"column":43}}}},"statementMap":{"1":{"start":{"line":10,"column":0},"end":{"line":10,"column":18}},"2":{"start":{"line":12,"column":0},"end":{"line":13,"column":33}},"3":{"start":{"line":16,"column":0},"end":{"line":214,"column":2}},"4":{"start":{"line":17,"column":2},"end":{"line":17,"column":16}},"5":{"start":{"line":20,"column":2},"end":{"line":20,"column":82}},"6":{"start":{"line":22,"column":2},"end":{"line":165,"column":4}},"7":{"start":{"line":59,"column":6},"end":{"line":61,"column":7}},"8":{"start":{"line":60,"column":8},"end":{"line":60,"column":21}},"9":{"start":{"line":62,"column":6},"end":{"line":64,"column":7}},"10":{"start":{"line":63,"column":8},"end":{"line":63,"column":22}},"11":{"start":{"line":66,"column":6},"end":{"line":74,"column":9}},"12":{"start":{"line":67,"column":8},"end":{"line":69,"column":9}},"13":{"start":{"line":68,"column":10},"end":{"line":68,"column":21}},"14":{"start":{"line":70,"column":8},"end":{"line":72,"column":9}},"15":{"start":{"line":71,"column":10},"end":{"line":71,"column":82}},"16":{"start":{"line":73,"column":8},"end":{"line":73,"column":64}},"17":{"start":{"line":76,"column":6},"end":{"line":79,"column":9}},"18":{"start":{"line":77,"column":8},"end":{"line":78,"column":87}},"19":{"start":{"line":80,"column":6},"end":{"line":80,"column":17}},"20":{"start":{"line":81,"column":6},"end":{"line":85,"column":7}},"21":{"start":{"line":82,"column":8},"end":{"line":82,"column":42}},"22":{"start":{"line":84,"column":8},"end":{"line":84,"column":47}},"23":{"start":{"line":86,"column":6},"end":{"line":89,"column":9}},"24":{"start":{"line":92,"column":6},"end":{"line":92,"column":31}},"25":{"start":{"line":93,"column":6},"end":{"line":98,"column":9}},"26":{"start":{"line":94,"column":8},"end":{"line":97,"column":11}},"27":{"start":{"line":95,"column":10},"end":{"line":95,"column":44}},"28":{"start":{"line":96,"column":10},"end":{"line":96,"column":38}},"29":{"start":{"line":99,"column":6},"end":{"line":99,"column":29}},"30":{"start":{"line":103,"column":6},"end":{"line":103,"column":22}},"31":{"start":{"line":126,"column":6},"end":{"line":126,"column":28}},"32":{"start":{"line":127,"column":6},"end":{"line":127,"column":25}},"33":{"start":{"line":128,"column":6},"end":{"line":130,"column":7}},"34":{"start":{"line":129,"column":8},"end":{"line":129,"column":15}},"35":{"start":{"line":131,"column":6},"end":{"line":163,"column":9}},"36":{"start":{"line":133,"column":8},"end":{"line":133,"column":62}},"37":{"start":{"line":135,"column":8},"end":{"line":135,"column":22}},"38":{"start":{"line":136,"column":8},"end":{"line":138,"column":9}},"39":{"start":{"line":137,"column":10},"end":{"line":137,"column":84}},"40":{"start":{"line":140,"column":8},"end":{"line":143,"column":10}},"41":{"start":{"line":145,"column":8},"end":{"line":162,"column":11}},"42":{"start":{"line":148,"column":10},"end":{"line":148,"column":126}},"43":{"start":{"line":149,"column":10},"end":{"line":149,"column":30}},"44":{"start":{"line":152,"column":10},"end":{"line":158,"column":11}},"45":{"start":{"line":153,"column":12},"end":{"line":153,"column":40}},"46":{"start":{"line":154,"column":12},"end":{"line":156,"column":13}},"47":{"start":{"line":155,"column":14},"end":{"line":155,"column":40}},"48":{"start":{"line":157,"column":12},"end":{"line":157,"column":30}},"49":{"start":{"line":160,"column":10},"end":{"line":160,"column":54}},"50":{"start":{"line":161,"column":10},"end":{"line":161,"column":72}},"51":{"start":{"line":169,"column":2},"end":{"line":179,"column":3}},"52":{"start":{"line":170,"column":4},"end":{"line":170,"column":35}},"53":{"start":{"line":171,"column":4},"end":{"line":171,"column":53}},"54":{"start":{"line":173,"column":4},"end":{"line":175,"column":5}},"55":{"start":{"line":174,"column":6},"end":{"line":174,"column":20}},"56":{"start":{"line":176,"column":4},"end":{"line":178,"column":5}},"57":{"start":{"line":177,"column":6},"end":{"line":177,"column":43}},"58":{"start":{"line":181,"column":2},"end":{"line":198,"column":3}},"59":{"start":{"line":182,"column":4},"end":{"line":182,"column":15}},"60":{"start":{"line":183,"column":4},"end":{"line":183,"column":16}},"61":{"start":{"line":186,"column":4},"end":{"line":188,"column":5}},"62":{"start":{"line":187,"column":6},"end":{"line":187,"column":39}},"63":{"start":{"line":191,"column":4},"end":{"line":193,"column":5}},"64":{"start":{"line":192,"column":6},"end":{"line":192,"column":35}},"65":{"start":{"line":196,"column":4},"end":{"line":196,"column":125}},"66":{"start":{"line":197,"column":4},"end":{"line":197,"column":27}},"67":{"start":{"line":203,"column":2},"end":{"line":213,"column":3}},"68":{"start":{"line":204,"column":4},"end":{"line":206,"column":5}},"69":{"start":{"line":205,"column":6},"end":{"line":205,"column":52}},"70":{"start":{"line":207,"column":4},"end":{"line":207,"column":11}},"71":{"start":{"line":208,"column":4},"end":{"line":208,"column":24}},"72":{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},"73":{"start":{"line":210,"column":6},"end":{"line":210,"column":15}},"74":{"start":{"line":212,"column":4},"end":{"line":212,"column":44}}},"branchMap":{"1":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":6},"end":{"line":59,"column":6}},{"start":{"line":59,"column":6},"end":{"line":59,"column":6}}]},"2":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":6},"end":{"line":62,"column":6}},{"start":{"line":62,"column":6},"end":{"line":62,"column":6}}]},"3":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":8},"end":{"line":67,"column":8}},{"start":{"line":67,"column":8},"end":{"line":67,"column":8}}]},"4":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":8},"end":{"line":70,"column":8}},{"start":{"line":70,"column":8},"end":{"line":70,"column":8}}]},"5":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":6},"end":{"line":81,"column":6}},{"start":{"line":81,"column":6},"end":{"line":81,"column":6}}]},"6":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":6},"end":{"line":128,"column":6}},{"start":{"line":128,"column":6},"end":{"line":128,"column":6}}]},"7":{"line":128,"type":"binary-expr","locations":[{"start":{"line":128,"column":12},"end":{"line":128,"column":17}},{"start":{"line":128,"column":21},"end":{"line":128,"column":37}}]},"8":{"line":133,"type":"binary-expr","locations":[{"start":{"line":133,"column":21},"end":{"line":133,"column":44}},{"start":{"line":133,"column":48},"end":{"line":133,"column":61}}]},"9":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":8},"end":{"line":136,"column":8}},{"start":{"line":136,"column":8},"end":{"line":136,"column":8}}]},"10":{"line":152,"type":"if","locations":[{"start":{"line":152,"column":10},"end":{"line":152,"column":10}},{"start":{"line":152,"column":10},"end":{"line":152,"column":10}}]},"11":{"line":154,"type":"if","locations":[{"start":{"line":154,"column":12},"end":{"line":154,"column":12}},{"start":{"line":154,"column":12},"end":{"line":154,"column":12}}]},"12":{"line":154,"type":"binary-expr","locations":[{"start":{"line":154,"column":16},"end":{"line":154,"column":31}},{"start":{"line":154,"column":35},"end":{"line":154,"column":48}}]},"13":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":4},"end":{"line":173,"column":4}},{"start":{"line":173,"column":4},"end":{"line":173,"column":4}}]},"14":{"line":176,"type":"if","locations":[{"start":{"line":176,"column":4},"end":{"line":176,"column":4}},{"start":{"line":176,"column":4},"end":{"line":176,"column":4}}]},"15":{"line":177,"type":"binary-expr","locations":[{"start":{"line":177,"column":26},"end":{"line":177,"column":34}},{"start":{"line":177,"column":38},"end":{"line":177,"column":41}}]},"16":{"line":186,"type":"if","locations":[{"start":{"line":186,"column":4},"end":{"line":186,"column":4}},{"start":{"line":186,"column":4},"end":{"line":186,"column":4}}]},"17":{"line":186,"type":"binary-expr","locations":[{"start":{"line":186,"column":8},"end":{"line":186,"column":18}},{"start":{"line":186,"column":22},"end":{"line":186,"column":43}},{"start":{"line":186,"column":47},"end":{"line":186,"column":64}}]},"18":{"line":191,"type":"if","locations":[{"start":{"line":191,"column":4},"end":{"line":191,"column":4}},{"start":{"line":191,"column":4},"end":{"line":191,"column":4}}]},"19":{"line":191,"type":"binary-expr","locations":[{"start":{"line":191,"column":9},"end":{"line":191,"column":28}},{"start":{"line":191,"column":32},"end":{"line":191,"column":53}},{"start":{"line":191,"column":58},"end":{"line":191,"column":71}}]},"20":{"line":204,"type":"if","locations":[{"start":{"line":204,"column":4},"end":{"line":204,"column":4}},{"start":{"line":204,"column":4},"end":{"line":204,"column":4}}]},"21":{"line":209,"type":"if","locations":[{"start":{"line":209,"column":4},"end":{"line":209,"column":4}},{"start":{"line":209,"column":4},"end":{"line":209,"column":4}}]}},"code":["// Template Engine","// ---------------","// By default client-side templates are concatted and sent to the client using the 'default' wrapper","// (a basic script tag with an ID generated from the file path). However you can easily specify your own template","// engine in your app.js file with the ss.client.templateEngine.use() command","// You may combine several types of template engines together - very useful when converting a site from one format","// to another, or experimenting with different template engines","'use strict';","","require('colors');","","var path = require('path'),","    client = require('./system');","","// Allow Template Engine to be configured","module.exports = function(ss,options) {","  var mods = [];","","  // Set the Default Engine - simply wraps each template in a <script> tag","  var defaultEngine = require('./template_engines/default')(ss.root,null,options);","","  return {","","    /**","     * @ngdoc function","     * @name client.templateEngine:templateEngine#use","     * @methodOf client.templateEngine:templateEngine","     * @param {string|Function} name - Built-in templating engine or function making the enging.","     * @param {Array} dirs - Directories to use template for (optional)","     * @param {Object} config - Config passed to the template engine.","     * @description","     * Use a template engine for the 'dirs' indicated (will use it on all '/' dirs within /client/templates by default)","     *","     * To make templates in `/client/ember-view` available in Ember.","     *","     *     ss.client.templateEngine.use('ember','./ember-view');","     *","     * To make templates in `/client/angular-view` available in Angular.","     *","     *     ss.client.templateEngine.use('angular','./angular-view');","     *","     * To make templates in `/client/templates/angular-view` available in Angular.","     *","     *     ss.client.templateEngine.use('angular','/angular-view');","     *","     * To make templates anywhere in `/client` available in Angular.","     *","     *     ss.client.templateEngine.use('angular','/');","     *","     * To make templates anywhere in `/client` available using a custom engine.","     *","     *     ss.client.templateEngine.use(require('custom-engine'));","     *","     * To make templates anywhere in `/client/custom` available using a custom engine.","     *","     *     ss.client.templateEngine.use(require('custom-engine'),'./custom');","     */","    use: function(nameOrModule, dirs, config) {","      if (!dirs) {","        dirs = ['.'];","      }","      if (!(dirs instanceof Array)) {","        dirs = [dirs];","      }","","      dirs = dirs.map(function(dir) {","        if (dir === '/') {","          return '.';","        }","        if (dir.charAt(0) === '/') {","          return path.join(options.dirs.templates.substring(1), dir.substring(1));","        }","        return path.join(options.dirs.client.substring(1), dir);","      });","","      var mod = ss.require(nameOrModule, 'client/template_engines', function(err) {","        throw new Error('The ' + err.id + ' template engine is not supported by SocketStream internally '+","          'or found in the project packages. Please pass a compatible module instead');","      });","      var engine;","      if (typeof mod === 'function') {","        engine = mod(ss, config, options);","      } else {","        engine = mod.init(ss, config, options);","      }","      return mods.push({","        engine: engine,","        dirs: dirs","      });","    },","    load: function() {","      var templateEngines = {};","      mods.forEach(function(mod) {","        return mod.dirs.forEach(function(dir) {","          templateEngines[dir] = mod.engine;","          return templateEngines[dir];","        });","      });","      return templateEngines;","    },","","    forget: function() {","      mods.length = 0;","    },","","    //TODO the default IDs for templates are best relative to client (or project root?)","","    /**","     * @ngdoc function","     * @name client.templateEngine:templateEngine#generate","     * @methodOf client.templateEngine:templateEngine","     * @param {Object} bundler - Bundler instance for client.","     * @param {Array} files - Entries for the templates to render markup for.","     * @param {Function} cb - Callback to receive the string output or Error object.","     * @description","     * Generate output (as a string) from Template Engines","     *","     *     function(out) {","     *       if (typeof out === 'string') {","     *       } else {","     *       // error object","     *       }","     *     }","     */","    generate: function(bundler, files, cb) {","      var prevEngine = null;","      var templates = [];","      if (!(files && files.length > 0)) {","        cb('');","      }","      return files.forEach(function(desc) {","        // Work out which template engine to use, based upon the path (TODO split file.sep)","        var engine = selectEngine(desc.file) || defaultEngine;","","        var formatter;","        if (engine.selectFormatter) {","          formatter = engine.selectFormatter(desc.file, ss.client.formatters, null);","        }","","        var opts = {","          constants: bundler.constants(),","          locals: bundler.locals()","        };","","        return bundler.format(desc,","          opts, formatter, function(output) {","","          templates.push(wrapTemplate(output, desc.file, ss.bundler.clientFilePath(desc), opts, options, engine, prevEngine));","          prevEngine = engine;","","          // Return if last template","          if (templates.length === files.length) {","            output = templates.join('');","            if (engine !== null && engine.suffix) {","              output += engine.suffix();","            }","            return cb(output);","          }","        }, function(err) {","          ss.log.clientIssue(client,options,err,desc);","          return cb('Couldn\\'t format ' + desc.file + err.userInfoHTML);","        });","      });","    }","  };","","  // private","","  function selectEngine(p) {","    var codePath = path.dirname(p); // remove the file name or child directory in recursive call","    var engine = ss.client.templateEngines[codePath];","","    if (engine) {","      return engine;","    }","    if (codePath !== '.') {","      return selectEngine(codePath || '.');","    }","  }","","  function wrapTemplate(template, pth, logicPath, opts, options, engine, prevEngine) {","    var output;","    output = [];","","    // If the template type has changed since the last template, include any closing suffix from the last engine used (if present)","    if (prevEngine && prevEngine !== engine && prevEngine.suffix) {","      output.push(prevEngine.suffix());","    }","","    // If this is the first template of this type and it has prefix, include it here","    if ((prevEngine === null || prevEngine !== engine) && engine.prefix) {","      output.push(engine.prefix());","    }","","    // Add main template output and return","    output.push(engine.process(template.toString(), logicPath, suggestedId(pth, options.dirs.templates.substring(1)), opts));","    return output.join('');","  }","","  // This should be on the bundler entries, so it can be tweaked by bundler before being used by the engine","  // Suggest an ID for this template based upon its path","  // 3rd party Template Engine modules are free to use their own naming conventions but we recommend using this where possible","  function suggestedId(pth, templatesPath) {","    if (pth.indexOf(templatesPath) === 0) {","      pth = pth.substring(templatesPath.length + 1);","    }","    var sp;","    sp = pth.split('.');","    if (pth.indexOf('.') > 0) {","      sp.pop();","    }","    return sp.join('.').replace(/\\//g, '-');","  }","};","",""],"l":{"10":1,"12":1,"16":1,"17":1,"20":1,"22":1,"59":0,"60":0,"62":0,"63":0,"66":0,"67":0,"68":0,"70":0,"71":0,"73":0,"76":0,"77":0,"80":0,"81":0,"82":0,"84":0,"86":0,"92":0,"93":0,"94":0,"95":0,"96":0,"99":0,"103":0,"126":0,"127":0,"128":0,"129":0,"131":0,"133":0,"135":0,"136":0,"137":0,"140":0,"145":0,"148":0,"149":0,"152":0,"153":0,"154":0,"155":0,"157":0,"160":0,"161":0,"169":1,"170":0,"171":0,"173":0,"174":0,"176":0,"177":0,"181":1,"182":0,"183":0,"186":0,"187":0,"191":0,"192":0,"196":0,"197":0,"203":1,"204":0,"205":0,"207":0,"208":0,"209":0,"210":0,"212":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/template_engines/default.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/template_engines/default.js","s":{"1":1,"2":1,"3":0},"b":{},"f":{"1":1,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":17},"end":{"line":6,"column":28}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":13},"end":{"line":9,"column":42}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":13,"column":2}},"2":{"start":{"line":7,"column":2},"end":{"line":12,"column":4}},"3":{"start":{"line":10,"column":6},"end":{"line":10,"column":89}}},"branchMap":{},"code":["// Default Engine produces standard <script> tags which can be used with jQuery Templates and uncompiled","// Hogan/Mustache templates among many others.","// Note all templates are prefixed with 'tmpl-' to prevent conflicts with DOM IDs in your application","'use strict';","","module.exports = function() {","  return {","    name: 'Default',","    process: function(template, path, id) {","      return '<script id=\"tmpl-' + id + '\" type=\"text/x-tmpl\">' + template + '</script>';","    }","  };","};",""],"l":{"6":1,"7":1,"10":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters.js","s":{"1":1,"2":1,"3":1,"4":1,"5":4,"6":4,"7":4,"8":0,"9":0,"10":0,"11":4,"12":0,"13":4,"14":4,"15":4,"16":4,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":4,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},"b":{"1":[4,4],"2":[0,0,4],"3":[0,0]},"f":{"1":1,"2":4,"3":0,"4":0,"5":0,"6":0,"7":0,"8":4,"9":0,"10":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":17},"end":{"line":13,"column":38}}},"2":{"name":"(anonymous_2)","line":25,"loc":{"start":{"line":25,"column":9},"end":{"line":25,"column":40}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":65},"end":{"line":36,"column":79}}},"4":{"name":"(anonymous_4)","line":47,"loc":{"start":{"line":47,"column":10},"end":{"line":47,"column":21}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":19},"end":{"line":49,"column":34}}},"6":{"name":"(anonymous_6)","line":50,"loc":{"start":{"line":50,"column":38},"end":{"line":50,"column":59}}},"7":{"name":"(anonymous_7)","line":57,"loc":{"start":{"line":57,"column":12},"end":{"line":57,"column":23}}},"8":{"name":"addCall","line":62,"loc":{"start":{"line":62,"column":2},"end":{"line":62,"column":30}}},"9":{"name":"(anonymous_9)","line":63,"loc":{"start":{"line":63,"column":21},"end":{"line":63,"column":53}}},"10":{"name":"(anonymous_10)","line":65,"loc":{"start":{"line":65,"column":39},"end":{"line":65,"column":56}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":52}},"2":{"start":{"line":13,"column":0},"end":{"line":75,"column":2}},"3":{"start":{"line":14,"column":2},"end":{"line":14,"column":16}},"4":{"start":{"line":15,"column":2},"end":{"line":60,"column":4}},"5":{"start":{"line":26,"column":6},"end":{"line":26,"column":20}},"6":{"start":{"line":27,"column":6},"end":{"line":27,"column":28}},"7":{"start":{"line":28,"column":6},"end":{"line":43,"column":7}},"8":{"start":{"line":30,"column":10},"end":{"line":30,"column":66}},"9":{"start":{"line":31,"column":10},"end":{"line":31,"column":29}},"10":{"start":{"line":32,"column":10},"end":{"line":32,"column":16}},"11":{"start":{"line":36,"column":10},"end":{"line":39,"column":13}},"12":{"start":{"line":37,"column":12},"end":{"line":38,"column":88}},"13":{"start":{"line":40,"column":10},"end":{"line":40,"column":47}},"14":{"start":{"line":41,"column":10},"end":{"line":41,"column":34}},"15":{"start":{"line":42,"column":10},"end":{"line":42,"column":16}},"16":{"start":{"line":45,"column":6},"end":{"line":45,"column":34}},"17":{"start":{"line":48,"column":6},"end":{"line":48,"column":27}},"18":{"start":{"line":49,"column":6},"end":{"line":53,"column":9}},"19":{"start":{"line":50,"column":8},"end":{"line":52,"column":11}},"20":{"start":{"line":51,"column":10},"end":{"line":51,"column":39}},"21":{"start":{"line":54,"column":6},"end":{"line":54,"column":89}},"22":{"start":{"line":55,"column":6},"end":{"line":55,"column":25}},"23":{"start":{"line":58,"column":6},"end":{"line":58,"column":22}},"24":{"start":{"line":62,"column":2},"end":{"line":74,"column":3}},"25":{"start":{"line":63,"column":4},"end":{"line":73,"column":6}},"26":{"start":{"line":64,"column":6},"end":{"line":72,"column":7}},"27":{"start":{"line":65,"column":8},"end":{"line":68,"column":17}},"28":{"start":{"line":66,"column":10},"end":{"line":67,"column":40}},"29":{"start":{"line":66,"column":44},"end":{"line":66,"column":62}},"30":{"start":{"line":67,"column":17},"end":{"line":67,"column":38}},"31":{"start":{"line":71,"column":8},"end":{"line":71,"column":25}}},"branchMap":{"1":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":15},"end":{"line":27,"column":21}},{"start":{"line":27,"column":25},"end":{"line":27,"column":27}}]},"2":{"line":28,"type":"switch","locations":[{"start":{"line":29,"column":8},"end":{"line":32,"column":16}},{"start":{"line":34,"column":8},"end":{"line":34,"column":24}},{"start":{"line":35,"column":8},"end":{"line":42,"column":16}}]},"3":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":10},"end":{"line":66,"column":10}},{"start":{"line":66,"column":10},"end":{"line":66,"column":10}}]}},"code":["// Code Formatters","// ---------------","// Loads default code formatters and presents an API for loading custom formatters","'use strict';","var debug = require('debug')('socketstream:client');","","/**"," * @ngdoc service"," * @name client.formatters:formatters"," * @description"," * Formatter registry"," */","module.exports = function(ss,options) {","  var mods = [];","  return {","    /**","     * @ngdoc method","     * @name client.formatters:formatters#add","     * @methodOf client.formatters:formatters","     * @function","     * Define a formatter for client asset (JS/CSS/HTML) rendering","     * @param {string|object} nameOrModule the formatter object or name","     * @param {object} config parameters configuring the formatter","     */","    add: function(nameOrModule, config) {","      var formatter;","      config = config || {};","      switch(typeof nameOrModule) {","        case 'object':","          formatter = nameOrModule.init(ss.root, config, options);","          addCall(formatter);","          break;","","        case 'function':","        case 'string':","          var mod = ss.require(nameOrModule, 'client/formatters',function(err) {","            throw new Error('The \"'+err.id+'\" formatter is not supported by '+","                    'SocketStream internally. Please pass a compatible module instead');","          });","          formatter = mod(ss, config, options);","          addCall(formatter,true);","          break;","      }","","      return mods.push(formatter);","    },","    load: function() {","      var byExtension = {};","      mods.forEach(function (mod) {","        return mod.extensions.forEach(function (extension) {","          byExtension[extension] = mod;","        });","      });","      debug('Formatters supported by extension: %s', Object.keys(byExtension).join(','));","      return byExtension;","    },","    forget: function() {","      mods.length = 0;","    }","  };","","  function addCall(formatter) {","    formatter.call = function(path,options,cb,errCb) {","      try{","        formatter.compile(path,options,function(result) {","          if (typeof result === 'string') { return cb(result); }","          else { return errCb(result); }","        },errCb);","      }","      catch(ex) {","        return errCb(ex);","      }","    };","  }","};",""],"l":{"5":1,"13":1,"14":1,"15":1,"26":4,"27":4,"28":4,"30":0,"31":0,"32":0,"36":4,"37":0,"40":4,"41":4,"42":4,"45":4,"48":0,"49":0,"50":0,"51":0,"54":0,"55":0,"58":0,"62":1,"63":4,"64":0,"65":0,"66":0,"67":0,"71":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/javascript.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/javascript.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0},"b":{},"f":{"1":1,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":30}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":13},"end":{"line":13,"column":41}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":23}},"2":{"start":{"line":8,"column":0},"end":{"line":19,"column":2}},"3":{"start":{"line":9,"column":2},"end":{"line":18,"column":4}},"4":{"start":{"line":14,"column":6},"end":{"line":14,"column":54}},"5":{"start":{"line":16,"column":6},"end":{"line":16,"column":47}}},"branchMap":{},"code":["'use strict';","","var fs = require('fs');","","/**"," * Javascript formatter"," */","module.exports = function(ss) {","  return {","    extensions: ['js'],","    assetType: 'js',","    contentType: 'text/javascript; charset=utf-8',","    compile: function(path, options, cb) {","      ss.log.trace('Compiling plain JS',path,options);","      //TODO if no file, return error object","      return cb(fs.readFileSync(path, 'utf8'));","    }","  };","};",""],"l":{"3":1,"8":1,"9":1,"14":0,"16":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/css.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/css.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0},"b":{},"f":{"1":1,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":30}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":13},"end":{"line":13,"column":42}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":23}},"2":{"start":{"line":8,"column":0},"end":{"line":19,"column":2}},"3":{"start":{"line":9,"column":2},"end":{"line":18,"column":4}},"4":{"start":{"line":14,"column":6},"end":{"line":14,"column":55}},"5":{"start":{"line":16,"column":6},"end":{"line":16,"column":47}}},"branchMap":{},"code":["'use strict';","","var fs = require('fs');","","/**"," * Plain CSS Formatter"," */","module.exports = function(ss) {","  return {","    extensions: ['css'],","    assetType: 'css',","    contentType: 'text/css',","    compile: function (path, options, cb) {","      ss.log.trace('Compiling plain CSS',path,options);","      //TODO if no file, return error object","      return cb(fs.readFileSync(path, 'utf8'));","    }","  };","};",""],"l":{"3":1,"8":1,"9":1,"14":0,"16":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/html.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/html.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":1,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":30}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":13},"end":{"line":13,"column":41}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":23}},"2":{"start":{"line":8,"column":0},"end":{"line":27,"column":2}},"3":{"start":{"line":9,"column":2},"end":{"line":26,"column":4}},"4":{"start":{"line":14,"column":6},"end":{"line":14,"column":56}},"5":{"start":{"line":15,"column":6},"end":{"line":15,"column":16}},"6":{"start":{"line":16,"column":6},"end":{"line":16,"column":44}},"7":{"start":{"line":20,"column":6},"end":{"line":23,"column":7}},"8":{"start":{"line":21,"column":8},"end":{"line":21,"column":65}},"9":{"start":{"line":22,"column":8},"end":{"line":22,"column":66}},"10":{"start":{"line":24,"column":6},"end":{"line":24,"column":23}}},"branchMap":{"1":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":6},"end":{"line":20,"column":6}},{"start":{"line":20,"column":6},"end":{"line":20,"column":6}}]},"2":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":10},"end":{"line":20,"column":17}},{"start":{"line":20,"column":21},"end":{"line":20,"column":36}}]}},"code":["'use strict';","","var fs = require('fs');","","/**"," * Plain HTML Formatter"," */","module.exports = function(ss) {","  return {","    extensions: ['html'],","    assetType: 'html',","    contentType: 'text/html',","    compile: function(path, options, cb) {","      ss.log.trace('Compiling plain HTML',path,options);","      var input;","      input = fs.readFileSync(path, 'utf8');","      //TODO if no file, return error object","","      // If passing optional headers for main view","      if (options && options.headers) {","        input = input.replace('<SocketStream>', options.headers);","        input = input.replace('<SocketStream/>', options.headers);","      }","      return cb(input);","    }","  };","};",""],"l":{"3":1,"8":1,"9":1,"14":0,"15":0,"16":0,"20":0,"21":0,"22":0,"24":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/map.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/map.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0},"b":{},"f":{"1":1,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":17},"end":{"line":13,"column":30}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":13},"end":{"line":19,"column":41}}}},"statementMap":{"1":{"start":{"line":11,"column":0},"end":{"line":11,"column":23}},"2":{"start":{"line":13,"column":0},"end":{"line":26,"column":2}},"3":{"start":{"line":15,"column":2},"end":{"line":24,"column":4}},"4":{"start":{"line":20,"column":6},"end":{"line":20,"column":55}},"5":{"start":{"line":22,"column":6},"end":{"line":22,"column":47}}},"branchMap":{},"code":["// JS Minmap formatter","//","// courtesy of Waxolunist (gh)","//","'use strict';","","","","// Dependencies","//","var fs = require('fs');","","module.exports = function(ss) {","","  return {","    extensions: ['map'],","    assetType: 'js',","    contentType: 'application/json',","    compile: function(path, options, cb) {","      ss.log.trace('Compiling plain MAP',path,options);","      //TODO if no file, return error object","      return cb(fs.readFileSync(path, 'utf8'));","    }","  };","","};",""],"l":{"11":1,"13":1,"15":1,"20":0,"22":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/tasks/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/tasks/index.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":2,"38":2,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":1,"49":0,"50":1,"51":2,"52":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":2,"9":0,"10":0,"11":0,"12":0,"13":2},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":39}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":25},"end":{"line":10,"column":39}}},"3":{"name":"(anonymous_3)","line":22,"loc":{"start":{"line":22,"column":10},"end":{"line":22,"column":25}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":16},"end":{"line":52,"column":30}}},"5":{"name":"(anonymous_5)","line":54,"loc":{"start":{"line":54,"column":25},"end":{"line":54,"column":42}}},"6":{"name":"(anonymous_6)","line":67,"loc":{"start":{"line":67,"column":12},"end":{"line":67,"column":23}}},"7":{"name":"(anonymous_7)","line":71,"loc":{"start":{"line":71,"column":12},"end":{"line":71,"column":23}}},"8":{"name":"(anonymous_8)","line":77,"loc":{"start":{"line":77,"column":9},"end":{"line":77,"column":24}}},"9":{"name":"(anonymous_9)","line":82,"loc":{"start":{"line":82,"column":11},"end":{"line":82,"column":33}}},"10":{"name":"doneIfAllDone","line":86,"loc":{"start":{"line":86,"column":6},"end":{"line":86,"column":34}}},"11":{"name":"(anonymous_11)","line":96,"loc":{"start":{"line":96,"column":8},"end":{"line":96,"column":19}}},"12":{"name":"task","line":102,"loc":{"start":{"line":102,"column":2},"end":{"line":102,"column":38}}},"13":{"name":"defaultTask","line":106,"loc":{"start":{"line":106,"column":2},"end":{"line":106,"column":45}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":6,"column":38}},"2":{"start":{"line":8,"column":0},"end":{"line":112,"column":2}},"3":{"start":{"line":10,"column":2},"end":{"line":19,"column":5}},"4":{"start":{"line":11,"column":4},"end":{"line":13,"column":5}},"5":{"start":{"line":12,"column":6},"end":{"line":12,"column":20}},"6":{"start":{"line":14,"column":4},"end":{"line":18,"column":5}},"7":{"start":{"line":15,"column":6},"end":{"line":15,"column":32}},"8":{"start":{"line":17,"column":6},"end":{"line":17,"column":67}},"9":{"start":{"line":21,"column":2},"end":{"line":100,"column":4}},"10":{"start":{"line":23,"column":6},"end":{"line":23,"column":42}},"11":{"start":{"line":24,"column":6},"end":{"line":24,"column":54}},"12":{"start":{"line":25,"column":6},"end":{"line":30,"column":7}},"13":{"start":{"line":26,"column":8},"end":{"line":26,"column":31}},"14":{"start":{"line":28,"column":8},"end":{"line":28,"column":37}},"15":{"start":{"line":29,"column":8},"end":{"line":29,"column":29}},"16":{"start":{"line":31,"column":6},"end":{"line":31,"column":53}},"17":{"start":{"line":32,"column":6},"end":{"line":35,"column":7}},"18":{"start":{"line":33,"column":8},"end":{"line":33,"column":29}},"19":{"start":{"line":34,"column":8},"end":{"line":34,"column":27}},"20":{"start":{"line":36,"column":6},"end":{"line":38,"column":7}},"21":{"start":{"line":37,"column":8},"end":{"line":37,"column":39}},"22":{"start":{"line":39,"column":6},"end":{"line":41,"column":7}},"23":{"start":{"line":40,"column":8},"end":{"line":40,"column":37}},"24":{"start":{"line":43,"column":6},"end":{"line":43,"column":18}},"25":{"start":{"line":53,"column":6},"end":{"line":53,"column":64}},"26":{"start":{"line":54,"column":6},"end":{"line":63,"column":9}},"27":{"start":{"line":55,"column":8},"end":{"line":62,"column":9}},"28":{"start":{"line":56,"column":10},"end":{"line":56,"column":52}},"29":{"start":{"line":57,"column":15},"end":{"line":62,"column":9}},"30":{"start":{"line":58,"column":10},"end":{"line":58,"column":59}},"31":{"start":{"line":59,"column":10},"end":{"line":59,"column":52}},"32":{"start":{"line":61,"column":10},"end":{"line":61,"column":61}},"33":{"start":{"line":64,"column":6},"end":{"line":64,"column":19}},"34":{"start":{"line":68,"column":6},"end":{"line":68,"column":26}},"35":{"start":{"line":72,"column":6},"end":{"line":74,"column":7}},"36":{"start":{"line":73,"column":8},"end":{"line":73,"column":37}},"37":{"start":{"line":78,"column":6},"end":{"line":78,"column":46}},"38":{"start":{"line":79,"column":6},"end":{"line":79,"column":18}},"39":{"start":{"line":83,"column":6},"end":{"line":83,"column":47}},"40":{"start":{"line":84,"column":6},"end":{"line":84,"column":18}},"41":{"start":{"line":86,"column":6},"end":{"line":94,"column":7}},"42":{"start":{"line":87,"column":8},"end":{"line":89,"column":9}},"43":{"start":{"line":88,"column":10},"end":{"line":88,"column":49}},"44":{"start":{"line":91,"column":8},"end":{"line":93,"column":9}},"45":{"start":{"line":92,"column":10},"end":{"line":92,"column":20}},"46":{"start":{"line":97,"column":6},"end":{"line":97,"column":52}},"47":{"start":{"line":98,"column":6},"end":{"line":98,"column":18}},"48":{"start":{"line":102,"column":2},"end":{"line":104,"column":3}},"49":{"start":{"line":103,"column":4},"end":{"line":103,"column":43}},"50":{"start":{"line":106,"column":2},"end":{"line":110,"column":3}},"51":{"start":{"line":107,"column":4},"end":{"line":109,"column":5}},"52":{"start":{"line":108,"column":6},"end":{"line":108,"column":45}}},"branchMap":{"1":{"line":11,"type":"if","locations":[{"start":{"line":11,"column":4},"end":{"line":11,"column":4}},{"start":{"line":11,"column":4},"end":{"line":11,"column":4}}]},"2":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":4},"end":{"line":14,"column":4}},{"start":{"line":14,"column":4},"end":{"line":14,"column":4}}]},"3":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":6},"end":{"line":25,"column":6}},{"start":{"line":25,"column":6},"end":{"line":25,"column":6}}]},"4":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":10},"end":{"line":25,"column":27}},{"start":{"line":25,"column":31},"end":{"line":25,"column":61}},{"start":{"line":25,"column":65},"end":{"line":25,"column":92}}]},"5":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":6},"end":{"line":32,"column":6}},{"start":{"line":32,"column":6},"end":{"line":32,"column":6}}]},"6":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":6},"end":{"line":36,"column":6}},{"start":{"line":36,"column":6},"end":{"line":36,"column":6}}]},"7":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":6},"end":{"line":39,"column":6}},{"start":{"line":39,"column":6},"end":{"line":39,"column":6}}]},"8":{"line":53,"type":"cond-expr","locations":[{"start":{"line":53,"column":23},"end":{"line":53,"column":35}},{"start":{"line":53,"column":36},"end":{"line":53,"column":63}}]},"9":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":8},"end":{"line":55,"column":8}},{"start":{"line":55,"column":8},"end":{"line":55,"column":8}}]},"10":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":15},"end":{"line":57,"column":15}},{"start":{"line":57,"column":15},"end":{"line":57,"column":15}}]},"11":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":8},"end":{"line":87,"column":8}},{"start":{"line":87,"column":8},"end":{"line":87,"column":8}}]},"12":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":8},"end":{"line":91,"column":8}},{"start":{"line":91,"column":8},"end":{"line":91,"column":8}}]},"13":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":12},"end":{"line":91,"column":35}},{"start":{"line":91,"column":39},"end":{"line":91,"column":43}}]},"14":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":4},"end":{"line":107,"column":4}},{"start":{"line":107,"column":4},"end":{"line":107,"column":4}}]}},"code":["'use strict';","","var log = require('../utils/log'),","    liveReload = require('./live_reload'),","    Orchestrator = require('orchestrator'),","    orchestrator = new Orchestrator();","","module.exports = function(ss, options) {","","  orchestrator.on('err', function(err) {","    if (typeof err === 'object') {","      err = err.err;","    }","    if (ss.env === 'production') {","      ss.log.error(err.message); //TODO production error handling strategy","    } else {","      ss.log.error('tasks failed, %s: %s', err.message, err.stack);","    }","  });","","  return {","    plan: function(args) {","      var plan = {}, httpServer = args[0];","      plan.targets = Array.prototype.slice.call(args);","      if (args.length === 0 || typeof httpServer === 'string' || httpServer instanceof Array) {","        plan.httpServer = null;","      } else {","        plan.httpServer = httpServer;","        plan.targets.shift();","      }","      var last = plan.targets[plan.targets.length-1];","      if (typeof last === 'function') {","        plan.callback = last;","        plan.targets.pop();","      }","      if (plan.targets[0] instanceof Array) {","        plan.targets = plan.targets[0];","      }","      if (plan.targets.length === 0) {","        plan.targets.push('default');","      }","","      return plan;","    },","","    add: task,","    defaultTask: defaultTask,","","    defaults: require('./defaults')(ss, options, orchestrator),","    orchestrator:orchestrator, // this is mostly for testing","","    _packTasks: function(all) {","      var tasks = all? ['load-api']:['pack-prepare','load-api'];","      ss.bundler.forEach(function(bundler){","        if (all) {","          tasks.push(bundler.client.name + ':pack');","        } else if (bundler.packNeeded) {","          tasks.push(bundler.client.name + ':pack-needed');","          tasks.push(bundler.client.name + ':pack');","        } else {","          tasks.push(bundler.client.name + ':pack-unneeded');","        }","      });","      return tasks;","    },","","    unload: function() {","      liveReload.unload();","    },","","    forget: function() {","      for(var n in orchestrator.tasks) {","        delete orchestrator.tasks[n];","      }","    },","","    use: function(gulp) {","      orchestrator = this.orchestrator = gulp;","      return this;","    },","","    start: function(tasks, done) {","      orchestrator.start(tasks, doneIfAllDone);","      return this;","","      function doneIfAllDone(err) {","        if (err) {","          log.error('!'.red, 'task failed', err);","        }","","        if (!orchestrator.isRunning && done) {","          done(err);","        }","      }","    },","    on: function() {","      orchestrator.on.apply(orchestrator,arguments);","      return this;","    }","  };","","  function task(name, dependents, fn) {","    orchestrator.add(name, dependents, fn);","  }","","  function defaultTask(name, dependents, fn) {","    if (!orchestrator.hasTask(name)) {","      orchestrator.add(name, dependents, fn);","    }","  }","","};",""],"l":{"3":1,"8":1,"10":1,"11":0,"12":0,"14":0,"15":0,"17":0,"21":1,"23":0,"24":0,"25":0,"26":0,"28":0,"29":0,"31":0,"32":0,"33":0,"34":0,"36":0,"37":0,"39":0,"40":0,"43":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"61":0,"64":0,"68":0,"72":0,"73":0,"78":2,"79":2,"83":0,"84":0,"86":1,"87":0,"88":0,"91":0,"92":0,"97":0,"98":0,"102":1,"103":0,"106":1,"107":2,"108":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/tasks/live_reload.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/tasks/live_reload.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":17},"end":{"line":11,"column":39}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":19},"end":{"line":16,"column":30}}},"3":{"name":"(anonymous_3)","line":31,"loc":{"start":{"line":31,"column":20},"end":{"line":31,"column":35}}},"4":{"name":"(anonymous_4)","line":35,"loc":{"start":{"line":35,"column":23},"end":{"line":35,"column":38}}},"5":{"name":"(anonymous_5)","line":39,"loc":{"start":{"line":39,"column":23},"end":{"line":39,"column":38}}},"6":{"name":"(anonymous_6)","line":43,"loc":{"start":{"line":43,"column":22},"end":{"line":43,"column":38}}},"7":{"name":"(anonymous_7)","line":48,"loc":{"start":{"line":48,"column":24},"end":{"line":48,"column":35}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":18}},"2":{"start":{"line":8,"column":0},"end":{"line":9,"column":52}},"3":{"start":{"line":11,"column":0},"end":{"line":46,"column":2}},"4":{"start":{"line":13,"column":2},"end":{"line":14,"column":40}},"5":{"start":{"line":16,"column":2},"end":{"line":25,"column":7}},"6":{"start":{"line":17,"column":4},"end":{"line":17,"column":33}},"7":{"start":{"line":18,"column":4},"end":{"line":18,"column":30}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":18}},"9":{"start":{"line":20,"column":4},"end":{"line":23,"column":5}},"10":{"start":{"line":21,"column":6},"end":{"line":21,"column":25}},"11":{"start":{"line":22,"column":6},"end":{"line":22,"column":69}},"12":{"start":{"line":24,"column":4},"end":{"line":24,"column":20}},"13":{"start":{"line":27,"column":2},"end":{"line":30,"column":5}},"14":{"start":{"line":31,"column":2},"end":{"line":34,"column":5}},"15":{"start":{"line":32,"column":4},"end":{"line":32,"column":28}},"16":{"start":{"line":33,"column":4},"end":{"line":33,"column":37}},"17":{"start":{"line":35,"column":2},"end":{"line":38,"column":5}},"18":{"start":{"line":36,"column":4},"end":{"line":36,"column":28}},"19":{"start":{"line":37,"column":4},"end":{"line":37,"column":39}},"20":{"start":{"line":39,"column":2},"end":{"line":42,"column":5}},"21":{"start":{"line":40,"column":4},"end":{"line":40,"column":28}},"22":{"start":{"line":41,"column":4},"end":{"line":41,"column":39}},"23":{"start":{"line":43,"column":2},"end":{"line":45,"column":5}},"24":{"start":{"line":44,"column":4},"end":{"line":44,"column":58}},"25":{"start":{"line":48,"column":0},"end":{"line":53,"column":2}},"26":{"start":{"line":49,"column":2},"end":{"line":52,"column":3}},"27":{"start":{"line":50,"column":4},"end":{"line":50,"column":20}},"28":{"start":{"line":51,"column":4},"end":{"line":51,"column":19}}},"branchMap":{"1":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":42},"end":{"line":22,"column":59}},{"start":{"line":22,"column":63},"end":{"line":22,"column":66}}]},"2":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":2},"end":{"line":49,"column":2}},{"start":{"line":49,"column":2},"end":{"line":49,"column":2}}]}},"code":["// Live Reload","// -----------","// Detects changes in client files and sends an event to connected browsers instructing them to refresh the page","'use strict';","","require('colors');","","var watcher,","    debug = require('debug')('socketstream:reload');","","module.exports = function(ss, options) {","","  var pathlib = require('path'),","      chokidar = ss.require('chokidar');","","  var watchDirs = (function() {","    var _i, _len, _ref, _results;","    _ref = options.liveReload;","    _results = [];","    for (_i = 0, _len = _ref.length; _i < _len; _i++) {","      var dir = _ref[_i];","      _results.push(pathlib.join(ss.root, options.dirs[dir] || dir));","    }","    return _results;","  })();","","  watcher = chokidar.watch(watchDirs, {","    ignoreInitial: true,","    ignored: /(\\/\\.|~$)/","  });","  watcher.on('add', function(path) {","    debug('added: %s',path);","    return ss.livereload.added(path);","  });","  watcher.on('change', function(path) {","    debug('added: %s',path);","    return ss.livereload.changed(path);","  });","  watcher.on('unlink', function(path) {","    debug('added: %s',path);","    return ss.livereload.removed(path);","  });","  watcher.on('error', function(error) {","    return ss.log.error('✎'.red, ('Error: ' + error).red);","  });","};","","module.exports.unload = function() {","  if (watcher) {","    watcher.close();","    watcher = null;","  }","};",""],"l":{"6":1,"8":1,"11":1,"13":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"24":0,"27":0,"31":0,"32":0,"33":0,"35":0,"36":0,"37":0,"39":0,"40":0,"41":0,"43":0,"44":0,"48":1,"49":0,"50":0,"51":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/tasks/defaults.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/tasks/defaults.js","s":{"1":1,"2":1,"3":1,"4":2,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":1,"81":0,"82":0,"83":1,"84":0,"85":0,"86":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},"f":{"1":1,"2":2,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":17},"end":{"line":11,"column":53}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":9},"end":{"line":13,"column":20}}},"3":{"name":"(anonymous_3)","line":14,"loc":{"start":{"line":14,"column":34},"end":{"line":14,"column":45}}},"4":{"name":"(anonymous_4)","line":16,"loc":{"start":{"line":16,"column":50},"end":{"line":16,"column":65}}},"5":{"name":"(anonymous_5)","line":20,"loc":{"start":{"line":20,"column":31},"end":{"line":20,"column":42}}},"6":{"name":"(anonymous_6)","line":24,"loc":{"start":{"line":24,"column":54},"end":{"line":24,"column":65}}},"7":{"name":"(anonymous_7)","line":33,"loc":{"start":{"line":33,"column":21},"end":{"line":33,"column":31}}},"8":{"name":"(anonymous_8)","line":37,"loc":{"start":{"line":37,"column":100},"end":{"line":37,"column":121}}},"9":{"name":"serveOndemand","line":47,"loc":{"start":{"line":47,"column":28},"end":{"line":47,"column":57}}},"10":{"name":"(anonymous_10)","line":55,"loc":{"start":{"line":55,"column":25},"end":{"line":55,"column":36}}},"11":{"name":"(anonymous_11)","line":61,"loc":{"start":{"line":61,"column":45},"end":{"line":61,"column":56}}},"12":{"name":"(anonymous_12)","line":68,"loc":{"start":{"line":68,"column":34},"end":{"line":68,"column":45}}},"13":{"name":"(anonymous_13)","line":71,"loc":{"start":{"line":71,"column":25},"end":{"line":71,"column":43}}},"14":{"name":"(anonymous_14)","line":76,"loc":{"start":{"line":76,"column":34},"end":{"line":76,"column":45}}},"15":{"name":"(anonymous_15)","line":80,"loc":{"start":{"line":80,"column":34},"end":{"line":80,"column":45}}},"16":{"name":"(anonymous_16)","line":102,"loc":{"start":{"line":102,"column":23},"end":{"line":102,"column":41}}},"17":{"name":"(anonymous_17)","line":104,"loc":{"start":{"line":104,"column":44},"end":{"line":104,"column":55}}},"18":{"name":"(anonymous_18)","line":108,"loc":{"start":{"line":108,"column":42},"end":{"line":108,"column":53}}},"19":{"name":"(anonymous_19)","line":112,"loc":{"start":{"line":112,"column":43},"end":{"line":112,"column":58}}},"20":{"name":"(anonymous_20)","line":127,"loc":{"start":{"line":127,"column":54},"end":{"line":127,"column":69}}},"21":{"name":"(anonymous_21)","line":131,"loc":{"start":{"line":131,"column":53},"end":{"line":131,"column":68}}},"22":{"name":"(anonymous_22)","line":136,"loc":{"start":{"line":136,"column":55},"end":{"line":136,"column":70}}},"23":{"name":"(anonymous_23)","line":137,"loc":{"start":{"line":137,"column":42},"end":{"line":137,"column":57}}},"24":{"name":"(anonymous_24)","line":156,"loc":{"start":{"line":156,"column":35},"end":{"line":156,"column":46}}},"25":{"name":"mkdir","line":162,"loc":{"start":{"line":162,"column":0},"end":{"line":162,"column":20}}},"26":{"name":"deleteOldFiles","line":168,"loc":{"start":{"line":168,"column":0},"end":{"line":168,"column":35}}},"27":{"name":"(anonymous_27)","line":169,"loc":{"start":{"line":169,"column":51},"end":{"line":169,"column":70}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":9,"column":42}},"2":{"start":{"line":11,"column":0},"end":{"line":160,"column":2}},"3":{"start":{"line":13,"column":2},"end":{"line":159,"column":4}},"4":{"start":{"line":14,"column":4},"end":{"line":14,"column":49}},"5":{"start":{"line":16,"column":4},"end":{"line":18,"column":7}},"6":{"start":{"line":17,"column":6},"end":{"line":17,"column":66}},"7":{"start":{"line":20,"column":4},"end":{"line":22,"column":7}},"8":{"start":{"line":21,"column":6},"end":{"line":21,"column":16}},"9":{"start":{"line":24,"column":4},"end":{"line":43,"column":7}},"10":{"start":{"line":25,"column":6},"end":{"line":25,"column":42}},"11":{"start":{"line":28,"column":6},"end":{"line":42,"column":7}},"12":{"start":{"line":29,"column":8},"end":{"line":41,"column":9}},"13":{"start":{"line":30,"column":10},"end":{"line":30,"column":51}},"14":{"start":{"line":32,"column":10},"end":{"line":40,"column":11}},"15":{"start":{"line":33,"column":12},"end":{"line":38,"column":14}},"16":{"start":{"line":34,"column":14},"end":{"line":35,"column":34}},"17":{"start":{"line":37,"column":14},"end":{"line":37,"column":138}},"18":{"start":{"line":37,"column":123},"end":{"line":37,"column":134}},"19":{"start":{"line":39,"column":12},"end":{"line":39,"column":39}},"20":{"start":{"line":47,"column":4},"end":{"line":66,"column":7}},"21":{"start":{"line":48,"column":6},"end":{"line":48,"column":46}},"22":{"start":{"line":50,"column":6},"end":{"line":50,"column":60}},"23":{"start":{"line":53,"column":6},"end":{"line":53,"column":48}},"24":{"start":{"line":55,"column":6},"end":{"line":65,"column":9}},"25":{"start":{"line":56,"column":8},"end":{"line":58,"column":9}},"26":{"start":{"line":57,"column":10},"end":{"line":57,"column":17}},"27":{"start":{"line":59,"column":8},"end":{"line":59,"column":49}},"28":{"start":{"line":60,"column":8},"end":{"line":64,"column":9}},"29":{"start":{"line":61,"column":12},"end":{"line":63,"column":15}},"30":{"start":{"line":62,"column":14},"end":{"line":62,"column":31}},"31":{"start":{"line":68,"column":4},"end":{"line":74,"column":7}},"32":{"start":{"line":69,"column":6},"end":{"line":69,"column":16}},"33":{"start":{"line":71,"column":6},"end":{"line":73,"column":9}},"34":{"start":{"line":72,"column":8},"end":{"line":72,"column":40}},"35":{"start":{"line":76,"column":4},"end":{"line":78,"column":7}},"36":{"start":{"line":77,"column":6},"end":{"line":77,"column":30}},"37":{"start":{"line":80,"column":4},"end":{"line":85,"column":7}},"38":{"start":{"line":81,"column":6},"end":{"line":84,"column":7}},"39":{"start":{"line":82,"column":8},"end":{"line":82,"column":36}},"40":{"start":{"line":83,"column":8},"end":{"line":83,"column":38}},"41":{"start":{"line":87,"column":4},"end":{"line":87,"column":25}},"42":{"start":{"line":89,"column":4},"end":{"line":93,"column":5}},"43":{"start":{"line":90,"column":6},"end":{"line":90,"column":78}},"44":{"start":{"line":91,"column":11},"end":{"line":93,"column":5}},"45":{"start":{"line":92,"column":6},"end":{"line":92,"column":38}},"46":{"start":{"line":94,"column":4},"end":{"line":96,"column":5}},"47":{"start":{"line":95,"column":6},"end":{"line":95,"column":38}},"48":{"start":{"line":98,"column":4},"end":{"line":98,"column":30}},"49":{"start":{"line":100,"column":4},"end":{"line":100,"column":42}},"50":{"start":{"line":102,"column":4},"end":{"line":152,"column":7}},"51":{"start":{"line":103,"column":6},"end":{"line":103,"column":37}},"52":{"start":{"line":104,"column":6},"end":{"line":107,"column":9}},"53":{"start":{"line":105,"column":8},"end":{"line":106,"column":43}},"54":{"start":{"line":108,"column":6},"end":{"line":111,"column":9}},"55":{"start":{"line":109,"column":8},"end":{"line":110,"column":60}},"56":{"start":{"line":112,"column":6},"end":{"line":125,"column":9}},"57":{"start":{"line":113,"column":8},"end":{"line":113,"column":35}},"58":{"start":{"line":114,"column":8},"end":{"line":114,"column":86}},"59":{"start":{"line":117,"column":8},"end":{"line":117,"column":42}},"60":{"start":{"line":118,"column":8},"end":{"line":118,"column":33}},"61":{"start":{"line":119,"column":8},"end":{"line":121,"column":9}},"62":{"start":{"line":120,"column":10},"end":{"line":120,"column":44}},"63":{"start":{"line":122,"column":8},"end":{"line":122,"column":15}},"64":{"start":{"line":127,"column":6},"end":{"line":129,"column":9}},"65":{"start":{"line":128,"column":8},"end":{"line":128,"column":83}},"66":{"start":{"line":131,"column":6},"end":{"line":134,"column":9}},"67":{"start":{"line":133,"column":8},"end":{"line":133,"column":81}},"68":{"start":{"line":136,"column":6},"end":{"line":146,"column":9}},"69":{"start":{"line":137,"column":8},"end":{"line":145,"column":11}},"70":{"start":{"line":138,"column":10},"end":{"line":138,"column":59}},"71":{"start":{"line":139,"column":10},"end":{"line":139,"column":96}},"72":{"start":{"line":142,"column":10},"end":{"line":142,"column":64}},"73":{"start":{"line":143,"column":10},"end":{"line":143,"column":37}},"74":{"start":{"line":144,"column":10},"end":{"line":144,"column":17}},"75":{"start":{"line":147,"column":6},"end":{"line":151,"column":28}},"76":{"start":{"line":154,"column":4},"end":{"line":154,"column":54}},"77":{"start":{"line":155,"column":4},"end":{"line":155,"column":56}},"78":{"start":{"line":156,"column":4},"end":{"line":158,"column":7}},"79":{"start":{"line":157,"column":6},"end":{"line":157,"column":104}},"80":{"start":{"line":162,"column":0},"end":{"line":166,"column":1}},"81":{"start":{"line":163,"column":2},"end":{"line":165,"column":3}},"82":{"start":{"line":164,"column":4},"end":{"line":164,"column":29}},"83":{"start":{"line":168,"column":0},"end":{"line":173,"column":1}},"84":{"start":{"line":169,"column":2},"end":{"line":171,"column":5}},"85":{"start":{"line":170,"column":4},"end":{"line":170,"column":57}},"86":{"start":{"line":172,"column":2},"end":{"line":172,"column":119}}},"branchMap":{"1":{"line":17,"type":"binary-expr","locations":[{"start":{"line":17,"column":29},"end":{"line":17,"column":50}},{"start":{"line":17,"column":54},"end":{"line":17,"column":58}}]},"2":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":8},"end":{"line":29,"column":8}},{"start":{"line":29,"column":8},"end":{"line":29,"column":8}}]},"3":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":10},"end":{"line":32,"column":10}},{"start":{"line":32,"column":10},"end":{"line":32,"column":10}}]},"4":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":14},"end":{"line":32,"column":28}},{"start":{"line":32,"column":32},"end":{"line":32,"column":61}}]},"5":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":29},"end":{"line":50,"column":50}},{"start":{"line":50,"column":54},"end":{"line":50,"column":58}}]},"6":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":8},"end":{"line":56,"column":8}},{"start":{"line":56,"column":8},"end":{"line":56,"column":8}}]},"7":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":8},"end":{"line":60,"column":8}},{"start":{"line":60,"column":8},"end":{"line":60,"column":8}}]},"8":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":6},"end":{"line":81,"column":6}},{"start":{"line":81,"column":6},"end":{"line":81,"column":6}}]},"9":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":4},"end":{"line":89,"column":4}},{"start":{"line":89,"column":4},"end":{"line":89,"column":4}}]},"10":{"line":90,"type":"cond-expr","locations":[{"start":{"line":90,"column":49},"end":{"line":90,"column":59}},{"start":{"line":90,"column":60},"end":{"line":90,"column":76}}]},"11":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":11},"end":{"line":91,"column":11}},{"start":{"line":91,"column":11},"end":{"line":91,"column":11}}]},"12":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":4},"end":{"line":94,"column":4}},{"start":{"line":94,"column":4},"end":{"line":94,"column":4}}]},"13":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":8},"end":{"line":119,"column":8}},{"start":{"line":119,"column":8},"end":{"line":119,"column":8}}]},"14":{"line":119,"type":"binary-expr","locations":[{"start":{"line":119,"column":14},"end":{"line":119,"column":34}},{"start":{"line":119,"column":38},"end":{"line":119,"column":71}}]},"15":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":2},"end":{"line":163,"column":2}},{"start":{"line":163,"column":2},"end":{"line":163,"column":2}}]},"16":{"line":172,"type":"binary-expr","locations":[{"start":{"line":172,"column":9},"end":{"line":172,"column":32}},{"start":{"line":172,"column":36},"end":{"line":172,"column":118}}]}},"code":["'use strict';","","var fs = require('fs'),","    path = require('path'),","    debug = require('debug')('socketstream'),","    socketstream = require('../socketstream'),","    log = require('../utils/log'),","    view = require('../client/view'),","    liveReload = require('./live_reload');","","module.exports = function(ss, options, orchestrator) {","","  return function() {","    ss.defaultTask('application', function() {});","","    ss.defaultTask('start-server',['application'],function(done) {","      socketstream.ws.listen(ss.http.settings.port || 3000, done);","    });","","    ss.defaultTask('load-api', function() {","      ss.load();","    });","","    ss.defaultTask('test-socketstream', ['load-api'], function() {","      var sessionID = ss.session.create();","","      // jshint loopfunc:true","      for (var id in ss.server.responders) {","        if (ss.server.responders.hasOwnProperty(id)) {","          var responder = ss.server.responders[id];","","          if (responder.name && responder.interfaces.internal) {","            var fn = function(){","              var args = Array.prototype.slice.call(arguments),","                  cb = args.pop();","","              return responder.interfaces.internal(args, {sessionId: sessionID, transport: 'test'}, function(err, params){ cb(params); });","            };","            ss.add(responder.name, fn); // interesting, potential or hack?","          }","        }","      }","    });","","    // task: ondemand","    // Listen out for requests to async load new assets","    ss.defaultTask('serve', function serveOndemand(done) {","      ss.bundler.updateCachedOndemandAssets(); //TODO pipe to cache","","      socketstream.ws.listen(ss.http.settings.port || 3000);","","      // Send server instance to any registered modules (e.g. console)","      ss.events.emit('server:start', ss.server);","","      process.on('exit', function() {","        if (done) {","          done();","        }","        ss.events.emit('server:stop', ss.server);","        if (orchestrator.hasTask('stop-server')) {","            orchestrator.start('stop-server',function() {","              ss.server = null;","            });","        }","      });","    });","","    ss.defaultTask('live-assets', function() {","      ss.load();","      //TODO ss.started promise to wait for. resolved when streaming server is started","      ss.bundler.forEach(function(bundler) {","        bundler.updateCachedDevAssets();","      });","    });","","    ss.defaultTask('live-reload', function() {","      liveReload(ss, options);","    });","","    ss.defaultTask('stop-server', function() {","      if (ss.server.httServer) {","        ss.server.httServer.close(); //TODO do it on ss.ws","        debug('stopped http server.');","      }","    });","","    var defaultDeps = [];","","    if (options.packedAssets) {","      defaultDeps.push(options.packedAssets.all? 'pack-all':'pack-if-needed');","    } else if (!options.servePacked) {","      defaultDeps.push('live-assets');","    }","    if (options.liveReload) {","      defaultDeps.push('live-reload');","    }","    // if (httpServer)","    defaultDeps.push('serve');","","    ss.defaultTask('default',defaultDeps);","","    ss.bundler.forEach(function(bundler) {","      var name = bundler.client.name;","      ss.defaultTask(name+':pack-unneeded', function() {","        log.info('✓'.green, ('Serving client \\'' + name + '\\' using pre-packed assets (ID ' +","            bundler.client.id + ')').grey);","      });","      ss.defaultTask(name+':pack-needed', function() {","        log.info('!'.red, ('Unable to find pre-packed assets for \\'' +","            name + '\\'. All assets will be repacked').grey);","      });","      ss.defaultTask(name+':pack-prepare', function(done) {","        bundler.client.pack = true;","        log.info(('Pre-packing and minifying the \\'' + name + '\\' client...').yellow);","","        // Prepare folder","        mkdir(bundler.dests.containerDir); //TODO async","        mkdir(bundler.dests.dir);","        if (!(options.packedAssets && options.packedAssets.keepOldFiles)) {","          deleteOldFiles(bundler.dests.dir);","        }","        done();","","        //TODO add the tasks to an async queue that can be asserted on in tests","      });","","      ss.defaultTask(bundler.client.name+':pack-css', function(done) {","        ss.bundler.packAssetSet('css', bundler.client, bundler.toMinifiedCSS,done);","      });","","      ss.defaultTask(bundler.client.name+':pack-js', function(done) {","        //TODO wait for ss.loaded promise to have socketstream-transport defined","        ss.bundler.packAssetSet('js', bundler.client, bundler.toMinifiedJS,done);","      });","","      ss.defaultTask(bundler.client.name+':pack-html', function(done) {","        view(ss, bundler.client, options, function(html) {","          fs.writeFileSync(bundler.dests.paths.html, html);","          ss.log.info('✓'.green, 'Created and cached HTML file ' + bundler.dests.relPaths.html);","","          //TODO perhaps put this in pack-completion target","          log.info(' ','Bundler',bundler.client.name,'packed.');","          bundler.packNeeded = false;","          done();","        });","      });","      ss.defaultTask(name+':pack', [","        name+':pack-prepare',","        name+':pack-css',","        name+':pack-js',","        name+':pack-html']);","    });","","    ss.defaultTask('pack-all', this._packTasks(true));","    ss.defaultTask('pack-if-needed', this._packTasks());","    ss.defaultTask('pack-prepare', function() {","      log.info('i'.green, 'Attempting to find pre-packed assets... (force repack with SS_PACK=1)'.grey);","    });","  };","};","","function mkdir(dir) {","  if (!fs.existsSync(dir)) {","    return fs.mkdirSync(dir);","  }","}","","function deleteOldFiles(clientDir) {","  var filesDeleted = fs.readdirSync(clientDir).map(function(fileName) {","    return fs.unlinkSync(path.join(clientDir, fileName));","  });","  return filesDeleted.length > 1 && log.info('✓'.green, '' + filesDeleted.length + ' previous packaged files deleted');","}",""],"l":{"3":1,"11":1,"13":1,"14":2,"16":0,"17":0,"20":0,"21":0,"24":0,"25":0,"28":0,"29":0,"30":0,"32":0,"33":0,"34":0,"37":0,"39":0,"47":0,"48":0,"50":0,"53":0,"55":0,"56":0,"57":0,"59":0,"60":0,"61":0,"62":0,"68":0,"69":0,"71":0,"72":0,"76":0,"77":0,"80":0,"81":0,"82":0,"83":0,"87":0,"89":0,"90":0,"91":0,"92":0,"94":0,"95":0,"98":0,"100":0,"102":0,"103":0,"104":0,"105":0,"108":0,"109":0,"112":0,"113":0,"114":0,"117":0,"118":0,"119":0,"120":0,"122":0,"127":0,"128":0,"131":0,"133":0,"136":0,"137":0,"138":0,"139":0,"142":0,"143":0,"144":0,"147":0,"154":0,"155":0,"156":0,"157":0,"162":1,"163":0,"164":0,"168":1,"169":0,"170":0,"172":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/request/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/request/index.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0,0],"4":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":17},"end":{"line":10,"column":30}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":11},"end":{"line":17,"column":22}}},"3":{"name":"(anonymous_3)","line":21,"loc":{"start":{"line":21,"column":9},"end":{"line":21,"column":40}}},"4":{"name":"(anonymous_4)","line":23,"loc":{"start":{"line":23,"column":62},"end":{"line":23,"column":76}}},"5":{"name":"(anonymous_5)","line":38,"loc":{"start":{"line":38,"column":10},"end":{"line":38,"column":21}}}},"statementMap":{"1":{"start":{"line":10,"column":0},"end":{"line":55,"column":2}},"2":{"start":{"line":11,"column":2},"end":{"line":14,"column":25}},"3":{"start":{"line":16,"column":2},"end":{"line":54,"column":4}},"4":{"start":{"line":19,"column":6},"end":{"line":19,"column":35}},"5":{"start":{"line":22,"column":6},"end":{"line":22,"column":30}},"6":{"start":{"line":23,"column":6},"end":{"line":25,"column":13}},"7":{"start":{"line":24,"column":12},"end":{"line":24,"column":94}},"8":{"start":{"line":27,"column":6},"end":{"line":36,"column":7}},"9":{"start":{"line":28,"column":8},"end":{"line":28,"column":70}},"10":{"start":{"line":30,"column":8},"end":{"line":30,"column":54}},"11":{"start":{"line":32,"column":8},"end":{"line":33,"column":96}},"12":{"start":{"line":34,"column":8},"end":{"line":34,"column":28}},"13":{"start":{"line":35,"column":8},"end":{"line":35,"column":16}},"14":{"start":{"line":39,"column":6},"end":{"line":39,"column":46}},"15":{"start":{"line":40,"column":6},"end":{"line":43,"column":7}},"16":{"start":{"line":41,"column":8},"end":{"line":41,"column":27}},"17":{"start":{"line":42,"column":8},"end":{"line":42,"column":24}},"18":{"start":{"line":44,"column":6},"end":{"line":44,"column":22}},"19":{"start":{"line":45,"column":6},"end":{"line":51,"column":7}},"20":{"start":{"line":46,"column":8},"end":{"line":46,"column":39}},"21":{"start":{"line":47,"column":8},"end":{"line":50,"column":10}},"22":{"start":{"line":52,"column":6},"end":{"line":52,"column":20}}},"branchMap":{"1":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":15},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":29}}]},"2":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":17},"end":{"line":28,"column":42}},{"start":{"line":28,"column":46},"end":{"line":28,"column":49}},{"start":{"line":28,"column":53},"end":{"line":28,"column":69}}]},"3":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":28},"end":{"line":32,"column":42}},{"start":{"line":32,"column":46},"end":{"line":32,"column":65}},{"start":{"line":32,"column":69},"end":{"line":32,"column":71}}]},"4":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":6},"end":{"line":40,"column":6}},{"start":{"line":40,"column":6},"end":{"line":40,"column":6}}]}},"code":["// Request Responders","// ------------------","// Processes incoming requests regardless of transport (e.g. websocket, HTTP, method call from console)","// Each responder can expose a number of interfaces - e.g. Websocket, Console, and will only respond to incoming","// messages of it's type (e.g. 'rpc', 'events', etc)","// Responders can optionally choose to use the middleware stack provided","// The 'events' and 'rpc' responders are loaded by default, though even this can be overruled by calling clear()","'use strict';","","module.exports = function(ss) {","  var middleware = require('./middleware')(ss),","      responderCount = 0,","      responders = {},","      useDefaults = true;","","  return {","    clear: function() {","      //jshint -W093","      return (useDefaults = false);","    },","    add: function(nameOrModule, config) {","      config = config || null;","      var mod = ss.require(nameOrModule, 'request/responders',function(err) {","            throw new Error('Unable to find the \\''+err.id+'\\' Request Responder internally');","          });","","      try {","        var id = nameOrModule === 'events' && '0' || ++responderCount;","        //jshint -W093","        return (responders[id] = mod(id, config, ss));","      } catch (e) {","        var responderName = responders[id] && responders[id].name || '',","            err = new Error('Unable to initialize Request Responder \\'' + responderName + '\\'');","        err.stack = e.stack;","        throw e;","      }","    },","    load: function() {","      var middlewareStack = middleware.load();","      if (useDefaults) {","        this.add('events');","        this.add('rpc');","      }","      var output = {};","      for (var id in responders) {","        var responder = responders[id];","        output[id] = {","          name: responder.name,","          interfaces: responder.interfaces(middlewareStack)","        };","      }","      return output;","    }","  };","};",""],"l":{"10":1,"11":1,"16":1,"19":0,"22":0,"23":0,"24":0,"27":0,"28":0,"30":0,"32":0,"34":0,"35":0,"39":0,"40":0,"41":0,"42":0,"44":0,"45":0,"46":0,"47":0,"52":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/request/middleware/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/request/middleware/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0},"b":{"1":[0,0,0]},"f":{"1":1,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":17},"end":{"line":10,"column":30}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":10},"end":{"line":16,"column":21}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":8,"column":33}},"2":{"start":{"line":10,"column":0},"end":{"line":30,"column":2}},"3":{"start":{"line":12,"column":2},"end":{"line":12,"column":43}},"4":{"start":{"line":13,"column":2},"end":{"line":29,"column":4}},"5":{"start":{"line":18,"column":6},"end":{"line":18,"column":65}},"6":{"start":{"line":21,"column":6},"end":{"line":21,"column":85}},"7":{"start":{"line":24,"column":6},"end":{"line":26,"column":7}},"8":{"start":{"line":25,"column":8},"end":{"line":25,"column":31}},"9":{"start":{"line":27,"column":6},"end":{"line":27,"column":19}}},"branchMap":{"1":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":18},"end":{"line":21,"column":42}},{"start":{"line":21,"column":46},"end":{"line":21,"column":78}},{"start":{"line":21,"column":82},"end":{"line":21,"column":84}}]}},"code":["// Request Middleware","// ------------------","// Allows incoming requests to be pre-processed, transformed, or sent elsewhere","'use strict';","","var pathlib = require('path'),","    fs = require('fs'),","    apiTree = require('apitree');","","module.exports = function(ss) {","  // Load internal middleware","  var internal = require('./internal')(ss);","  return {","","    // Return API","    load: function() {","","      var customDir = pathlib.join(ss.root, 'server/middleware');","","      // Load custom middleware","      var stack = fs.existsSync(customDir) && apiTree.createApiTree(customDir) || {};","","      // Append internal/default middleware","      for (var k in internal) {","        stack[k] = internal[k];","      }","      return stack;","    }","  };","};",""],"l":{"6":1,"10":1,"12":1,"13":1,"18":0,"21":0,"24":0,"25":0,"27":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/request/middleware/internal.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/request/middleware/internal.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":30}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":11},"end":{"line":10,"column":27}}},"3":{"name":"(anonymous_3)","line":11,"loc":{"start":{"line":11,"column":13},"end":{"line":11,"column":47}}},"4":{"name":"(anonymous_4)","line":16,"loc":{"start":{"line":16,"column":13},"end":{"line":16,"column":31}}},"5":{"name":"(anonymous_5)","line":20,"loc":{"start":{"line":20,"column":13},"end":{"line":20,"column":47}}},"6":{"name":"(anonymous_6)","line":22,"loc":{"start":{"line":22,"column":70},"end":{"line":22,"column":92}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":36}},"2":{"start":{"line":8,"column":0},"end":{"line":40,"column":2}},"3":{"start":{"line":9,"column":2},"end":{"line":39,"column":4}},"4":{"start":{"line":11,"column":6},"end":{"line":14,"column":8}},"5":{"start":{"line":12,"column":8},"end":{"line":12,"column":87}},"6":{"start":{"line":13,"column":8},"end":{"line":13,"column":22}},"7":{"start":{"line":17,"column":6},"end":{"line":19,"column":7}},"8":{"start":{"line":18,"column":8},"end":{"line":18,"column":21}},"9":{"start":{"line":20,"column":6},"end":{"line":37,"column":8}},"10":{"start":{"line":21,"column":8},"end":{"line":36,"column":9}},"11":{"start":{"line":22,"column":10},"end":{"line":33,"column":13}},"12":{"start":{"line":23,"column":12},"end":{"line":23,"column":42}},"13":{"start":{"line":24,"column":12},"end":{"line":26,"column":13}},"14":{"start":{"line":25,"column":14},"end":{"line":25,"column":76}},"15":{"start":{"line":27,"column":12},"end":{"line":32,"column":13}},"16":{"start":{"line":28,"column":14},"end":{"line":28,"column":28}},"17":{"start":{"line":30,"column":14},"end":{"line":31,"column":120}},"18":{"start":{"line":35,"column":10},"end":{"line":35,"column":87}}},"branchMap":{"1":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":27},"end":{"line":12,"column":32}},{"start":{"line":12,"column":36},"end":{"line":12,"column":44}}]},"2":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":6},"end":{"line":17,"column":6}},{"start":{"line":17,"column":6},"end":{"line":17,"column":6}}]},"3":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":8}},{"start":{"line":21,"column":8},"end":{"line":21,"column":8}}]},"4":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":12},"end":{"line":24,"column":12}},{"start":{"line":24,"column":12},"end":{"line":24,"column":12}}]},"5":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":12},"end":{"line":27,"column":12}},{"start":{"line":27,"column":12},"end":{"line":27,"column":12}}]}},"code":["// Internal Request Middleware","// ---------------------------","// Internal middleware occupies the top-level namespace, i.e. does not contain any dots","'use strict';","","var colors = require('colors/safe');","","module.exports = function(ss) {","  return {","    debug: function(color) {","      return function(request, response, next) {","        ss.log.info(colors[color || 'yellow']('Debug incoming message >>\\n'), request);","        return next();","      };","    },","    session: function(options) {","      if (!options) {","        options = {};","      }","      return function(request, response, next) {","        if (request.sessionId) {","          return ss.session.find(request.sessionId, request.socketId, function(thisSession) {","            request.session = thisSession;","            if (options.debug) {","              ss.log.info(colors.yellow('Debug session >>\\n'), thisSession);","            }","            if (thisSession) {","              return next();","            } else {","              return ss.log.error(('! Error: Session ID ' + request.sessionId +","                ' not found. Use Redis to persist sessions between server restarts. Terminating incoming request').red);","            }","          });","        } else {","          throw new Error('Cannot load session. Request does not contain a sessionId');","        }","      };","    }","  };","};",""],"l":{"6":1,"8":1,"9":1,"11":0,"12":0,"13":0,"17":0,"18":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"27":0,"28":0,"30":0,"35":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/websocket/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/websocket/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":17},"end":{"line":12,"column":30}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":12},"end":{"line":26,"column":30}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":40},"end":{"line":32,"column":51}}},"4":{"name":"(anonymous_4)","line":41,"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":23}}},"5":{"name":"(anonymous_5)","line":42,"loc":{"start":{"line":42,"column":10},"end":{"line":42,"column":47}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":10,"column":7}},"2":{"start":{"line":12,"column":0},"end":{"line":58,"column":2}},"3":{"start":{"line":15,"column":2},"end":{"line":15,"column":54}},"4":{"start":{"line":17,"column":2},"end":{"line":57,"column":4}},"5":{"start":{"line":27,"column":6},"end":{"line":27,"column":16}},"6":{"start":{"line":28,"column":6},"end":{"line":28,"column":86}},"7":{"start":{"line":29,"column":6},"end":{"line":31,"column":7}},"8":{"start":{"line":30,"column":8},"end":{"line":30,"column":94}},"9":{"start":{"line":32,"column":6},"end":{"line":37,"column":9}},"10":{"start":{"line":33,"column":8},"end":{"line":33,"column":43}},"11":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"12":{"start":{"line":35,"column":10},"end":{"line":35,"column":22}},"13":{"start":{"line":43,"column":6},"end":{"line":43,"column":43}},"14":{"start":{"line":46,"column":6},"end":{"line":46,"column":76}},"15":{"start":{"line":49,"column":6},"end":{"line":52,"column":7}},"16":{"start":{"line":50,"column":8},"end":{"line":50,"column":39}},"17":{"start":{"line":51,"column":8},"end":{"line":51,"column":55}},"18":{"start":{"line":55,"column":6},"end":{"line":55,"column":27}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":6},"end":{"line":29,"column":6}},{"start":{"line":29,"column":6},"end":{"line":29,"column":6}}]},"2":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":34,"column":8}},{"start":{"line":34,"column":8},"end":{"line":34,"column":8}}]}},"code":["// Websocket Module","// ----------------","// Handles everything to do with the websocket transport and message responders","'use strict';","","var debug = require('debug')('socketstream'),","    EventEmitter2 = require('eventemitter2').EventEmitter2,","    emitter = new EventEmitter2({","      wildcard: true","    });","","module.exports = function(ss) {","","  // Return API","  var transport = require('./transport')(ss, emitter);","","  return {","    /**","     * @ngdoc service","     * @name http.index:index#listen","     * @methodOf http.index:index","     * @function","     * @description","     * Start the server listening to the port (same as Server.listen)","     */","    listen: function(port,cb) {","      ss.load();","      ss.log.info('Starting SocketStream %s in %s mode...'.green, ss.version, ss.env);","      if (Number(ss.version.split('.')[1]) % 2) {","        ss.log.info('This is an unstable version, some features will not be reliable'.yellow);","      }","      return transport.http.listen(port,function() {","        debug('started streaming server.');","        if (cb) {","          return cb();","        }","      });","    },","","    transport: transport,","    unload: function() {},","    load: function(responders, eventTransport) {","      var thisTransport = transport.load();","","      // Dispatch incoming events to websocket clients","      require('./event_dispatcher')(eventTransport, thisTransport, emitter);","","      // Listen to incoming requests and invoke server.request","      for (var id in responders) {","        var responder = responders[id];","        emitter.on(id, responder.interfaces.websocket);","      }","","      // Return active WS transport","      return thisTransport;","    }","  };","};",""],"l":{"6":1,"12":1,"15":1,"17":1,"27":0,"28":0,"29":0,"30":0,"32":0,"33":0,"34":0,"35":0,"43":0,"46":0,"49":0,"50":0,"51":0,"55":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/websocket/transport.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/websocket/transport.js","s":{"1":1,"2":1,"3":1,"4":6,"5":6,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"1":[0,6],"2":[0,6],"3":[0,0],"4":[0,0]},"f":{"1":1,"2":6,"3":6,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":39}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":12},"end":{"line":13,"column":15}}},"3":{"name":"(anonymous_3)","line":16,"loc":{"start":{"line":16,"column":10},"end":{"line":16,"column":13}}},"4":{"name":"(anonymous_4)","line":19,"loc":{"start":{"line":19,"column":9},"end":{"line":19,"column":37}}},"5":{"name":"(anonymous_5)","line":28,"loc":{"start":{"line":28,"column":10},"end":{"line":28,"column":21}}}},"statementMap":{"1":{"start":{"line":7,"column":0},"end":{"line":38,"column":2}},"2":{"start":{"line":8,"column":2},"end":{"line":10,"column":18}},"3":{"start":{"line":12,"column":2},"end":{"line":37,"column":4}},"4":{"start":{"line":14,"column":6},"end":{"line":14,"column":39}},"5":{"start":{"line":17,"column":6},"end":{"line":17,"column":37}},"6":{"start":{"line":20,"column":6},"end":{"line":20,"column":25}},"7":{"start":{"line":21,"column":6},"end":{"line":21,"column":29}},"8":{"start":{"line":30,"column":6},"end":{"line":30,"column":74}},"9":{"start":{"line":31,"column":6},"end":{"line":35,"column":7}},"10":{"start":{"line":32,"column":8},"end":{"line":32,"column":108}},"11":{"start":{"line":34,"column":8},"end":{"line":34,"column":57}}},"branchMap":{"1":{"line":14,"type":"cond-expr","locations":[{"start":{"line":14,"column":21},"end":{"line":14,"column":32}},{"start":{"line":14,"column":34},"end":{"line":14,"column":38}}]},"2":{"line":17,"type":"cond-expr","locations":[{"start":{"line":17,"column":21},"end":{"line":17,"column":30}},{"start":{"line":17,"column":32},"end":{"line":17,"column":36}}]},"3":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":15},"end":{"line":21,"column":18}},{"start":{"line":21,"column":22},"end":{"line":21,"column":28}}]},"4":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":6},"end":{"line":31,"column":6}},{"start":{"line":31,"column":6},"end":{"line":31,"column":6}}]}},"code":["// Websocket Transport","// -------------------","// Define the transport to carry all realtime requests","// Uses 'engineio' by default. See README to see how to configure it","'use strict';","","module.exports = function(ss, emitter) {","  var mid,","      active,","      config = {};","","  return {","    get http() {","      return active? active.http: null;","    },","    get ws() {","      return active? active.ws: null;","    },","    use: function(nameOrModule, cfg) {","      mid = nameOrModule;","      config = cfg || config;","","      // log warning","      // if (ss.require.resolve(nameOrModule, 'websocket/transports') == null) {","      //   throw new Error('Unable to find the \\'' + nameOrModule + '\\' websocket transport internally');","      // }","    },","    load: function() {","      //TODO error handle missing require from within the sockjs/engineio module","      var transport = ss.require(mid, 'websocket/transports', 'engineio');","      if (typeof transport !== 'function') {","        ss.log.error('Transport for \"'+mid+'\" must be a function(ss, emitter, config) default:', transport);","      } else {","        return (active = transport(ss, emitter, config));","      }","    }","  };","};",""],"l":{"7":1,"8":1,"12":1,"14":6,"17":6,"20":0,"21":0,"30":0,"31":0,"32":0,"34":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/express.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/express.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":28}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":15},"end":{"line":10,"column":26}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":5,"column":40}},"2":{"start":{"line":7,"column":0},"end":{"line":33,"column":2}},"3":{"start":{"line":8,"column":2},"end":{"line":8,"column":43}},"4":{"start":{"line":10,"column":2},"end":{"line":12,"column":4}},"5":{"start":{"line":11,"column":4},"end":{"line":11,"column":41}},"6":{"start":{"line":18,"column":2},"end":{"line":18,"column":30}},"7":{"start":{"line":20,"column":2},"end":{"line":30,"column":3}},"8":{"start":{"line":21,"column":4},"end":{"line":21,"column":43}},"9":{"start":{"line":23,"column":4},"end":{"line":23,"column":36}},"10":{"start":{"line":25,"column":4},"end":{"line":25,"column":33}},"11":{"start":{"line":32,"column":2},"end":{"line":32,"column":13}}},"branchMap":{"1":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":20,"column":2}},{"start":{"line":20,"column":2},"end":{"line":20,"column":2}}]}},"code":["// Entry point for app.js","'use strict';","","var ss = require('./lib/socketstream.js'),","    express = ss.api.require('express');","","module.exports = function() {","  var app = ss.http.middleware = express();","","  app.listen = function() {","    ss.ws.listen.apply(ss.ws, arguments);","  };","  /* TODO","  app.socketstream = function( fn(req,stream) )","","  app.stream = ss.http.stream;","  */","  app.stream = ss.http.stream;","","  if (ss.env === 'development') {","    app.set('views', ss.client.dirs.views);","    // Showing stack errors","    app.set('showStackError', true);","    // Disable views cache","    app.set('view cache', false);","","    // Environment dependent middleware","    // throws cannot find stack","    // ss.api.require('express-debug')(app, {/* settings */});","  }","","  return app;","};",""],"l":{"4":1,"7":1,"8":0,"10":0,"11":0,"18":0,"20":0,"21":0,"23":0,"25":0,"32":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/Gruntfile.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/Gruntfile.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":17},"end":{"line":3,"column":33}}},"2":{"name":"setVersion","line":134,"loc":{"start":{"line":134,"column":4},"end":{"line":134,"column":38}}},"3":{"name":"(anonymous_3)","line":139,"loc":{"start":{"line":139,"column":51},"end":{"line":139,"column":81}}},"4":{"name":"(anonymous_4)","line":170,"loc":{"start":{"line":170,"column":92},"end":{"line":170,"column":103}}},"5":{"name":"(anonymous_5)","line":174,"loc":{"start":{"line":174,"column":96},"end":{"line":174,"column":107}}},"6":{"name":"(anonymous_6)","line":189,"loc":{"start":{"line":189,"column":97},"end":{"line":189,"column":108}}},"7":{"name":"(anonymous_7)","line":205,"loc":{"start":{"line":205,"column":104},"end":{"line":205,"column":115}}},"8":{"name":"(anonymous_8)","line":215,"loc":{"start":{"line":215,"column":59},"end":{"line":215,"column":70}}},"9":{"name":"(anonymous_9)","line":218,"loc":{"start":{"line":218,"column":26},"end":{"line":218,"column":40}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":239,"column":1}},"2":{"start":{"line":6,"column":4},"end":{"line":6,"column":32}},"3":{"start":{"line":8,"column":4},"end":{"line":8,"column":55}},"4":{"start":{"line":9,"column":4},"end":{"line":9,"column":48}},"5":{"start":{"line":10,"column":4},"end":{"line":10,"column":46}},"6":{"start":{"line":11,"column":4},"end":{"line":11,"column":46}},"7":{"start":{"line":12,"column":4},"end":{"line":12,"column":43}},"8":{"start":{"line":13,"column":4},"end":{"line":13,"column":39}},"9":{"start":{"line":15,"column":4},"end":{"line":123,"column":7}},"10":{"start":{"line":126,"column":4},"end":{"line":126,"column":39}},"11":{"start":{"line":134,"column":4},"end":{"line":153,"column":5}},"12":{"start":{"line":135,"column":8},"end":{"line":138,"column":20}},"13":{"start":{"line":139,"column":8},"end":{"line":149,"column":11}},"14":{"start":{"line":140,"column":12},"end":{"line":140,"column":29}},"15":{"start":{"line":141,"column":12},"end":{"line":143,"column":13}},"16":{"start":{"line":142,"column":16},"end":{"line":142,"column":63}},"17":{"start":{"line":145,"column":12},"end":{"line":147,"column":13}},"18":{"start":{"line":146,"column":16},"end":{"line":146,"column":40}},"19":{"start":{"line":148,"column":12},"end":{"line":148,"column":40}},"20":{"start":{"line":150,"column":8},"end":{"line":150,"column":55}},"21":{"start":{"line":151,"column":8},"end":{"line":151,"column":41}},"22":{"start":{"line":152,"column":8},"end":{"line":152,"column":23}},"23":{"start":{"line":170,"column":4},"end":{"line":172,"column":7}},"24":{"start":{"line":171,"column":8},"end":{"line":171,"column":47}},"25":{"start":{"line":174,"column":4},"end":{"line":179,"column":7}},"26":{"start":{"line":175,"column":8},"end":{"line":178,"column":9}},"27":{"start":{"line":176,"column":12},"end":{"line":176,"column":84}},"28":{"start":{"line":177,"column":12},"end":{"line":177,"column":69}},"29":{"start":{"line":189,"column":4},"end":{"line":203,"column":7}},"30":{"start":{"line":190,"column":8},"end":{"line":191,"column":60}},"31":{"start":{"line":193,"column":8},"end":{"line":193,"column":66}},"32":{"start":{"line":194,"column":8},"end":{"line":196,"column":9}},"33":{"start":{"line":195,"column":12},"end":{"line":195,"column":114}},"34":{"start":{"line":198,"column":8},"end":{"line":198,"column":67}},"35":{"start":{"line":199,"column":8},"end":{"line":202,"column":9}},"36":{"start":{"line":200,"column":12},"end":{"line":200,"column":50}},"37":{"start":{"line":201,"column":12},"end":{"line":201,"column":64}},"38":{"start":{"line":205,"column":4},"end":{"line":213,"column":7}},"39":{"start":{"line":206,"column":8},"end":{"line":207,"column":34}},"40":{"start":{"line":209,"column":8},"end":{"line":209,"column":71}},"41":{"start":{"line":210,"column":8},"end":{"line":212,"column":9}},"42":{"start":{"line":211,"column":12},"end":{"line":211,"column":83}},"43":{"start":{"line":215,"column":4},"end":{"line":228,"column":7}},"44":{"start":{"line":216,"column":8},"end":{"line":216,"column":24}},"45":{"start":{"line":218,"column":8},"end":{"line":227,"column":11}},"46":{"start":{"line":219,"column":12},"end":{"line":219,"column":88}},"47":{"start":{"line":220,"column":12},"end":{"line":220,"column":30}},"48":{"start":{"line":222,"column":12},"end":{"line":222,"column":56}},"49":{"start":{"line":224,"column":12},"end":{"line":226,"column":13}},"50":{"start":{"line":225,"column":16},"end":{"line":225,"column":43}},"51":{"start":{"line":230,"column":4},"end":{"line":230,"column":91}},"52":{"start":{"line":231,"column":4},"end":{"line":231,"column":86}},"53":{"start":{"line":232,"column":4},"end":{"line":232,"column":107}},"54":{"start":{"line":233,"column":4},"end":{"line":233,"column":113}},"55":{"start":{"line":235,"column":4},"end":{"line":235,"column":179}},"56":{"start":{"line":236,"column":4},"end":{"line":236,"column":187}},"57":{"start":{"line":237,"column":4},"end":{"line":237,"column":182}},"58":{"start":{"line":238,"column":4},"end":{"line":238,"column":116}}},"branchMap":{"1":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":12},"end":{"line":141,"column":12}},{"start":{"line":141,"column":12},"end":{"line":141,"column":12}}]},"2":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":12},"end":{"line":145,"column":12}},{"start":{"line":145,"column":12},"end":{"line":145,"column":12}}]},"3":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":8},"end":{"line":175,"column":8}},{"start":{"line":175,"column":8},"end":{"line":175,"column":8}}]},"4":{"line":191,"type":"cond-expr","locations":[{"start":{"line":191,"column":36},"end":{"line":191,"column":48}},{"start":{"line":191,"column":51},"end":{"line":191,"column":59}}]},"5":{"line":194,"type":"if","locations":[{"start":{"line":194,"column":8},"end":{"line":194,"column":8}},{"start":{"line":194,"column":8},"end":{"line":194,"column":8}}]},"6":{"line":199,"type":"if","locations":[{"start":{"line":199,"column":8},"end":{"line":199,"column":8}},{"start":{"line":199,"column":8},"end":{"line":199,"column":8}}]},"7":{"line":210,"type":"if","locations":[{"start":{"line":210,"column":8},"end":{"line":210,"column":8}},{"start":{"line":210,"column":8},"end":{"line":210,"column":8}}]},"8":{"line":224,"type":"if","locations":[{"start":{"line":224,"column":12},"end":{"line":224,"column":12}},{"start":{"line":224,"column":12},"end":{"line":224,"column":12}}]}},"code":["/*global module:false*/","","module.exports = function(grunt) {","    'use strict';","","    var sh = require('shelljs');","","    grunt.loadNpmTasks('grunt-conventional-changelog');","    grunt.loadNpmTasks('grunt-contrib-connect');","    grunt.loadNpmTasks('grunt-contrib-clean');","    grunt.loadNpmTasks('grunt-contrib-watch');","    grunt.loadNpmTasks('grunt-concurrent');","    grunt.loadNpmTasks('grunt-ngdocs');","","    grunt.initConfig({","        docsSever: {","            port: 9001,","        },","        clean: {","            docs: {","                src: ['docs']","            }","        },","        ngdocs: {","            options: {","                title: 'SocketStream',","                scripts: [","                    'angular.js',","                ],","                styles: [","                    'src/docs/site/css/main.css'","                ],","                // navTemplate: 'src/docs/site/header.html',","                startPage: 'tutorials',","                titleLink: '#/tutorials',","                discussions: {","                    shortName: 'socketstream',","                    url: 'http://romanminkin.github.io/socketstream/docs/',","                    dev: true","                },","                html5Mode: false,","                bestMatch: true","            },","            tutorials: {","                src: ['src/docs/tutorials/**/*.ngdoc'],","                title: 'Tutorials'","            },","            api: {","                src: ['lib/**/*.js'],","                title: 'API Documentation'","            },","            demos: {","                src: ['src/docs/demos/**/*.ngdoc'],","                title: 'Demos'","            },","        },","        concurrent: {","            options: {","                logConcurrentOutput: true","            },","            docsSite: ['delta:docs', 'connect:docsSite']","        },","        delta: {","            docs: {","                options: {","                    interrupt: true,","                    atBegin: true","                },","                files: [","                    'lib/**',","                    'src/**'","                ],","                tasks: ['clean', 'ngdocs']","            }","        },","        connect: {","            options: {","            },","            docsSite: {","                options: {","                    port     : '<%= docsSever.port %>',","                    keepalive: true,","                    base     : 'docs',","                }","            }","        },","        shell: {","            //We use %version% and evluate it at run-time, because <%= pkg.version %>","            //is only evaluated once","            'release-prepare': [","                'grunt is-gh-pages-branch-exist',","                'grunt build:docs',","                'grunt is-clean:master',","                'grunt version',    //remove \"-SNAPSHOT\" from the project's version in package.json","                'grunt changelog'","            ],","            'release-complete': [","                'git commit CHANGELOG.md package.json -n -m \"chore(release): v%version%\"',","                'git tag %version%'","            ],","            'release-start': [","                'grunt version:patch:\"SNAPSHOT\"',","                'git commit package.json -n -m \"chore(release): Starting v%version%\"'","            ],","            'release-push': [","                'git push origin master',","                'git push origin gh-pages',","                'git push --tags',","            ],","            'update-gh-pages': [","                'git checkout gh-pages',","                'git merge master',","                'git checkout master'","            ]","        },","        changelog: {","            options: {","                dest: 'CHANGELOG.md',","                templateFile: 'src/docs/changelog.tpl.md',","                github: 'socketstream/socketstream'","            }","        },","    });","","    // Rename our watch task to 'delta', then make actual 'watch'","    grunt.renameTask('watch', 'delta');","","    /**","     * Sets version in 'package.json' in http://semver.org friendly mode","     *","     * @param {String} type   Could be 'major', 'minor' or 'patch'","     * @param {String} suffix Suffic string, example: 'alpha', 'pre-alpha', 'beta'","     */","    function setVersion(type, suffix) {","        var file = 'package.json',","            VERSION_REGEX = /([\\'|\\\"]version[\\'|\\\"][ ]*:[ ]*[\\'|\\\"])([\\d|.]*)(-\\w+)*([\\'|\\\"])/,","            contents = grunt.file.read(file),","            version;","        contents = contents.replace(VERSION_REGEX, function(match, left, center) {","            version = center;","            if (type) {","                version = require('semver').inc(version, type);","            }","            //semver.inc strips our suffix if it existed","            if (suffix) {","                version += '-' + suffix;","            }","            return left + version + '\"';","        });","        grunt.log.ok('Version set to ' + version.cyan);","        grunt.file.write(file, contents);","        return version;","    }","","    /**","     * Task for setting project version according to http://semver.org","     * @usage","     *     grunt version:type:suffix","     *","     *     // suppose current version in package.json is \"0.3.10\"","     *","     *     grunt version:patch // will set version to \"0.3.11\"","     *     grunt version:patch // one more call will increas version to \"0.3.12\"","     *","     *     grunt version:minor:\"alpha\" // this one will set up version to \"0.4.0-alpha\"","     *","     *     grunt version\" // this clean up current vesion to valid according to http://semver.org,","     *                    // so \"0.3.10-SNAPSHOT\" will become \"0.3.10\"","     */","    grunt.registerTask('version', 'Set version. If no arguments, it just takes off suffix', function() {","        setVersion(this.args[0], this.args[1]);","    });","","    grunt.registerTask('enforce', 'Install commit message enforce script if it doesn\\'t exist', function() {","        if (!grunt.file.exists('.git/hooks/commit-msg')) {","            grunt.file.copy('misc/validate-commit-msg.js', '.git/hooks/commit-msg');","            require('fs').chmodSync('.git/hooks/commit-msg', '0755');","        }","    });","","    /**","     * Check is master(default) or specified branch is clean for commit","     *","     *  grunt:is-clean // checks 'master' branch","     *  grunt:is-clean:test // checks 'test' branch","     *","     * @param {String} Branch name to check","     */","    grunt.registerTask('is-clean', 'Install commit message enforce script if it doesn\\'t exist', function() {","        var result,","            branch = this.args[0] ? this.args[0] : 'master';","","        result = sh.exec('git symbolic-ref HEAD', {silent: true});","        if (result.output.trim() !== 'refs/heads/' + branch) {","            throw new Error('Not on master branch, aborting! Current branch is \\'' + result.output.trim() + '\\'');","        }","","        result = sh.exec('git status --porcelain', {silent: true});","        if (result.output.trim() !== '') {","            grunt.log.error(result.output.trim());","            throw new Error('Working copy is dirty, aborting!');","        }","    });","","    grunt.registerTask('is-gh-pages-branch-exist', 'Check if gh-pages branch exists, if not create it', function() {","        var result,","            branch = this.args[0];","","        result = sh.exec('git branch | grep gh-pages', {silent: true});","        if (result.output.trim() ===  '') {","            sh.exec('git branch gh-pages origin/gh-pages' + branch, {silent: true})","        }","    });","","    grunt.registerMultiTask('shell', 'run shell commands', function() {","        var self = this;","","        self.data.forEach(function(cmd) {","            cmd = cmd.replace('%version%', grunt.file.readJSON('package.json').version);","            grunt.log.ok(cmd);","","            var result = sh.exec(cmd, { silent: true });","","            if (result.code !== 0) {","                grunt.fatal(result.output);","            }","        });","    });","","    grunt.registerTask('default', 'Default task which runs all the required subtasks', []);","    grunt.registerTask('build:docs', 'Build documentation', ['clean:docs', 'ngdocs']);","    grunt.registerTask('watch:docs', 'Watching for changes and re-building docs', ['concurrent:docsSite']);","    grunt.registerTask('update:docs', 'Update gh-page branch by merging from master', ['shell:update-gh-pages']);","","    grunt.registerTask('release:start', 'Increase patch version by 1, add suffix \"SNAPSHOT\" as \"major.minor.(patch+1)-SNAPSHOT\" and commit package.json', ['shell:release-start']);","    grunt.registerTask('release:prepare', 'Run all the tests, generates CHANGELOG.md since laste release and and clean up version to just \"major.minor.patch\"', ['shell:release-prepare']);","    grunt.registerTask('release:complete', 'Complete release by commiting CHANGELOG.md and package.json and adding version tag', ['shell:release-complete', 'shell:update-gh-pages']);","    grunt.registerTask('release:push', 'Push to origin tags, master and gh-pages branches', ['shell:release-push']);","}",""],"l":{"3":1,"6":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"15":0,"126":0,"134":1,"135":0,"139":0,"140":0,"141":0,"142":0,"145":0,"146":0,"148":0,"150":0,"151":0,"152":0,"170":0,"171":0,"174":0,"175":0,"176":0,"177":0,"189":0,"190":0,"193":0,"194":0,"195":0,"198":0,"199":0,"200":0,"201":0,"205":0,"206":0,"209":0,"210":0,"211":0,"215":0,"216":0,"218":0,"219":0,"220":0,"222":0,"224":0,"225":0,"230":0,"231":0,"232":0,"233":0,"235":0,"236":0,"237":0,"238":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/gulp.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/gulp.js","s":{"1":2,"2":2,"3":2,"4":2},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":22}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":5,"column":34}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":19}},"3":{"start":{"line":12,"column":0},"end":{"line":12,"column":25}},"4":{"start":{"line":15,"column":0},"end":{"line":15,"column":20}}},"branchMap":{},"code":["// Entry point for gulpfile.js","","// Load SocketStream core","var ss = module.exports = require('./lib/socketstream.js'),","    gulp = ss.api.require('gulp');","","// gulp is used as the Orchestrator","ss.tasks.use(gulp);","","// Your app.js should be required from the gulpfile.js","// .start() will normally be called from app.js, and will not run tasks.","ss.start = function() {};","","// default tasks are defined","ss.tasks.defaults();","","// don't load API yet as the app.js still needs to be loaded",""],"l":{"4":2,"8":2,"12":2,"15":2}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/misc/validate-commit-msg.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/misc/validate-commit-msg.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":2,"9":0,"10":2,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":2,"28":0,"29":2,"30":2,"31":2,"32":2,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[2,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":36,"loc":{"start":{"line":36,"column":12},"end":{"line":36,"column":23}}},"2":{"name":"(anonymous_2)","line":44,"loc":{"start":{"line":44,"column":22},"end":{"line":44,"column":40}}},"3":{"name":"(anonymous_3)","line":86,"loc":{"start":{"line":86,"column":26},"end":{"line":86,"column":43}}},"4":{"name":"(anonymous_4)","line":100,"loc":{"start":{"line":100,"column":29},"end":{"line":100,"column":51}}},"5":{"name":"(anonymous_5)","line":104,"loc":{"start":{"line":104,"column":50},"end":{"line":104,"column":61}}}},"statementMap":{"1":{"start":{"line":14,"column":0},"end":{"line":14,"column":63}},"2":{"start":{"line":16,"column":0},"end":{"line":16,"column":19}},"3":{"start":{"line":17,"column":0},"end":{"line":17,"column":23}},"4":{"start":{"line":20,"column":0},"end":{"line":20,"column":16}},"5":{"start":{"line":21,"column":0},"end":{"line":21,"column":53}},"6":{"start":{"line":22,"column":0},"end":{"line":22,"column":19}},"7":{"start":{"line":23,"column":0},"end":{"line":33,"column":2}},"8":{"start":{"line":36,"column":0},"end":{"line":41,"column":2}},"9":{"start":{"line":40,"column":2},"end":{"line":40,"column":77}},"10":{"start":{"line":44,"column":0},"end":{"line":83,"column":2}},"11":{"start":{"line":45,"column":2},"end":{"line":45,"column":21}},"12":{"start":{"line":47,"column":2},"end":{"line":50,"column":3}},"13":{"start":{"line":48,"column":4},"end":{"line":48,"column":54}},"14":{"start":{"line":49,"column":4},"end":{"line":49,"column":16}},"15":{"start":{"line":52,"column":2},"end":{"line":55,"column":3}},"16":{"start":{"line":53,"column":4},"end":{"line":53,"column":56}},"17":{"start":{"line":54,"column":4},"end":{"line":54,"column":20}},"18":{"start":{"line":57,"column":2},"end":{"line":57,"column":32}},"19":{"start":{"line":59,"column":2},"end":{"line":62,"column":3}},"20":{"start":{"line":60,"column":4},"end":{"line":60,"column":119}},"21":{"start":{"line":61,"column":4},"end":{"line":61,"column":17}},"22":{"start":{"line":64,"column":2},"end":{"line":64,"column":21}},"23":{"start":{"line":68,"column":2},"end":{"line":71,"column":3}},"24":{"start":{"line":69,"column":4},"end":{"line":69,"column":46}},"25":{"start":{"line":70,"column":4},"end":{"line":70,"column":17}},"26":{"start":{"line":82,"column":2},"end":{"line":82,"column":17}},"27":{"start":{"line":86,"column":0},"end":{"line":88,"column":2}},"28":{"start":{"line":87,"column":2},"end":{"line":87,"column":47}},"29":{"start":{"line":93,"column":0},"end":{"line":93,"column":42}},"30":{"start":{"line":96,"column":0},"end":{"line":111,"column":1}},"31":{"start":{"line":97,"column":2},"end":{"line":97,"column":38}},"32":{"start":{"line":98,"column":2},"end":{"line":98,"column":95}},"33":{"start":{"line":100,"column":2},"end":{"line":110,"column":5}},"34":{"start":{"line":101,"column":4},"end":{"line":101,"column":42}},"35":{"start":{"line":103,"column":4},"end":{"line":109,"column":5}},"36":{"start":{"line":104,"column":6},"end":{"line":106,"column":9}},"37":{"start":{"line":105,"column":8},"end":{"line":105,"column":24}},"38":{"start":{"line":108,"column":6},"end":{"line":108,"column":22}}},"branchMap":{"1":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":47,"column":2}},{"start":{"line":47,"column":2},"end":{"line":47,"column":2}}]},"2":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":52,"column":2}},{"start":{"line":52,"column":2},"end":{"line":52,"column":2}}]},"3":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":2},"end":{"line":59,"column":2}},{"start":{"line":59,"column":2},"end":{"line":59,"column":2}}]},"4":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":2},"end":{"line":68,"column":2}},{"start":{"line":68,"column":2},"end":{"line":68,"column":2}}]},"5":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":0},"end":{"line":96,"column":0}},{"start":{"line":96,"column":0},"end":{"line":96,"column":0}}]},"6":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":4},"end":{"line":103,"column":4}},{"start":{"line":103,"column":4},"end":{"line":103,"column":4}}]}},"code":["//#!/usr/bin/env node","","'use strict';","","/**"," * Git COMMIT-MSG hook for validating commit message"," * See https://docs.google.com/document/d/1rk04jEuGfk9kYzfqCuOlPTSJw3hEDZJTBN5E5f1SALo/edit"," *"," * Installation:"," * >> cd <angular-repo>"," * >> ln -s validate-commit-msg.js .git/hooks/commit-msg"," */","","var fs, util, MAX_LENGTH, PATTERN, IGNORED, TYPES, match, type;","","fs = require('fs');","util = require('util');","","","MAX_LENGTH = 70;","PATTERN = /^(?:fixup!\\s*)?(\\w*)(\\((\\w+)\\))?\\: (.*)$/;","IGNORED = /^WIP\\:/;","TYPES = {","  chore: true,","  demo: true,","  docs: true,","  feat: true,","  fix: true,","  refactor: true,","  revert: true,","  style: true,","  test: true","};","","","var error = function() {","  // gitx does not display it","  // http://gitx.lighthouseapp.com/projects/17830/tickets/294-feature-display-hook-error-message-when-hook-fails","  // https://groups.google.com/group/gitx/browse_thread/thread/a03bcab60844b812","  console.error('INVALID COMMIT MSG: ' + util.format.apply(null, arguments));","};","","","var validateMessage = function(message) {","  var isValid = true;","","  if (IGNORED.test(message)) {","    console.log('Commit message validation ignored.');","    return true;","  }","","  if (message.length > MAX_LENGTH) {","    error('is longer than %d characters !', MAX_LENGTH);","    isValid = false;","  }","","  match = PATTERN.exec(message);","","  if (!match) {","    error('does not match \"<type>(<scope>): <subject>\" ! was: \"' + message + '\"\\nNote: <scope> must be only letters.');","    return false;","  }","","  type    = match[1];","  // scope   = match[3];","  // subject = match[4];","","  if (!TYPES.hasOwnProperty(type)) {","    error('\"%s\" is not allowed type !', type);","    return false;","  }","","  // Some more ideas, do want anything like this ?","  // - allow only specific scopes (eg. fix(docs) should not be allowed ?","  // - auto correct the type to lower case ?","  // - auto correct first letter of the subject to lower case ?","  // - auto add empty line after subject ?","  // - auto remove empty () ?","  // - auto correct typos in type ?","  // - store incorrect messages, so that we can learn","","  return isValid;","};","","","var firstLineFromBuffer = function(buffer) {","  return buffer.toString().split('\\n').shift();","};","","","","// publish for testing","exports.validateMessage = validateMessage;","","// hacky start if not run by jasmine :-D","if (process.argv.join('').indexOf('jasmine-node') === -1) {","  var commitMsgFile = process.argv[2];","  var incorrectLogFile = commitMsgFile.replace('COMMIT_EDITMSG', 'logs/incorrect-commit-msgs');","","  fs.readFile(commitMsgFile, function(err, buffer) {","    var msg = firstLineFromBuffer(buffer);","","    if (!validateMessage(msg)) {","      fs.appendFile(incorrectLogFile, msg + '\\n', function() {","        process.exit(1);","      });","    } else {","      process.exit(0);","    }","  });","}"],"l":{"14":2,"16":2,"17":2,"20":2,"21":2,"22":2,"23":2,"36":2,"40":0,"44":2,"45":0,"47":0,"48":0,"49":0,"52":0,"53":0,"54":0,"57":0,"59":0,"60":0,"61":0,"64":0,"68":0,"69":0,"70":0,"82":0,"86":2,"87":0,"93":2,"96":2,"97":2,"98":2,"100":0,"101":0,"103":0,"104":0,"105":0,"108":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/cli/generate.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/cli/generate.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":17,"loc":{"start":{"line":17,"column":14},"end":{"line":17,"column":42}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":40}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":19},"end":{"line":37,"column":37}}},"4":{"name":"(anonymous_4)","line":58,"loc":{"start":{"line":58,"column":14},"end":{"line":58,"column":28}}},"5":{"name":"(anonymous_5)","line":68,"loc":{"start":{"line":68,"column":11},"end":{"line":68,"column":31}}},"6":{"name":"(anonymous_6)","line":82,"loc":{"start":{"line":82,"column":14},"end":{"line":82,"column":42}}},"7":{"name":"(anonymous_7)","line":104,"loc":{"start":{"line":104,"column":49},"end":{"line":104,"column":69}}},"8":{"name":"(anonymous_8)","line":166,"loc":{"start":{"line":166,"column":31},"end":{"line":166,"column":47}}},"9":{"name":"(anonymous_9)","line":195,"loc":{"start":{"line":195,"column":17},"end":{"line":195,"column":33}}}},"statementMap":{"1":{"start":{"line":9,"column":0},"end":{"line":9,"column":18}},"2":{"start":{"line":11,"column":0},"end":{"line":35,"column":4}},"3":{"start":{"line":18,"column":6},"end":{"line":18,"column":61}},"4":{"start":{"line":24,"column":6},"end":{"line":34,"column":7}},"5":{"start":{"line":25,"column":8},"end":{"line":25,"column":37}},"6":{"start":{"line":26,"column":8},"end":{"line":26,"column":20}},"7":{"start":{"line":28,"column":8},"end":{"line":33,"column":9}},"8":{"start":{"line":29,"column":10},"end":{"line":29,"column":111}},"9":{"start":{"line":30,"column":10},"end":{"line":30,"column":23}},"10":{"start":{"line":32,"column":10},"end":{"line":32,"column":18}},"11":{"start":{"line":37,"column":0},"end":{"line":239,"column":2}},"12":{"start":{"line":39,"column":2},"end":{"line":84,"column":8}},"13":{"start":{"line":59,"column":8},"end":{"line":59,"column":60}},"14":{"start":{"line":69,"column":8},"end":{"line":71,"column":60}},"15":{"start":{"line":73,"column":8},"end":{"line":73,"column":32}},"16":{"start":{"line":83,"column":8},"end":{"line":83,"column":76}},"17":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"18":{"start":{"line":88,"column":4},"end":{"line":88,"column":94}},"19":{"start":{"line":92,"column":2},"end":{"line":100,"column":3}},"20":{"start":{"line":93,"column":4},"end":{"line":93,"column":28}},"21":{"start":{"line":95,"column":7},"end":{"line":100,"column":3}},"22":{"start":{"line":96,"column":4},"end":{"line":96,"column":28}},"23":{"start":{"line":99,"column":4},"end":{"line":99,"column":27}},"24":{"start":{"line":103,"column":2},"end":{"line":238,"column":3}},"25":{"start":{"line":104,"column":4},"end":{"line":108,"column":7}},"26":{"start":{"line":105,"column":6},"end":{"line":107,"column":7}},"27":{"start":{"line":106,"column":8},"end":{"line":106,"column":50}},"28":{"start":{"line":111,"column":4},"end":{"line":111,"column":21}},"29":{"start":{"line":112,"column":4},"end":{"line":112,"column":26}},"30":{"start":{"line":113,"column":4},"end":{"line":113,"column":30}},"31":{"start":{"line":114,"column":4},"end":{"line":114,"column":31}},"32":{"start":{"line":115,"column":4},"end":{"line":115,"column":27}},"33":{"start":{"line":116,"column":4},"end":{"line":116,"column":25}},"34":{"start":{"line":117,"column":4},"end":{"line":117,"column":30}},"35":{"start":{"line":118,"column":4},"end":{"line":118,"column":31}},"36":{"start":{"line":119,"column":4},"end":{"line":119,"column":28}},"37":{"start":{"line":120,"column":4},"end":{"line":120,"column":35}},"38":{"start":{"line":121,"column":4},"end":{"line":121,"column":21}},"39":{"start":{"line":122,"column":4},"end":{"line":122,"column":25}},"40":{"start":{"line":123,"column":4},"end":{"line":123,"column":32}},"41":{"start":{"line":126,"column":4},"end":{"line":126,"column":42}},"42":{"start":{"line":127,"column":4},"end":{"line":127,"column":55}},"43":{"start":{"line":128,"column":4},"end":{"line":128,"column":21}},"44":{"start":{"line":129,"column":4},"end":{"line":129,"column":37}},"45":{"start":{"line":130,"column":4},"end":{"line":130,"column":42}},"46":{"start":{"line":131,"column":4},"end":{"line":131,"column":50}},"47":{"start":{"line":132,"column":4},"end":{"line":132,"column":66}},"48":{"start":{"line":133,"column":4},"end":{"line":133,"column":48}},"49":{"start":{"line":134,"column":4},"end":{"line":134,"column":33}},"50":{"start":{"line":137,"column":4},"end":{"line":156,"column":5}},"51":{"start":{"line":138,"column":6},"end":{"line":138,"column":93}},"52":{"start":{"line":139,"column":6},"end":{"line":139,"column":99}},"53":{"start":{"line":140,"column":6},"end":{"line":140,"column":91}},"54":{"start":{"line":141,"column":6},"end":{"line":141,"column":33}},"55":{"start":{"line":142,"column":6},"end":{"line":142,"column":40}},"56":{"start":{"line":143,"column":6},"end":{"line":143,"column":39}},"57":{"start":{"line":144,"column":6},"end":{"line":144,"column":52}},"58":{"start":{"line":146,"column":6},"end":{"line":146,"column":43}},"59":{"start":{"line":147,"column":6},"end":{"line":147,"column":96}},"60":{"start":{"line":148,"column":6},"end":{"line":148,"column":56}},"61":{"start":{"line":149,"column":6},"end":{"line":149,"column":46}},"62":{"start":{"line":150,"column":6},"end":{"line":150,"column":88}},"63":{"start":{"line":151,"column":6},"end":{"line":151,"column":38}},"64":{"start":{"line":152,"column":6},"end":{"line":152,"column":60}},"65":{"start":{"line":153,"column":6},"end":{"line":153,"column":90}},"66":{"start":{"line":154,"column":6},"end":{"line":154,"column":74}},"67":{"start":{"line":155,"column":6},"end":{"line":155,"column":52}},"68":{"start":{"line":159,"column":4},"end":{"line":160,"column":388}},"69":{"start":{"line":163,"column":4},"end":{"line":165,"column":5}},"70":{"start":{"line":164,"column":6},"end":{"line":164,"column":40}},"71":{"start":{"line":166,"column":4},"end":{"line":168,"column":7}},"72":{"start":{"line":167,"column":6},"end":{"line":167,"column":82}},"73":{"start":{"line":169,"column":4},"end":{"line":171,"column":72}},"74":{"start":{"line":172,"column":4},"end":{"line":175,"column":5}},"75":{"start":{"line":173,"column":6},"end":{"line":174,"column":148}},"76":{"start":{"line":176,"column":4},"end":{"line":176,"column":52}},"77":{"start":{"line":177,"column":4},"end":{"line":177,"column":28}},"78":{"start":{"line":180,"column":4},"end":{"line":181,"column":134}},"79":{"start":{"line":182,"column":4},"end":{"line":182,"column":51}},"80":{"start":{"line":183,"column":4},"end":{"line":183,"column":47}},"81":{"start":{"line":184,"column":4},"end":{"line":184,"column":50}},"82":{"start":{"line":185,"column":4},"end":{"line":185,"column":65}},"83":{"start":{"line":186,"column":4},"end":{"line":186,"column":46}},"84":{"start":{"line":187,"column":4},"end":{"line":187,"column":45}},"85":{"start":{"line":188,"column":4},"end":{"line":188,"column":65}},"86":{"start":{"line":189,"column":4},"end":{"line":189,"column":47}},"87":{"start":{"line":190,"column":4},"end":{"line":190,"column":52}},"88":{"start":{"line":191,"column":4},"end":{"line":191,"column":48}},"89":{"start":{"line":192,"column":4},"end":{"line":194,"column":5}},"90":{"start":{"line":193,"column":6},"end":{"line":193,"column":27}},"91":{"start":{"line":195,"column":4},"end":{"line":197,"column":7}},"92":{"start":{"line":196,"column":6},"end":{"line":196,"column":62}},"93":{"start":{"line":199,"column":4},"end":{"line":199,"column":76}},"94":{"start":{"line":200,"column":4},"end":{"line":200,"column":38}},"95":{"start":{"line":203,"column":4},"end":{"line":203,"column":64}},"96":{"start":{"line":205,"column":4},"end":{"line":209,"column":5}},"97":{"start":{"line":206,"column":6},"end":{"line":206,"column":43}},"98":{"start":{"line":208,"column":6},"end":{"line":208,"column":61}},"99":{"start":{"line":210,"column":4},"end":{"line":214,"column":5}},"100":{"start":{"line":211,"column":6},"end":{"line":211,"column":43}},"101":{"start":{"line":213,"column":6},"end":{"line":213,"column":76}},"102":{"start":{"line":215,"column":4},"end":{"line":219,"column":5}},"103":{"start":{"line":216,"column":6},"end":{"line":216,"column":32}},"104":{"start":{"line":218,"column":6},"end":{"line":218,"column":65}},"105":{"start":{"line":220,"column":4},"end":{"line":226,"column":5}},"106":{"start":{"line":221,"column":6},"end":{"line":221,"column":30}},"107":{"start":{"line":222,"column":11},"end":{"line":226,"column":5}},"108":{"start":{"line":223,"column":6},"end":{"line":223,"column":31}},"109":{"start":{"line":225,"column":6},"end":{"line":225,"column":69}},"110":{"start":{"line":229,"column":4},"end":{"line":231,"column":5}},"111":{"start":{"line":230,"column":6},"end":{"line":230,"column":39}},"112":{"start":{"line":233,"column":4},"end":{"line":233,"column":52}},"113":{"start":{"line":234,"column":4},"end":{"line":234,"column":25}},"114":{"start":{"line":235,"column":4},"end":{"line":235,"column":33}},"115":{"start":{"line":236,"column":4},"end":{"line":236,"column":37}},"116":{"start":{"line":237,"column":4},"end":{"line":237,"column":26}}},"branchMap":{"1":{"line":18,"type":"binary-expr","locations":[{"start":{"line":18,"column":36},"end":{"line":18,"column":47}},{"start":{"line":18,"column":51},"end":{"line":18,"column":53}}]},"2":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":8}},{"start":{"line":28,"column":8},"end":{"line":28,"column":8}}]},"3":{"line":40,"type":"binary-expr","locations":[{"start":{"line":40,"column":22},"end":{"line":40,"column":36}},{"start":{"line":40,"column":40},"end":{"line":40,"column":48}},{"start":{"line":40,"column":52},"end":{"line":40,"column":56}}]},"4":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":27},"end":{"line":44,"column":39}},{"start":{"line":44,"column":43},"end":{"line":44,"column":49}},{"start":{"line":44,"column":53},"end":{"line":44,"column":59}}]},"5":{"line":69,"type":"binary-expr","locations":[{"start":{"line":69,"column":42},"end":{"line":69,"column":46}},{"start":{"line":69,"column":50},"end":{"line":69,"column":53}}]},"6":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"7":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":2},"end":{"line":92,"column":2}},{"start":{"line":92,"column":2},"end":{"line":92,"column":2}}]},"8":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":7},"end":{"line":95,"column":7}},{"start":{"line":95,"column":7},"end":{"line":95,"column":7}}]},"9":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":2},"end":{"line":103,"column":2}},{"start":{"line":103,"column":2},"end":{"line":103,"column":2}}]},"10":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":6},"end":{"line":105,"column":6}},{"start":{"line":105,"column":6},"end":{"line":105,"column":6}}]},"11":{"line":137,"type":"if","locations":[{"start":{"line":137,"column":4},"end":{"line":137,"column":4}},{"start":{"line":137,"column":4},"end":{"line":137,"column":4}}]},"12":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":4},"end":{"line":163,"column":4}},{"start":{"line":163,"column":4},"end":{"line":163,"column":4}}]},"13":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":4},"end":{"line":172,"column":4}},{"start":{"line":172,"column":4},"end":{"line":172,"column":4}}]},"14":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":4},"end":{"line":192,"column":4}},{"start":{"line":192,"column":4},"end":{"line":192,"column":4}}]},"15":{"line":205,"type":"if","locations":[{"start":{"line":205,"column":4},"end":{"line":205,"column":4}},{"start":{"line":205,"column":4},"end":{"line":205,"column":4}}]},"16":{"line":210,"type":"if","locations":[{"start":{"line":210,"column":4},"end":{"line":210,"column":4}},{"start":{"line":210,"column":4},"end":{"line":210,"column":4}}]},"17":{"line":215,"type":"if","locations":[{"start":{"line":215,"column":4},"end":{"line":215,"column":4}},{"start":{"line":215,"column":4},"end":{"line":215,"column":4}}]},"18":{"line":220,"type":"if","locations":[{"start":{"line":220,"column":4},"end":{"line":220,"column":4}},{"start":{"line":220,"column":4},"end":{"line":220,"column":4}}]},"19":{"line":222,"type":"if","locations":[{"start":{"line":222,"column":11},"end":{"line":222,"column":11}},{"start":{"line":222,"column":11},"end":{"line":222,"column":11}}]},"20":{"line":229,"type":"if","locations":[{"start":{"line":229,"column":4},"end":{"line":229,"column":4}},{"start":{"line":229,"column":4},"end":{"line":229,"column":4}}]}},"code":["/**"," * New App Generator"," * -----------------"," * Generates skeleton files needed to create a new SocketStream application"," */","","'use strict';","","require('colors');","","var fs       = require('fs'),","    path     = require('path'),","    log      = console.log,","    dir_mode = '0755',","","    // Private","    success = function(name, alternative) {","      return log(' ✓'.green, name, (alternative || '').grey);","    },","","    // TODO - investigate whether this would be better","    // using the async version of fs.mkdir - PJENSEN","    makeRootDirectory = function (name) {","      try {","        fs.mkdirSync(name, dir_mode); // Create the root directory","        return true;","      } catch (e) {","        if (e.code === 'EEXIST') {","          log('Sorry the \\'' + name + '\\' directory already exists. Please choose another name for your app.');","          return false;","        } else {","          throw e;","        }","      }","  };","","exports.generate = function(program) {","","  var appjs,","      codeExtension = program.coffee && 'coffee' || 'js',","      selectedFormatters = [],","      name               = program.args[1],","      source             = path.join(__dirname, '../../new_project'),","      viewExtension      = program.jade && 'jade' || 'html',","      styleExtension     = '',","      mods               = [],","      packagejs          = '',","      clientFiles        = {","        css: [],","        code: []","      },","","      /**","       * [mkdir description]","       * @param  {String}   dir Directory path to create","       * @return {Boolean}      True if directory successfully created","       */","      mkdir = function(dir) {","        return fs.mkdirSync(path.join(name, dir), dir_mode);","      },","","      /**","       * Copy files/directories","       * @param  {[String} src  Copy From directory","       * @param  {[String} dest Copy To directory","       * @return {Object}       Stream object","       */","      cp = function(src, dest) {","        var destination = path.join(name, dest || src),","            read        = fs.createReadStream(path.join(source, src)),","            write       = fs.createWriteStream(destination);","","        return read.pipe(write);","      },","","      /**","       * Writes content to the file","       * @param  {String} fileName The filepath to write to","       * @param  {[type]} content  Content string","       * @return {Boolean}","       */","      write = function(fileName, content) {","        return fs.writeFileSync(path.join(name, fileName), content, 'utf8');","      };","","  /* Check for application name existing */","  if (name === void 0) {","    return log('Please provide a name for your application: $> socketstream new <MyAppName>');","  }","","  /* Select stylesheet language */","  if (program.less) {","    styleExtension = 'less';","  }","  else if (program.stylus) {","    styleExtension = 'styl';","  }","  else {","    styleExtension = 'css';","  }","","  /* Select formatters for file extensions */","  if (makeRootDirectory(name)) {","    ['coffee', 'jade', 'less', 'stylus'].forEach(function(formatter) {","      if (program[formatter]) {","        return selectedFormatters.push(formatter);","      }","    });","","    /* Create essential directories */","    mkdir('/client');","    mkdir('/client/code');","    mkdir('/client/code/app');","    mkdir('/client/code/libs');","    mkdir('/client/views');","    mkdir('/client/css');","    mkdir('/client/css/libs');","    mkdir('/client/templates');","    mkdir('/client/static');","    mkdir('/client/static/images');","    mkdir('/server');","    mkdir('/server/rpc');","    mkdir('/server/middleware');","","    /* Copy essential files */","    cp('/scm_ignore_file', '/.gitignore');","    cp('/node_monitor_ignore_file', '/.nodemonignore');","    cp('/README.md');","    cp('/client/static/favicon.ico');","    cp('/client/code/libs/jquery.min.js');","    cp('/client/code/app/entry.' + codeExtension);","    clientFiles.code.push('../node_modules/es6-shim/es6-shim.js');","    clientFiles.code.push('libs/jquery.min.js');","    clientFiles.code.push('app');","","    /* Install chat demo files */","    if (program.minimal) {","      cp('/client/views/app.minimal.' + viewExtension, '/client/views/app.' + viewExtension);","      cp('/client/code/app/app.minimal.' + codeExtension, '/client/code/app/app.' + codeExtension);","      cp('/client/css/app.minimal.' + styleExtension, '/client/css/app.' + styleExtension);","      cp('/server/rpc/.gitkeep');","      cp('/server/middleware/.gitkeep');","      cp('/client/templates/.gitkeep');","      clientFiles.css.push('app.' + styleExtension);","    } else {","      cp('/client/static/images/logo.png');","      cp('/client/code/app/app.demo.' + codeExtension, '/client/code/app/app.' + codeExtension);","      cp('/server/middleware/example.' + codeExtension);","      cp('/server/rpc/demo.' + codeExtension);","      cp('/client/css/app.demo.' + styleExtension, '/client/css/app.' + styleExtension);","      mkdir('/client/templates/chat');","      cp('/client/templates/chat/message.' + viewExtension);","      cp('/client/views/app.demo.' + viewExtension, '/client/views/app.' + viewExtension);","      clientFiles.css.push('../node_modules/normalize.css/normalize.css');","      clientFiles.css.push('app.' + styleExtension);","    }","","    /* Generate app.js */","    appjs = '// My SocketStream 0.4 app\\n\\nvar ss = require(\\'socketstream\\');\\n\\n'+","            '// Define a single-page client called \\'main\\'\\nss.client.define(\\'main\\', {\\n  view: \\'app.' + viewExtension + '\\',\\n  css:  [\\'' + (clientFiles.css.join('\\', \\'')) + '\\'],\\n  code: [\\'' + (clientFiles.code.join('\\', \\'')) + '\\'],\\n  tmpl: \\'chat\\'\\n});\\n\\n// Serve this client on the root URL\\nss.http.route(\\'/\\', function(req, res){\\n  res.serveClient(\\'main\\');\\n});\\n';","","    /* List any selected formatters */","    if (selectedFormatters.length > 0) {","      appjs += '\\n// Code Formatters\\n';","    }","    selectedFormatters.forEach(function (name) {","      return appjs += 'ss.client.formatters.add(require(\\'ss-' + name + '\\'));\\n';","    });","    appjs += '\\n// Use server-side compiled Hogan (Mustache) templates. Others engines available\\n'+","             'ss.client.templateEngine.use(require(\\'ss-hogan\\'));\\n\\n// Minimize and pack assets if you type: SS_ENV=production node app.js\\n'+","             'if (ss.env === \\'production\\') ss.client.packAssets();\\n';","    if (program.repl) {","      appjs += '\\n// Start Console Server (REPL)\\n// To install client: sudo npm install -g ss-console\\n'+","               '// To connect: ss-console <optional_host_or_port>\\nvar consoleServer = require(\\'ss-console\\')(ss);\\nconsoleServer.listen(5000);\\n';","    }","    appjs += '\\n// Start SocketStream\\nss.start();';","    write('/app.js', appjs);","","    /* Generate package.json */","    packagejs = '{\\n  \"name\": \"' + name + '\",\\n  \"description\": \"An awesome real time application\",\\n  \"version\": \"0.0.1\",\\n'+","                '  \"author\": \"Me <me@mydomain.com>\",\\n  \"private\": true,\\n  \"engines\": { \"node\": \">= 0.10.0\" },\\n  \"dependencies\": {';","    packagejs += '\\n    \"normalize.css\": \"3.0.x\",';","    packagejs += '\\n    \"es6-shim\": \"0.33.x\",';","    packagejs += '\\n    \"socketstream\": \"0.5.x\",';","    packagejs += '\\n    \"socketstream-cookie-session\": \"0.5.x\",';","    packagejs += '\\n    \"chokidar\": \"1.4.x\",';","    packagejs += '\\n    \"connect\": \"3.4.x\",';","    packagejs += '\\n    \"socketstream-cookie-session\": \"0.5.x\",';","    packagejs += '\\n    \"engine.io\": \"1.5.2\",';","    packagejs += '\\n    \"engine.io-client\": \"1.5.2\"'","    mods = selectedFormatters.concat(['hogan']);","    if (program.repl) {","      mods.push('console');","    }","    mods.forEach(function (name) {","      return packagejs += ',\\n    \"ss-' + name + '\": \"0.1.x\"';","    });","","    packagejs += '\\n  },\\n  \"scripts\":{\\n    \"start\":\"node app.js\"\\n  }\\n}';","    write('/package.json', packagejs);","","    /* Show finish text */","    log(('Success! Created app \\'' + name + '\\' with:').yellow);","","    if (program.minimal) {","      success('Minimal install (no demo)');","    } else {","      success('Basic chat demo', '(-m for minimal install)');","    }","    if (program.coffee) {","      success('CoffeeScript example code');","    } else {","      success('Javascript example code', '(-c if you prefer CoffeeScript)');","    }","    if (program.jade) {","      success('Jade for views');","    } else {","      success('Plain HTML for views', '(-j if you prefer Jade)');","    }","    if (program.less) {","      success('Less for CSS');","    } else if (program.stylus) {","      success('Stylus for CSS')","    } else {","      success('Plain CSS', '(-s if you prefer Stylus, -l for Less)');","    }","","    /* Add the REPL if selected */","    if (program.repl) {","      success('Console Server / REPL');","    }","","    log('Next, run the following commands:'.yellow);","    log('   cd ' + name);","    log('   [sudo] npm install');","    log('To start your app:'.yellow);","    log('   node app.js');","  }","};",""],"l":{"9":1,"11":1,"18":0,"24":0,"25":0,"26":0,"28":0,"29":0,"30":0,"32":0,"37":1,"39":0,"59":0,"69":0,"73":0,"83":0,"87":0,"88":0,"92":0,"93":0,"95":0,"96":0,"99":0,"103":0,"104":0,"105":0,"106":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"159":0,"163":0,"164":0,"166":0,"167":0,"169":0,"172":0,"173":0,"176":0,"177":0,"180":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"195":0,"196":0,"199":0,"200":0,"203":0,"205":0,"206":0,"208":0,"210":0,"211":0,"213":0,"215":0,"216":0,"218":0,"220":0,"221":0,"222":0,"223":0,"225":0,"229":0,"230":0,"233":0,"234":0,"235":0,"236":0,"237":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/misc.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/utils/misc.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":27,"loc":{"start":{"line":27,"column":23},"end":{"line":27,"column":38}}},"2":{"name":"(anonymous_2)","line":51,"loc":{"start":{"line":51,"column":25},"end":{"line":51,"column":40}}},"3":{"name":"(anonymous_3)","line":73,"loc":{"start":{"line":73,"column":17},"end":{"line":73,"column":32}}},"4":{"name":"(anonymous_4)","line":102,"loc":{"start":{"line":102,"column":19},"end":{"line":102,"column":45}}}},"statementMap":{"1":{"start":{"line":27,"column":0},"end":{"line":37,"column":2}},"2":{"start":{"line":28,"column":2},"end":{"line":31,"column":8}},"3":{"start":{"line":33,"column":2},"end":{"line":35,"column":3}},"4":{"start":{"line":34,"column":4},"end":{"line":34,"column":45}},"5":{"start":{"line":36,"column":2},"end":{"line":36,"column":23}},"6":{"start":{"line":51,"column":0},"end":{"line":58,"column":2}},"7":{"start":{"line":52,"column":2},"end":{"line":52,"column":8}},"8":{"start":{"line":53,"column":2},"end":{"line":57,"column":3}},"9":{"start":{"line":54,"column":4},"end":{"line":54,"column":47}},"10":{"start":{"line":56,"column":4},"end":{"line":56,"column":39}},"11":{"start":{"line":73,"column":0},"end":{"line":87,"column":2}},"12":{"start":{"line":74,"column":2},"end":{"line":76,"column":8}},"13":{"start":{"line":78,"column":2},"end":{"line":85,"column":3}},"14":{"start":{"line":79,"column":4},"end":{"line":79,"column":26}},"15":{"start":{"line":80,"column":4},"end":{"line":84,"column":5}},"16":{"start":{"line":81,"column":6},"end":{"line":83,"column":7}},"17":{"start":{"line":82,"column":8},"end":{"line":82,"column":33}},"18":{"start":{"line":86,"column":2},"end":{"line":86,"column":13}},"19":{"start":{"line":102,"column":0},"end":{"line":104,"column":2}},"20":{"start":{"line":103,"column":2},"end":{"line":103,"column":44}}},"branchMap":{"1":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":2},"end":{"line":53,"column":2}},{"start":{"line":53,"column":2},"end":{"line":53,"column":2}}]},"2":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":6},"end":{"line":81,"column":6}},{"start":{"line":81,"column":6},"end":{"line":81,"column":6}}]}},"code":["/*jslint bitwise: true*/","","'use strict';","","/**"," * @ngdoc service"," * @name utils.misc:misc"," * @function"," *"," * @description"," * Module contains misc methods"," */","","","/**"," * @ngdoc service"," * @name utils.misc#randomString"," * @methodOf utils.misc:misc"," * @function"," *"," * @description"," * Adapted from http://www.broofa.com/Tools/Math.uuid.js"," *"," * @param {String}  len   Length of the expected string"," * @return {String}       uuid string"," */","exports.randomString = function (len) {","  var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split(''),","      uuid  = [],","      radix = chars.length,","      i;","","  for (i = 0; i < len; i++) {","    uuid[i] = chars[0 | Math.random()*radix];","  }","  return uuid.join('');","};","","/**"," * @ngdoc service"," * @name utils.misc#parseWsMessage"," * @methodOf utils.misc:misc"," * @function"," *"," * @description"," * Parse incoming websocket messages into message type and contents"," *"," * @param  {String} msg Message to parse"," * @return {Array}      Array, where [0] is message type, [1] is message's body"," */","exports.parseWsMessage = function (msg) {","  var i;","  if ((i = msg.indexOf('|')) > 0) {","    return [msg.substr(0, i), msg.substr(i+1)];","  } else {","    throw new Error('Invalid message');","  }","};","","/**"," * @ngdoc service"," * @name utils.misc#extend"," * @methodOf utils.misc:misc"," * @function"," *"," * @description"," * Taken from underscore.js"," *"," * @param  {Object}     obj         Object to extend"," * @param  {<Objects>}  <objects>  to extend with"," * @return {Object}                 Extended object"," */","exports.extend = function (obj) {","  var source,","      prop,","      i;","","  for (i = 1; i < arguments.length; i++) {","    source = arguments[i];","    for (prop in source) {","      if (source.hasOwnProperty(prop)) {","        obj[prop] = source[prop];","      }","    }","  }","  return obj;","};","","/**"," * @ngdoc service"," * @name utils.misc#defaults"," * @methodOf utils.misc:misc"," * @function"," *"," * @description"," * Useful for declaring default parameter"," *"," * @param  {Object} args      Arguments"," * @param  {Object} defaults  Default arguments"," * @return {Object}           Extended object"," */","exports.defaults = function (args, defaults) {","  return exports.extend({}, defaults, args);","};",""],"l":{"27":1,"28":0,"33":0,"34":0,"36":0,"51":1,"52":0,"53":0,"54":0,"56":0,"73":1,"74":0,"78":0,"79":0,"80":0,"81":0,"82":0,"86":0,"102":1,"103":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/websocket/event_dispatcher.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/websocket/event_dispatcher.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},"b":{"1":[0,0,0,0],"2":[0,0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":64}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":31},"end":{"line":9,"column":45}}},"3":{"name":"andThen","line":15,"loc":{"start":{"line":15,"column":4},"end":{"line":15,"column":23}}},"4":{"name":"(anonymous_4)","line":18,"loc":{"start":{"line":18,"column":17},"end":{"line":18,"column":31}}},"5":{"name":"(anonymous_5)","line":22,"loc":{"start":{"line":22,"column":17},"end":{"line":22,"column":31}}},"6":{"name":"(anonymous_6)","line":26,"loc":{"start":{"line":26,"column":17},"end":{"line":26,"column":31}}},"7":{"name":"(anonymous_7)","line":30,"loc":{"start":{"line":30,"column":17},"end":{"line":30,"column":31}}},"8":{"name":"sendToMultiple","line":42,"loc":{"start":{"line":42,"column":0},"end":{"line":42,"column":55}}},"9":{"name":"(anonymous_9)","line":44,"loc":{"start":{"line":44,"column":23},"end":{"line":44,"column":45}}},"10":{"name":"(anonymous_10)","line":48,"loc":{"start":{"line":48,"column":40},"end":{"line":48,"column":59}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":47}},"2":{"start":{"line":8,"column":0},"end":{"line":36,"column":2}},"3":{"start":{"line":9,"column":2},"end":{"line":35,"column":5}},"4":{"start":{"line":10,"column":4},"end":{"line":10,"column":35}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":49}},"6":{"start":{"line":15,"column":4},"end":{"line":34,"column":5}},"7":{"start":{"line":16,"column":6},"end":{"line":33,"column":7}},"8":{"start":{"line":18,"column":10},"end":{"line":20,"column":12}},"9":{"start":{"line":19,"column":12},"end":{"line":19,"column":33}},"10":{"start":{"line":22,"column":10},"end":{"line":24,"column":12}},"11":{"start":{"line":23,"column":12},"end":{"line":23,"column":52}},"12":{"start":{"line":26,"column":10},"end":{"line":28,"column":12}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":70}},"14":{"start":{"line":30,"column":10},"end":{"line":32,"column":12}},"15":{"start":{"line":31,"column":12},"end":{"line":31,"column":64}},"16":{"start":{"line":42,"column":0},"end":{"line":56,"column":1}},"17":{"start":{"line":43,"column":2},"end":{"line":43,"column":81}},"18":{"start":{"line":44,"column":2},"end":{"line":54,"column":5}},"19":{"start":{"line":45,"column":4},"end":{"line":45,"column":23}},"20":{"start":{"line":46,"column":4},"end":{"line":46,"column":30}},"21":{"start":{"line":47,"column":4},"end":{"line":53,"column":5}},"22":{"start":{"line":48,"column":6},"end":{"line":52,"column":9}},"23":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"24":{"start":{"line":50,"column":10},"end":{"line":50,"column":45}},"25":{"start":{"line":55,"column":2},"end":{"line":55,"column":14}}},"branchMap":{"1":{"line":16,"type":"switch","locations":[{"start":{"line":17,"column":8},"end":{"line":20,"column":12}},{"start":{"line":21,"column":8},"end":{"line":24,"column":12}},{"start":{"line":25,"column":8},"end":{"line":28,"column":12}},{"start":{"line":29,"column":8},"end":{"line":32,"column":12}}]},"2":{"line":43,"type":"binary-expr","locations":[{"start":{"line":43,"column":17},"end":{"line":43,"column":46}},{"start":{"line":43,"column":50},"end":{"line":43,"column":62}},{"start":{"line":43,"column":66},"end":{"line":43,"column":80}}]},"3":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":4}},{"start":{"line":47,"column":4},"end":{"line":47,"column":4}}]},"4":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":49,"column":8}},{"start":{"line":49,"column":8},"end":{"line":49,"column":8}}]}},"code":["// Websocket Event Dispatcher","// --------------------------","// Delivers events to individual (or groups of) websocket IDs ","'use strict';","","var subscriptions = require('./subscriptions');","","module.exports = function(eventTransport, wsTransport, emitter) {","  return eventTransport.listen(function(obj) {","    var send = wsTransport.event();","","    // Emit message to the event responder (always Responder ID 0)    ","    return emitter.emit('0', obj, {}, andThen());","","    function andThen() {","      switch (obj.t) {","        case 'all':","          return function(msg) {","            return send.all(msg);","          };","        case 'socketId':","          return function(msg) {","            return send.socketId(obj.socketId, msg);","          };","        case 'channel':","          return function(msg) {","            return sendToMultiple(send, msg, obj.channels, 'channel');","          };","        case 'user':","          return function(msg) {","            return sendToMultiple(send, msg, obj.users, 'user');","          };","      }","    }","  });","};","","","// Private","","// Attempt to send the event to the socket. If socket no longer exists, remove it from set","function sendToMultiple(send, msg, destinations, type) {","  destinations = destinations instanceof Array && destinations || [destinations];","  destinations.forEach(function(destination) {","    var set, socketIds;","    set = subscriptions[type];","    if ((socketIds = set.members(destination))) {","      return socketIds.slice(0).forEach(function(socketId) {","        if (!send.socketId(socketId, msg, destination)) {","          return set.removeFromAll(socketId);","        }","      });","    }","  });","  return true;","}",""],"l":{"6":1,"8":1,"9":0,"10":0,"13":0,"15":1,"16":0,"18":0,"19":0,"22":0,"23":0,"26":0,"27":0,"30":0,"31":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"55":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/browserify.client.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/browserify.client.js","s":{"1":2,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":1,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":17},"end":{"line":3,"column":38}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":18},"end":{"line":21,"column":36}}},"3":{"name":"firstMatch","line":45,"loc":{"start":{"line":45,"column":2},"end":{"line":45,"column":24}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":16},"end":{"line":52,"column":36}}},"5":{"name":"(anonymous_5)","line":63,"loc":{"start":{"line":63,"column":31},"end":{"line":63,"column":46}}},"6":{"name":"(anonymous_6)","line":81,"loc":{"start":{"line":81,"column":17},"end":{"line":81,"column":41}}},"7":{"name":"(anonymous_7)","line":88,"loc":{"start":{"line":88,"column":19},"end":{"line":88,"column":35}}},"8":{"name":"(anonymous_8)","line":91,"loc":{"start":{"line":91,"column":23},"end":{"line":91,"column":39}}},"9":{"name":"(anonymous_9)","line":98,"loc":{"start":{"line":98,"column":32},"end":{"line":98,"column":44}}},"10":{"name":"(anonymous_10)","line":115,"loc":{"start":{"line":115,"column":43},"end":{"line":115,"column":55}}},"11":{"name":"(anonymous_11)","line":122,"loc":{"start":{"line":122,"column":43},"end":{"line":122,"column":57}}},"12":{"name":"(anonymous_12)","line":133,"loc":{"start":{"line":133,"column":11},"end":{"line":133,"column":25}}},"13":{"name":"(anonymous_13)","line":144,"loc":{"start":{"line":144,"column":40},"end":{"line":144,"column":56}}},"14":{"name":"(anonymous_14)","line":149,"loc":{"start":{"line":149,"column":32},"end":{"line":149,"column":44}}},"15":{"name":"(anonymous_15)","line":151,"loc":{"start":{"line":151,"column":23},"end":{"line":151,"column":59}}},"16":{"name":"filter","line":153,"loc":{"start":{"line":153,"column":2},"end":{"line":153,"column":27}}},"17":{"name":"normalizeArray","line":165,"loc":{"start":{"line":165,"column":2},"end":{"line":165,"column":49}}},"18":{"name":"(anonymous_18)","line":197,"loc":{"start":{"line":197,"column":20},"end":{"line":197,"column":31}}},"19":{"name":"(anonymous_19)","line":222,"loc":{"start":{"line":222,"column":64},"end":{"line":222,"column":76}}},"20":{"name":"(anonymous_20)","line":231,"loc":{"start":{"line":231,"column":22},"end":{"line":231,"column":37}}},"21":{"name":"(anonymous_21)","line":236,"loc":{"start":{"line":236,"column":50},"end":{"line":236,"column":62}}},"22":{"name":"(anonymous_22)","line":252,"loc":{"start":{"line":252,"column":17},"end":{"line":252,"column":28}}},"23":{"name":"(anonymous_23)","line":254,"loc":{"start":{"line":254,"column":43},"end":{"line":254,"column":55}}},"24":{"name":"(anonymous_24)","line":260,"loc":{"start":{"line":260,"column":20},"end":{"line":260,"column":35}}},"25":{"name":"(anonymous_25)","line":275,"loc":{"start":{"line":275,"column":21},"end":{"line":275,"column":41}}},"26":{"name":"(anonymous_26)","line":284,"loc":{"start":{"line":284,"column":20},"end":{"line":284,"column":35}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":10,"column":2}},"2":{"start":{"line":4,"column":4},"end":{"line":4,"column":53}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":72}},"4":{"start":{"line":6,"column":4},"end":{"line":8,"column":6}},"5":{"start":{"line":6,"column":14},"end":{"line":8,"column":6}},"6":{"start":{"line":9,"column":4},"end":{"line":9,"column":45}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":19}},"8":{"start":{"line":13,"column":0},"end":{"line":13,"column":21}},"9":{"start":{"line":15,"column":0},"end":{"line":19,"column":2}},"10":{"start":{"line":21,"column":0},"end":{"line":50,"column":2}},"11":{"start":{"line":22,"column":2},"end":{"line":22,"column":26}},"12":{"start":{"line":22,"column":14},"end":{"line":22,"column":24}},"13":{"start":{"line":24,"column":2},"end":{"line":24,"column":35}},"14":{"start":{"line":24,"column":25},"end":{"line":24,"column":34}},"15":{"start":{"line":25,"column":2},"end":{"line":25,"column":36}},"16":{"start":{"line":28,"column":2},"end":{"line":28,"column":28}},"17":{"start":{"line":29,"column":2},"end":{"line":31,"column":3}},"18":{"start":{"line":30,"column":4},"end":{"line":30,"column":46}},"19":{"start":{"line":34,"column":2},"end":{"line":34,"column":66}},"20":{"start":{"line":35,"column":2},"end":{"line":35,"column":56}},"21":{"start":{"line":37,"column":2},"end":{"line":40,"column":4}},"22":{"start":{"line":41,"column":2},"end":{"line":41,"column":34}},"23":{"start":{"line":41,"column":17},"end":{"line":41,"column":33}},"24":{"start":{"line":43,"column":2},"end":{"line":43,"column":69}},"25":{"start":{"line":45,"column":2},"end":{"line":49,"column":3}},"26":{"start":{"line":46,"column":4},"end":{"line":48,"column":5}},"27":{"start":{"line":47,"column":6},"end":{"line":47,"column":43}},"28":{"start":{"line":47,"column":32},"end":{"line":47,"column":41}},"29":{"start":{"line":52,"column":0},"end":{"line":79,"column":2}},"30":{"start":{"line":53,"column":4},"end":{"line":53,"column":38}},"31":{"start":{"line":54,"column":4},"end":{"line":54,"column":19}},"32":{"start":{"line":55,"column":4},"end":{"line":60,"column":5}},"33":{"start":{"line":56,"column":8},"end":{"line":56,"column":59}},"34":{"start":{"line":59,"column":8},"end":{"line":59,"column":41}},"35":{"start":{"line":61,"column":4},"end":{"line":61,"column":36}},"36":{"start":{"line":63,"column":4},"end":{"line":67,"column":24}},"37":{"start":{"line":64,"column":8},"end":{"line":64,"column":21}},"38":{"start":{"line":65,"column":8},"end":{"line":65,"column":42}},"39":{"start":{"line":65,"column":29},"end":{"line":65,"column":42}},"40":{"start":{"line":66,"column":8},"end":{"line":66,"column":19}},"41":{"start":{"line":69,"column":4},"end":{"line":78,"column":5}},"42":{"start":{"line":70,"column":8},"end":{"line":70,"column":26}},"43":{"start":{"line":71,"column":8},"end":{"line":77,"column":9}},"44":{"start":{"line":72,"column":12},"end":{"line":72,"column":46}},"45":{"start":{"line":73,"column":12},"end":{"line":73,"column":67}},"46":{"start":{"line":75,"column":13},"end":{"line":77,"column":9}},"47":{"start":{"line":76,"column":12},"end":{"line":76,"column":59}},"48":{"start":{"line":81,"column":0},"end":{"line":111,"column":2}},"49":{"start":{"line":83,"column":4},"end":{"line":86,"column":5}},"50":{"start":{"line":88,"column":4},"end":{"line":90,"column":6}},"51":{"start":{"line":89,"column":8},"end":{"line":89,"column":37}},"52":{"start":{"line":91,"column":4},"end":{"line":93,"column":6}},"53":{"start":{"line":92,"column":8},"end":{"line":92,"column":46}},"54":{"start":{"line":94,"column":4},"end":{"line":94,"column":39}},"55":{"start":{"line":95,"column":4},"end":{"line":95,"column":37}},"56":{"start":{"line":96,"column":4},"end":{"line":96,"column":35}},"57":{"start":{"line":98,"column":4},"end":{"line":110,"column":6}},"58":{"start":{"line":99,"column":8},"end":{"line":99,"column":60}},"59":{"start":{"line":100,"column":8},"end":{"line":107,"column":10}},"60":{"start":{"line":108,"column":8},"end":{"line":108,"column":60}},"61":{"start":{"line":109,"column":8},"end":{"line":109,"column":31}},"62":{"start":{"line":113,"column":0},"end":{"line":113,"column":49}},"63":{"start":{"line":113,"column":36},"end":{"line":113,"column":49}},"64":{"start":{"line":115,"column":0},"end":{"line":140,"column":5}},"65":{"start":{"line":115,"column":23},"end":{"line":140,"column":5}},"66":{"start":{"line":116,"column":4},"end":{"line":116,"column":19}},"67":{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},"68":{"start":{"line":121,"column":4},"end":{"line":131,"column":5}},"69":{"start":{"line":122,"column":8},"end":{"line":130,"column":17}},"70":{"start":{"line":123,"column":12},"end":{"line":129,"column":13}},"71":{"start":{"line":124,"column":16},"end":{"line":124,"column":37}},"72":{"start":{"line":125,"column":16},"end":{"line":128,"column":17}},"73":{"start":{"line":126,"column":20},"end":{"line":126,"column":43}},"74":{"start":{"line":127,"column":20},"end":{"line":127,"column":25}},"75":{"start":{"line":133,"column":4},"end":{"line":139,"column":6}},"76":{"start":{"line":134,"column":8},"end":{"line":138,"column":31}},"77":{"start":{"line":135,"column":12},"end":{"line":135,"column":27}},"78":{"start":{"line":136,"column":12},"end":{"line":136,"column":55}},"79":{"start":{"line":138,"column":13},"end":{"line":138,"column":31}},"80":{"start":{"line":142,"column":0},"end":{"line":142,"column":46}},"81":{"start":{"line":142,"column":20},"end":{"line":142,"column":46}},"82":{"start":{"line":144,"column":0},"end":{"line":147,"column":2}},"83":{"start":{"line":144,"column":22},"end":{"line":147,"column":2}},"84":{"start":{"line":145,"column":4},"end":{"line":146,"column":42}},"85":{"start":{"line":145,"column":26},"end":{"line":145,"column":46}},"86":{"start":{"line":146,"column":9},"end":{"line":146,"column":42}},"87":{"start":{"line":149,"column":0},"end":{"line":149,"column":59}},"88":{"start":{"line":149,"column":18},"end":{"line":149,"column":59}},"89":{"start":{"line":149,"column":46},"end":{"line":149,"column":57}},"90":{"start":{"line":151,"column":0},"end":{"line":288,"column":3}},"91":{"start":{"line":153,"column":2},"end":{"line":159,"column":3}},"92":{"start":{"line":154,"column":6},"end":{"line":154,"column":19}},"93":{"start":{"line":155,"column":6},"end":{"line":157,"column":7}},"94":{"start":{"line":156,"column":10},"end":{"line":156,"column":48}},"95":{"start":{"line":156,"column":32},"end":{"line":156,"column":48}},"96":{"start":{"line":158,"column":6},"end":{"line":158,"column":17}},"97":{"start":{"line":165,"column":2},"end":{"line":189,"column":3}},"98":{"start":{"line":167,"column":4},"end":{"line":167,"column":15}},"99":{"start":{"line":168,"column":4},"end":{"line":179,"column":5}},"100":{"start":{"line":169,"column":6},"end":{"line":169,"column":26}},"101":{"start":{"line":170,"column":6},"end":{"line":178,"column":7}},"102":{"start":{"line":171,"column":8},"end":{"line":171,"column":27}},"103":{"start":{"line":172,"column":13},"end":{"line":178,"column":7}},"104":{"start":{"line":173,"column":8},"end":{"line":173,"column":27}},"105":{"start":{"line":174,"column":8},"end":{"line":174,"column":13}},"106":{"start":{"line":175,"column":13},"end":{"line":178,"column":7}},"107":{"start":{"line":176,"column":8},"end":{"line":176,"column":27}},"108":{"start":{"line":177,"column":8},"end":{"line":177,"column":13}},"109":{"start":{"line":182,"column":4},"end":{"line":186,"column":5}},"110":{"start":{"line":183,"column":6},"end":{"line":185,"column":7}},"111":{"start":{"line":184,"column":8},"end":{"line":184,"column":28}},"112":{"start":{"line":188,"column":4},"end":{"line":188,"column":17}},"113":{"start":{"line":193,"column":2},"end":{"line":193,"column":60}},"114":{"start":{"line":197,"column":2},"end":{"line":227,"column":4}},"115":{"start":{"line":198,"column":2},"end":{"line":199,"column":31}},"116":{"start":{"line":201,"column":2},"end":{"line":213,"column":3}},"117":{"start":{"line":202,"column":4},"end":{"line":204,"column":24}},"118":{"start":{"line":207,"column":4},"end":{"line":209,"column":5}},"119":{"start":{"line":208,"column":6},"end":{"line":208,"column":15}},"120":{"start":{"line":211,"column":4},"end":{"line":211,"column":45}},"121":{"start":{"line":212,"column":4},"end":{"line":212,"column":46}},"122":{"start":{"line":216,"column":2},"end":{"line":216,"column":52}},"123":{"start":{"line":222,"column":2},"end":{"line":224,"column":37}},"124":{"start":{"line":223,"column":6},"end":{"line":223,"column":17}},"125":{"start":{"line":226,"column":4},"end":{"line":226,"column":65}},"126":{"start":{"line":231,"column":2},"end":{"line":248,"column":4}},"127":{"start":{"line":232,"column":4},"end":{"line":233,"column":47}},"128":{"start":{"line":236,"column":4},"end":{"line":238,"column":31}},"129":{"start":{"line":237,"column":6},"end":{"line":237,"column":17}},"130":{"start":{"line":240,"column":4},"end":{"line":242,"column":5}},"131":{"start":{"line":241,"column":6},"end":{"line":241,"column":17}},"132":{"start":{"line":243,"column":4},"end":{"line":245,"column":5}},"133":{"start":{"line":244,"column":6},"end":{"line":244,"column":18}},"134":{"start":{"line":247,"column":4},"end":{"line":247,"column":42}},"135":{"start":{"line":252,"column":2},"end":{"line":257,"column":4}},"136":{"start":{"line":253,"column":4},"end":{"line":253,"column":57}},"137":{"start":{"line":254,"column":4},"end":{"line":256,"column":18}},"138":{"start":{"line":255,"column":6},"end":{"line":255,"column":40}},"139":{"start":{"line":260,"column":2},"end":{"line":272,"column":4}},"140":{"start":{"line":261,"column":4},"end":{"line":261,"column":46}},"141":{"start":{"line":262,"column":4},"end":{"line":271,"column":5}},"142":{"start":{"line":264,"column":6},"end":{"line":264,"column":17}},"143":{"start":{"line":265,"column":11},"end":{"line":271,"column":5}},"144":{"start":{"line":267,"column":6},"end":{"line":267,"column":17}},"145":{"start":{"line":270,"column":6},"end":{"line":270,"column":46}},"146":{"start":{"line":275,"column":2},"end":{"line":281,"column":4}},"147":{"start":{"line":276,"column":4},"end":{"line":276,"column":44}},"148":{"start":{"line":277,"column":4},"end":{"line":279,"column":5}},"149":{"start":{"line":278,"column":6},"end":{"line":278,"column":45}},"150":{"start":{"line":280,"column":4},"end":{"line":280,"column":13}},"151":{"start":{"line":284,"column":2},"end":{"line":286,"column":4}},"152":{"start":{"line":285,"column":4},"end":{"line":285,"column":43}}},"branchMap":{"1":{"line":4,"type":"binary-expr","locations":[{"start":{"line":4,"column":41},"end":{"line":4,"column":44}},{"start":{"line":4,"column":48},"end":{"line":4,"column":51}}]},"2":{"line":5,"type":"binary-expr","locations":[{"start":{"line":5,"column":14},"end":{"line":5,"column":39}},{"start":{"line":5,"column":43},"end":{"line":5,"column":71}}]},"3":{"line":6,"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":6,"column":4}},{"start":{"line":6,"column":4},"end":{"line":6,"column":4}}]},"4":{"line":9,"type":"cond-expr","locations":[{"start":{"line":9,"column":25},"end":{"line":9,"column":36}},{"start":{"line":9,"column":39},"end":{"line":9,"column":44}}]},"5":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":2},"end":{"line":22,"column":2}},{"start":{"line":22,"column":2},"end":{"line":22,"column":2}}]},"6":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":24,"column":2}},{"start":{"line":24,"column":2},"end":{"line":24,"column":2}}]},"7":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"8":{"line":34,"type":"cond-expr","locations":[{"start":{"line":34,"column":28},"end":{"line":34,"column":61}},{"start":{"line":34,"column":64},"end":{"line":34,"column":65}}]},"9":{"line":35,"type":"cond-expr","locations":[{"start":{"line":35,"column":32},"end":{"line":35,"column":51}},{"start":{"line":35,"column":54},"end":{"line":35,"column":55}}]},"10":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":2},"end":{"line":41,"column":2}},{"start":{"line":41,"column":2},"end":{"line":41,"column":2}}]},"11":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":6},"end":{"line":47,"column":6}},{"start":{"line":47,"column":6},"end":{"line":47,"column":6}}]},"12":{"line":63,"type":"binary-expr","locations":[{"start":{"line":63,"column":16},"end":{"line":63,"column":27}},{"start":{"line":63,"column":31},"end":{"line":67,"column":5}}]},"13":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":8},"end":{"line":71,"column":8}},{"start":{"line":71,"column":8},"end":{"line":71,"column":8}}]},"14":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":13},"end":{"line":75,"column":13}},{"start":{"line":75,"column":13},"end":{"line":75,"column":13}}]},"15":{"line":83,"type":"cond-expr","locations":[{"start":{"line":84,"column":10},"end":{"line":84,"column":12}},{"start":{"line":85,"column":10},"end":{"line":85,"column":50}}]},"16":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":0},"end":{"line":113,"column":0}},{"start":{"line":113,"column":0},"end":{"line":113,"column":0}}]},"17":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":0},"end":{"line":115,"column":0}},{"start":{"line":115,"column":0},"end":{"line":115,"column":0}}]},"18":{"line":117,"type":"binary-expr","locations":[{"start":{"line":117,"column":18},"end":{"line":117,"column":47}},{"start":{"line":118,"column":11},"end":{"line":118,"column":29}},{"start":{"line":118,"column":33},"end":{"line":118,"column":56}}]},"19":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":4},"end":{"line":121,"column":4}},{"start":{"line":121,"column":4},"end":{"line":121,"column":4}}]},"20":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":12},"end":{"line":123,"column":12}},{"start":{"line":123,"column":12},"end":{"line":123,"column":12}}]},"21":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":16},"end":{"line":123,"column":36}},{"start":{"line":123,"column":40},"end":{"line":123,"column":69}}]},"22":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":16},"end":{"line":125,"column":16}},{"start":{"line":125,"column":16},"end":{"line":125,"column":16}}]},"23":{"line":134,"type":"if","locations":[{"start":{"line":134,"column":8},"end":{"line":134,"column":8}},{"start":{"line":134,"column":8},"end":{"line":134,"column":8}}]},"24":{"line":142,"type":"if","locations":[{"start":{"line":142,"column":0},"end":{"line":142,"column":0}},{"start":{"line":142,"column":0},"end":{"line":142,"column":0}}]},"25":{"line":144,"type":"if","locations":[{"start":{"line":144,"column":0},"end":{"line":144,"column":0}},{"start":{"line":144,"column":0},"end":{"line":144,"column":0}}]},"26":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":4},"end":{"line":145,"column":4}},{"start":{"line":145,"column":4},"end":{"line":145,"column":4}}]},"27":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":0},"end":{"line":149,"column":0}},{"start":{"line":149,"column":0},"end":{"line":149,"column":0}}]},"28":{"line":156,"type":"if","locations":[{"start":{"line":156,"column":10},"end":{"line":156,"column":10}},{"start":{"line":156,"column":10},"end":{"line":156,"column":10}}]},"29":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":6},"end":{"line":170,"column":6}},{"start":{"line":170,"column":6},"end":{"line":170,"column":6}}]},"30":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":13},"end":{"line":172,"column":13}},{"start":{"line":172,"column":13},"end":{"line":172,"column":13}}]},"31":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":13},"end":{"line":175,"column":13}},{"start":{"line":175,"column":13},"end":{"line":175,"column":13}}]},"32":{"line":182,"type":"if","locations":[{"start":{"line":182,"column":4},"end":{"line":182,"column":4}},{"start":{"line":182,"column":4},"end":{"line":182,"column":4}}]},"33":{"line":201,"type":"binary-expr","locations":[{"start":{"line":201,"column":33},"end":{"line":201,"column":40}},{"start":{"line":201,"column":44},"end":{"line":201,"column":61}}]},"34":{"line":202,"type":"cond-expr","locations":[{"start":{"line":203,"column":10},"end":{"line":203,"column":22}},{"start":{"line":204,"column":10},"end":{"line":204,"column":23}}]},"35":{"line":207,"type":"if","locations":[{"start":{"line":207,"column":4},"end":{"line":207,"column":4}},{"start":{"line":207,"column":4},"end":{"line":207,"column":4}}]},"36":{"line":207,"type":"binary-expr","locations":[{"start":{"line":207,"column":8},"end":{"line":207,"column":32}},{"start":{"line":207,"column":36},"end":{"line":207,"column":41}}]},"37":{"line":226,"type":"binary-expr","locations":[{"start":{"line":226,"column":12},"end":{"line":226,"column":56}},{"start":{"line":226,"column":61},"end":{"line":226,"column":64}}]},"38":{"line":226,"type":"cond-expr","locations":[{"start":{"line":226,"column":32},"end":{"line":226,"column":35}},{"start":{"line":226,"column":38},"end":{"line":226,"column":40}}]},"39":{"line":240,"type":"if","locations":[{"start":{"line":240,"column":4},"end":{"line":240,"column":4}},{"start":{"line":240,"column":4},"end":{"line":240,"column":4}}]},"40":{"line":240,"type":"binary-expr","locations":[{"start":{"line":240,"column":8},"end":{"line":240,"column":13}},{"start":{"line":240,"column":17},"end":{"line":240,"column":28}}]},"41":{"line":243,"type":"if","locations":[{"start":{"line":243,"column":4},"end":{"line":243,"column":4}},{"start":{"line":243,"column":4},"end":{"line":243,"column":4}}]},"42":{"line":243,"type":"binary-expr","locations":[{"start":{"line":243,"column":8},"end":{"line":243,"column":12}},{"start":{"line":243,"column":16},"end":{"line":243,"column":29}}]},"43":{"line":247,"type":"cond-expr","locations":[{"start":{"line":247,"column":25},"end":{"line":247,"column":28}},{"start":{"line":247,"column":31},"end":{"line":247,"column":33}}]},"44":{"line":255,"type":"binary-expr","locations":[{"start":{"line":255,"column":13},"end":{"line":255,"column":14}},{"start":{"line":255,"column":18},"end":{"line":255,"column":39}}]},"45":{"line":261,"type":"binary-expr","locations":[{"start":{"line":261,"column":14},"end":{"line":261,"column":39}},{"start":{"line":261,"column":43},"end":{"line":261,"column":45}}]},"46":{"line":262,"type":"if","locations":[{"start":{"line":262,"column":4},"end":{"line":262,"column":4}},{"start":{"line":262,"column":4},"end":{"line":262,"column":4}}]},"47":{"line":265,"type":"if","locations":[{"start":{"line":265,"column":11},"end":{"line":265,"column":11}},{"start":{"line":265,"column":11},"end":{"line":265,"column":11}}]},"48":{"line":276,"type":"binary-expr","locations":[{"start":{"line":276,"column":12},"end":{"line":276,"column":37}},{"start":{"line":276,"column":41},"end":{"line":276,"column":43}}]},"49":{"line":277,"type":"if","locations":[{"start":{"line":277,"column":4},"end":{"line":277,"column":4}},{"start":{"line":277,"column":4},"end":{"line":277,"column":4}}]},"50":{"line":277,"type":"binary-expr","locations":[{"start":{"line":277,"column":8},"end":{"line":277,"column":11}},{"start":{"line":277,"column":15},"end":{"line":277,"column":48}}]},"51":{"line":285,"type":"binary-expr","locations":[{"start":{"line":285,"column":11},"end":{"line":285,"column":36}},{"start":{"line":285,"column":40},"end":{"line":285,"column":42}}]}},"code":["// Module loading code from Browserify: https://github.com/substack/node-browserify","","window.require = function (file, cwd) {","    var resolved = require.resolve(file, cwd || '/');","    var mod = require.modules[resolved] || require.initModule(resolved);","    if (!mod) throw new Error(","        'Failed to resolve module ' + file + ', tried ' + resolved","    );","    return mod._cached ? mod._cached : mod();","};","","require.paths = [];","require.modules = {};","","require._core = {","    'events': true, // FUTURE_WORK, support events?","    'path': true,","    'vm': true // FUTURE_WORK, support vm ?","};","","require.resolve = function (x, cwd) {","  if (!cwd) { cwd = '/'; }","","  if (require._core[x]) {return x;}","  var path = require.modules.path();","","  // strip extension","  var ext = path.extname(x);","  if (ext) {","    x = x.substring(0, x.length - ext.length);","  }","","  // paths are ../ or ./ or /","  x = x.charAt(0) === '/' ? path.resolve(cwd, x.substring(1)) : x;","  x = x.match(/^(?:\\.\\.?\\/)/) ? path.resolve(cwd,x) : x;","","  var resolved = firstMatch(","    x, // as a file","    path.join(x,'index') // as a directory","  );","  if (resolved) {return resolved;}","","  throw new Error(\"Cannot find module '\" + x + \"' within '\"+cwd+\"'\");","","  function firstMatch() {","    for(var i= 0,a; (a = arguments[i]); ++i) {","      if (require.modules[a]) { return a; }","    }","  }","};","","require.alias = function (from, to) {","    var path = require.modules.path();","    var res = null;","    try {","        res = require.resolve(from + '/package.json', '/');","    }","    catch (err) {","        res = require.resolve(from, '/');","    }","    var basedir = path.dirname(res);","","    var keys = (Object.keys || function (obj) {","        var res = [];","        for (var key in obj) res.push(key)","        return res;","    })(require.modules);","","    for (var i = 0; i < keys.length; i++) {","        var key = keys[i];","        if (key.slice(0, basedir.length + 1) === basedir + '/') {","            var f = key.slice(basedir.length);","            require.modules[to + f] = require.modules[basedir + f];","        }","        else if (key === basedir) {","            require.modules[to] = require.modules[basedir];","        }","    }","};","","require.define = function (filename, fn) {","    //if (filename.substring(0,3) === '/./') { filename = filename.substring(2); }","    var dirname = require._core[filename]","        ? ''","        : require.modules.path().dirname(filename)","    ;","","    var require_ = function (file) {","        return require(file, dirname)","    };","    require_.resolve = function (name) {","        return require.resolve(name, dirname);","    };","    require_.modules = require.modules;","    require_.define = require.define;","    var module_ = { exports : {} };","","    require.modules[filename] = function () {","        require.modules[filename]._cached = module_.exports;","        fn.call(","            module_.exports,","            require_,","            module_,","            module_.exports,","            dirname,","            filename","        );","        require.modules[filename]._cached = module_.exports;","        return module_.exports;","    };","};","","if (typeof process === 'undefined') process = {};","","if (!process.nextTick) process.nextTick = (function () {","    var queue = [];","    var canPost = typeof window !== 'undefined'","        && window.postMessage && window.addEventListener","    ;","","    if (canPost) {","        window.addEventListener('message', function (ev) {","            if (ev.source === window && ev.data === 'browserify-tick') {","                ev.stopPropagation();","                if (queue.length > 0) {","                    var fn = queue.shift();","                    fn();","                }","            }","        }, true);","    }","","    return function (fn) {","        if (canPost) {","            queue.push(fn);","            window.postMessage('browserify-tick', '*');","        }","        else setTimeout(fn, 0);","    };","})();","","if (!process.title) process.title = 'browser';","","if (!process.binding) process.binding = function (name) {","    if (name === 'evals') return require('vm')","    else throw new Error('No such module')","};","","if (!process.cwd) process.cwd = function () { return '.' };","","require.define(\"path\", function (require, module, exports) {","  // deprecated. Array.filter will be used in the future ES5 shim required for older browsers.","  function filter (xs, fn) {","      var res = [];","      for (var i = 0; i < xs.length; i++) {","          if (fn(xs[i], i, xs)) res.push(xs[i]);","      }","      return res;","  }","","  // resolves . and .. elements in a path array with directory names there","  // must be no slashes, empty elements, or device names (c:\\) in the array","  // (so also no leading and trailing slashes - it does not distinguish","  // relative and absolute paths)","  function normalizeArray(parts, allowAboveRoot) {","    // if the path tries to go above the root, `up` ends up > 0","    var up = 0;","    for (var i = parts.length; i >= 0; i--) {","      var last = parts[i];","      if (last == '.') {","        parts.splice(i, 1);","      } else if (last === '..') {","        parts.splice(i, 1);","        up++;","      } else if (up) {","        parts.splice(i, 1);","        up--;","      }","    }","","    // if the path is allowed to go above the root, restore leading ..s","    if (allowAboveRoot) {","      for (; up--; up) {","        parts.unshift('..');","      }","    }","","    return parts;","  }","","  // Regex to split a filename into [*, dir, basename, ext]","  // posix version","  var splitPathRe = /^(.+\\/(?!$)|\\/)?((?:.+?)?(\\.[^.]*)?)$/;","","  // path.resolve([from ...], to)","  // posix version","  exports.resolve = function() {","  var resolvedPath = '',","      resolvedAbsolute = false;","","  for (var i = arguments.length; i >= -1 && !resolvedAbsolute; i--) {","    var path = (i >= 0)","        ? arguments[i]","        : process.cwd();","","    // Skip empty and invalid entries","    if (typeof path !== 'string' || !path) {","      continue;","    }","","    resolvedPath = path + '/' + resolvedPath;","    resolvedAbsolute = path.charAt(0) === '/';","  }","","  // collapse . access","  resolvedPath = resolvedPath.replace(/\\/\\.\\//,'/');","","  // At this point the path should be resolved to a full absolute path, but","  // handle relative paths to be safe (might happen when process.cwd() fails)","","  // Normalize the path","  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {","      return !!p;","    }), !resolvedAbsolute).join('/');","","    return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';","  };","","  // path.normalize(path)","  // posix version","  exports.normalize = function(path) {","    var isAbsolute = path.charAt(0) === '/',","        trailingSlash = path.slice(-1) === '/';","","    // Normalize the path","    path = normalizeArray(filter(path.split('/'), function(p) {","      return !!p;","    }), !isAbsolute).join('/');","","    if (!path && !isAbsolute) {","      path = '.';","    }","    if (path && trailingSlash) {","      path += '/';","    }","","    return (isAbsolute ? '/' : '') + path;","  };","","","  // posix version","  exports.join = function() {","    var paths = Array.prototype.slice.call(arguments, 0);","    return exports.normalize(filter(paths, function(p) {","      return p && typeof p === 'string';","    }).join('/'));","  };","","","  exports.dirname = function(path) {","    var dir = splitPathRe.exec(path)[1] || '';","    if (!dir) {","      // No dirname","      return '.';","    } else if (dir === '/') {","      // It is just a slash or a drive letter with a slash","      return dir;","    } else {","      // It is a full dirname, strip trailing slash","      return dir.substring(0, dir.length - 1);","    }","  };","","","  exports.basename = function(path, ext) {","    var f = splitPathRe.exec(path)[2] || '';","    if (ext && f.substr(-1 * ext.length) === ext) {","      f = f.substr(0, f.length - ext.length);","    }","    return f;","  };","","","  exports.extname = function(path) {","    return splitPathRe.exec(path)[3] || '';","  };","","});",""],"l":{"3":2,"4":0,"5":0,"6":0,"9":0,"12":0,"13":0,"15":0,"21":0,"22":0,"24":0,"25":0,"28":0,"29":0,"30":0,"34":0,"35":0,"37":0,"41":0,"43":0,"45":1,"46":0,"47":0,"52":0,"53":0,"54":0,"55":0,"56":0,"59":0,"61":0,"63":0,"64":0,"65":0,"66":0,"69":0,"70":0,"71":0,"72":0,"73":0,"75":0,"76":0,"81":0,"83":0,"88":0,"89":0,"91":0,"92":0,"94":0,"95":0,"96":0,"98":0,"99":0,"100":0,"108":0,"109":0,"113":0,"115":0,"116":0,"117":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"133":0,"134":0,"135":0,"136":0,"138":0,"142":0,"144":0,"145":0,"146":0,"149":0,"151":0,"153":1,"154":0,"155":0,"156":0,"158":0,"165":1,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"182":0,"183":0,"184":0,"188":0,"193":0,"197":0,"198":0,"201":0,"202":0,"207":0,"208":0,"211":0,"212":0,"216":0,"222":0,"223":0,"226":0,"231":0,"232":0,"236":0,"237":0,"240":0,"241":0,"243":0,"244":0,"247":0,"252":0,"253":0,"254":0,"255":0,"260":0,"261":0,"262":0,"264":0,"265":0,"267":0,"270":0,"275":0,"276":0,"277":0,"278":0,"280":0,"284":0,"285":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/default.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/default.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"includeFlags","line":4,"loc":{"start":{"line":4,"column":0},"end":{"line":4,"column":33}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":17},"end":{"line":33,"column":44}}},"3":{"name":"define","line":42,"loc":{"start":{"line":42,"column":2},"end":{"line":42,"column":25}}},"4":{"name":"asset","line":60,"loc":{"start":{"line":60,"column":2},"end":{"line":60,"column":34}}},"5":{"name":"(anonymous_5)","line":62,"loc":{"start":{"line":62,"column":6},"end":{"line":62,"column":23}}},"6":{"name":"(anonymous_6)","line":84,"loc":{"start":{"line":84,"column":6},"end":{"line":84,"column":20}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":15,"column":1}},"2":{"start":{"line":5,"column":2},"end":{"line":10,"column":4}},"3":{"start":{"line":11,"column":2},"end":{"line":13,"column":3}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":59}},"5":{"start":{"line":12,"column":30},"end":{"line":12,"column":57}},"6":{"start":{"line":14,"column":2},"end":{"line":14,"column":18}},"7":{"start":{"line":33,"column":0},"end":{"line":96,"column":2}},"8":{"start":{"line":35,"column":2},"end":{"line":38,"column":5}},"9":{"start":{"line":39,"column":2},"end":{"line":39,"column":17}},"10":{"start":{"line":42,"column":2},"end":{"line":57,"column":3}},"11":{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},"12":{"start":{"line":45,"column":6},"end":{"line":45,"column":132}},"13":{"start":{"line":47,"column":4},"end":{"line":49,"column":5}},"14":{"start":{"line":48,"column":6},"end":{"line":48,"column":115}},"15":{"start":{"line":52,"column":4},"end":{"line":52,"column":49}},"16":{"start":{"line":53,"column":4},"end":{"line":53,"column":51}},"17":{"start":{"line":54,"column":4},"end":{"line":54,"column":55}},"18":{"start":{"line":55,"column":4},"end":{"line":55,"column":33}},"19":{"start":{"line":56,"column":4},"end":{"line":56,"column":61}},"20":{"start":{"line":60,"column":2},"end":{"line":95,"column":3}},"21":{"start":{"line":61,"column":4},"end":{"line":94,"column":9}},"22":{"start":{"line":63,"column":8},"end":{"line":82,"column":9}},"23":{"start":{"line":65,"column":12},"end":{"line":65,"column":66}},"24":{"start":{"line":67,"column":12},"end":{"line":67,"column":55}},"25":{"start":{"line":70,"column":12},"end":{"line":72,"column":13}},"26":{"start":{"line":71,"column":14},"end":{"line":71,"column":67}},"27":{"start":{"line":73,"column":12},"end":{"line":73,"column":18}},"28":{"start":{"line":77,"column":12},"end":{"line":77,"column":59}},"29":{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},"30":{"start":{"line":79,"column":14},"end":{"line":79,"column":67}},"31":{"start":{"line":81,"column":12},"end":{"line":81,"column":30}},"32":{"start":{"line":85,"column":8},"end":{"line":85,"column":53}},"33":{"start":{"line":86,"column":8},"end":{"line":93,"column":9}},"34":{"start":{"line":88,"column":12},"end":{"line":88,"column":75}},"35":{"start":{"line":90,"column":12},"end":{"line":90,"column":84}},"36":{"start":{"line":92,"column":12},"end":{"line":92,"column":78}}},"branchMap":{"1":{"line":11,"type":"if","locations":[{"start":{"line":11,"column":2},"end":{"line":11,"column":2}},{"start":{"line":11,"column":2},"end":{"line":11,"column":2}}]},"2":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":44,"column":4}},{"start":{"line":44,"column":4},"end":{"line":44,"column":4}}]},"3":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":4}},{"start":{"line":47,"column":4},"end":{"line":47,"column":4}}]},"4":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":23},"end":{"line":54,"column":38}},{"start":{"line":54,"column":42},"end":{"line":54,"column":54}}]},"5":{"line":63,"type":"switch","locations":[{"start":{"line":64,"column":10},"end":{"line":65,"column":66}},{"start":{"line":66,"column":10},"end":{"line":67,"column":55}},{"start":{"line":68,"column":10},"end":{"line":73,"column":18}},{"start":{"line":75,"column":10},"end":{"line":81,"column":30}}]},"6":{"line":67,"type":"cond-expr","locations":[{"start":{"line":67,"column":44},"end":{"line":67,"column":50}},{"start":{"line":67,"column":51},"end":{"line":67,"column":53}}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":12},"end":{"line":70,"column":12}},{"start":{"line":70,"column":12},"end":{"line":70,"column":12}}]},"8":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":16},"end":{"line":70,"column":29}},{"start":{"line":70,"column":33},"end":{"line":70,"column":66}}]},"9":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":12},"end":{"line":78,"column":12}},{"start":{"line":78,"column":12},"end":{"line":78,"column":12}}]},"10":{"line":78,"type":"binary-expr","locations":[{"start":{"line":78,"column":16},"end":{"line":78,"column":29}},{"start":{"line":78,"column":33},"end":{"line":78,"column":66}}]},"11":{"line":86,"type":"switch","locations":[{"start":{"line":87,"column":10},"end":{"line":88,"column":75}},{"start":{"line":89,"column":10},"end":{"line":90,"column":84}},{"start":{"line":91,"column":10},"end":{"line":92,"column":78}}]}},"code":["// Default bundler implementation","'use strict';","","function includeFlags(overrides) {","  var includes = {","    css: true,","    html: true,","    system: true,","    initCode: true","  };","  if (overrides) {","    for(var n in overrides) { includes[n] = overrides[n]; }","  }","  return includes;","}","","/**"," * @typedef { name:string, path:string, dir:string, content:string, options:string, type:string } AssetEntry"," */","","/**"," * @ngdoc service"," * @name bundler.default:default"," * @function"," *"," * @description"," *  The default bundler of HTML, CSS & JS"," *"," * @type {{define: define, load: load, toMinifiedCSS: toMinifiedCSS, toMinifiedJS: toMinifiedJS, asset: {"," *  entries: entries, loader: assetLoader, systemModule: systemModule, js: assetJS, worker: assetWorker, start: assetStart,"," *  css: assetCSS, html: assetHTML}}}"," */","module.exports = function(ss,client,options){","","  var bundler = ss.bundler.create({","    define: define,","    asset: asset","  });","  return bundler;","","","  function define(paths) {","","    if (typeof paths.view !== 'string') {","      throw new Error('You may only define one HTML view per single-page client. Please pass a filename as a string, not an Array');","    }","    if (paths.view.lastIndexOf('.') <= 0) {","      throw new Error('The \\'' + paths.view + '\\' view must have a valid HTML extension (such as .html or .jade)');","    }","","    // Define new client object","    client.paths = ss.bundler.sourcePaths(paths); //TODO how to handle root being deeper than node_modules","    client.includes = includeFlags(paths.includes);","    client.constants = paths.constants || paths.consts;","    client.locals = paths.locals;","    client.entryInitPath = ss.bundler.findEntryPoint(client);","  }","","  //TODO callback(err,output) for pack to flag error","  function asset(entry, opts, cb) {","    ss.bundler.loadFile(entry, opts, null,","      function(output) {","        switch(entry.bundle) {","          case 'html':","            return cb(ss.bundler.injectTailIfNeeded(output,opts));","          case 'css':","            return cb( client.includes.css? output:'');","          case 'worker':","            //TODO","            if (opts.compress && entry.file.indexOf('.min') === -1) {","              output = ss.bundler.minifyJSFile(output, entry.file);","            }","            break;","","          default:","            //TODO with options compress saved to avoid double compression","            output = bundler.wrapCode(output, entry, opts);","            if (opts.compress && entry.file.indexOf('.min') === -1) {","              output = ss.bundler.minifyJSFile(output, entry.file);","            }","            return cb(output);","        }","      },","      function(err) {","        ss.log.clientIssue(client,options,err,entry);","        switch(entry.ext) {","          case 'html':","            return cb('Couldn\\'t format ' + entry.file + err.userInfoHTML);","          case 'css':","            return cb('/* couldn\\'t format ' + entry.file + err.userInfoText+' */');","          default:","            return cb('// couldn\\'t format ' + entry.file + err.userInfoText);","        }","      });","  }","};",""],"l":{"4":1,"5":0,"11":0,"12":0,"14":0,"33":1,"35":0,"39":0,"42":1,"44":0,"45":0,"47":0,"48":0,"52":0,"53":0,"54":0,"55":0,"56":0,"60":1,"61":0,"63":0,"65":0,"67":0,"70":0,"71":0,"73":0,"77":0,"78":0,"79":0,"81":0,"85":0,"86":0,"88":0,"90":0,"92":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/production.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/bundler/production.js","s":{"1":1,"2":0,"3":0,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":17},"end":{"line":5,"column":44}}},"2":{"name":"define","line":14,"loc":{"start":{"line":14,"column":2},"end":{"line":14,"column":25}}},"3":{"name":"asset","line":31,"loc":{"start":{"line":31,"column":2},"end":{"line":31,"column":34}}},"4":{"name":"(anonymous_4)","line":33,"loc":{"start":{"line":33,"column":6},"end":{"line":33,"column":23}}},"5":{"name":"(anonymous_5)","line":55,"loc":{"start":{"line":55,"column":6},"end":{"line":55,"column":20}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":67,"column":2}},"2":{"start":{"line":7,"column":2},"end":{"line":10,"column":5}},"3":{"start":{"line":11,"column":2},"end":{"line":11,"column":17}},"4":{"start":{"line":14,"column":2},"end":{"line":28,"column":3}},"5":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"6":{"start":{"line":17,"column":6},"end":{"line":17,"column":132}},"7":{"start":{"line":19,"column":4},"end":{"line":21,"column":5}},"8":{"start":{"line":20,"column":6},"end":{"line":20,"column":115}},"9":{"start":{"line":24,"column":4},"end":{"line":24,"column":49}},"10":{"start":{"line":25,"column":4},"end":{"line":25,"column":55}},"11":{"start":{"line":26,"column":4},"end":{"line":26,"column":33}},"12":{"start":{"line":27,"column":4},"end":{"line":27,"column":61}},"13":{"start":{"line":31,"column":2},"end":{"line":66,"column":3}},"14":{"start":{"line":32,"column":4},"end":{"line":65,"column":9}},"15":{"start":{"line":34,"column":8},"end":{"line":53,"column":9}},"16":{"start":{"line":36,"column":12},"end":{"line":36,"column":66}},"17":{"start":{"line":38,"column":12},"end":{"line":38,"column":55}},"18":{"start":{"line":41,"column":12},"end":{"line":43,"column":13}},"19":{"start":{"line":42,"column":14},"end":{"line":42,"column":67}},"20":{"start":{"line":44,"column":12},"end":{"line":44,"column":18}},"21":{"start":{"line":48,"column":12},"end":{"line":48,"column":59}},"22":{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},"23":{"start":{"line":50,"column":14},"end":{"line":50,"column":67}},"24":{"start":{"line":52,"column":12},"end":{"line":52,"column":30}},"25":{"start":{"line":56,"column":8},"end":{"line":56,"column":53}},"26":{"start":{"line":57,"column":8},"end":{"line":64,"column":9}},"27":{"start":{"line":59,"column":12},"end":{"line":59,"column":75}},"28":{"start":{"line":61,"column":12},"end":{"line":61,"column":84}},"29":{"start":{"line":63,"column":12},"end":{"line":63,"column":78}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":16,"column":4}},{"start":{"line":16,"column":4},"end":{"line":16,"column":4}}]},"2":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":4}},{"start":{"line":19,"column":4},"end":{"line":19,"column":4}}]},"3":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":38}},{"start":{"line":25,"column":42},"end":{"line":25,"column":54}}]},"4":{"line":34,"type":"switch","locations":[{"start":{"line":35,"column":10},"end":{"line":36,"column":66}},{"start":{"line":37,"column":10},"end":{"line":38,"column":55}},{"start":{"line":39,"column":10},"end":{"line":44,"column":18}},{"start":{"line":46,"column":10},"end":{"line":52,"column":30}}]},"5":{"line":38,"type":"cond-expr","locations":[{"start":{"line":38,"column":44},"end":{"line":38,"column":50}},{"start":{"line":38,"column":51},"end":{"line":38,"column":53}}]},"6":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":12}},{"start":{"line":41,"column":12},"end":{"line":41,"column":12}}]},"7":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":29}},{"start":{"line":41,"column":33},"end":{"line":41,"column":66}}]},"8":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":12},"end":{"line":49,"column":12}},{"start":{"line":49,"column":12},"end":{"line":49,"column":12}}]},"9":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":16},"end":{"line":49,"column":29}},{"start":{"line":49,"column":33},"end":{"line":49,"column":66}}]},"10":{"line":57,"type":"switch","locations":[{"start":{"line":58,"column":10},"end":{"line":59,"column":75}},{"start":{"line":60,"column":10},"end":{"line":61,"column":84}},{"start":{"line":62,"column":10},"end":{"line":63,"column":78}}]}},"code":["'use strict';","","//TODO just load from assets folder","","module.exports = function(ss,client,options){","","  var bundler = ss.bundler.create({","    define: define,","    asset: asset","  });","  return bundler;","","","  function define(paths) {","","    if (typeof paths.view !== 'string') {","      throw new Error('You may only define one HTML view per single-page client. Please pass a filename as a string, not an Array');","    }","    if (paths.view.lastIndexOf('.') <= 0) {","      throw new Error('The \\'' + paths.view + '\\' view must have a valid HTML extension (such as .html or .jade)');","    }","","    // Define new client object","    client.paths = ss.bundler.sourcePaths(paths);","    client.constants = paths.constants || paths.consts;","    client.locals = paths.locals;","    client.entryInitPath = ss.bundler.findEntryPoint(client);","  }","","  //TODO callback(err,output) for pack to flag error","  function asset(entry, opts, cb) {","    ss.bundler.loadFile(entry, opts, null,","      function(output) {","        switch(entry.bundle) {","          case 'html':","            return cb(ss.bundler.injectTailIfNeeded(output,opts));","          case 'css':","            return cb( client.includes.css? output:'');","          case 'worker':","            //TODO","            if (opts.compress && entry.file.indexOf('.min') === -1) {","              output = ss.bundler.minifyJSFile(output, entry.file);","            }","            break;","","          default:","            //TODO with options compress saved to avoid double compression","            output = bundler.wrapCode(output, entry, opts);","            if (opts.compress && entry.file.indexOf('.min') === -1) {","              output = ss.bundler.minifyJSFile(output, entry.file);","            }","            return cb(output);","        }","      },","      function(err) {","        ss.log.clientIssue(client,options,err,entry);","        switch(entry.ext) {","          case 'html':","            return cb('Couldn\\'t format ' + entry.file + err.userInfoHTML);","          case 'css':","            return cb('/* couldn\\'t format ' + entry.file + err.userInfoText+' */');","          default:","            return cb('// couldn\\'t format ' + entry.file + err.userInfoText);","        }","      });","  }","};","",""],"l":{"5":1,"7":0,"11":0,"14":1,"16":0,"17":0,"19":0,"20":0,"24":0,"25":0,"26":0,"27":0,"31":1,"32":0,"34":0,"36":0,"38":0,"41":0,"42":0,"44":0,"48":0,"49":0,"50":0,"52":0,"56":0,"57":0,"59":0,"61":0,"63":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/jade.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/jade.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":17},"end":{"line":6,"column":53}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":13},"end":{"line":21,"column":41}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":4,"column":27}},"2":{"start":{"line":6,"column":0},"end":{"line":44,"column":2}},"3":{"start":{"line":7,"column":2},"end":{"line":7,"column":24}},"4":{"start":{"line":8,"column":2},"end":{"line":10,"column":3}},"5":{"start":{"line":9,"column":4},"end":{"line":9,"column":67}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":32}},"7":{"start":{"line":14,"column":2},"end":{"line":43,"column":4}},"8":{"start":{"line":23,"column":6},"end":{"line":23,"column":22}},"9":{"start":{"line":26,"column":6},"end":{"line":28,"column":7}},"10":{"start":{"line":27,"column":8},"end":{"line":27,"column":93}},"11":{"start":{"line":27,"column":47},"end":{"line":27,"column":91}},"12":{"start":{"line":31,"column":6},"end":{"line":33,"column":7}},"13":{"start":{"line":32,"column":8},"end":{"line":32,"column":46}},"14":{"start":{"line":35,"column":6},"end":{"line":35,"column":48}},"15":{"start":{"line":36,"column":6},"end":{"line":38,"column":11}},"16":{"start":{"line":39,"column":6},"end":{"line":39,"column":34}},"17":{"start":{"line":41,"column":6},"end":{"line":41,"column":17}}},"branchMap":{"1":{"line":7,"type":"binary-expr","locations":[{"start":{"line":7,"column":11},"end":{"line":7,"column":17}},{"start":{"line":7,"column":21},"end":{"line":7,"column":23}}]},"2":{"line":8,"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":2}},{"start":{"line":8,"column":2},"end":{"line":8,"column":2}}]},"3":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":6},"end":{"line":26,"column":6}},{"start":{"line":26,"column":6},"end":{"line":26,"column":6}}]},"4":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":10},"end":{"line":26,"column":24}},{"start":{"line":26,"column":28},"end":{"line":26,"column":63}}]},"5":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":6},"end":{"line":31,"column":6}},{"start":{"line":31,"column":6},"end":{"line":31,"column":6}}]},"6":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":10},"end":{"line":31,"column":17}},{"start":{"line":31,"column":21},"end":{"line":31,"column":36}}]}},"code":["'use strict';","","var fs = require('fs'),","    path = require('path');","","module.exports = function(ss, config, clientOptions) {","  config = config || {};","  if (!config.basedir) {","    config.basedir = path.join(ss.root, clientOptions.dirs.client);","  }","  ","  var jade = ss.require('jade');","","  return {","","    name: 'Jade',","    extensions: ['jade'],","    assetType: 'html',","    contentType: 'text/html',","","    compile: function(path, options, cb) {","","      var locals = {};","","      // Merge any locals passed to config.locals","      if (options.locals && typeof(options.locals) === 'object') {","        for (var attrname in options.locals) { locals[attrname] = options.locals[attrname]; }","      }","","      // If passing optional headers for main view HTML","      if (options && options.headers) {","        locals.SocketStream = options.headers;","      }","","      var input = fs.readFileSync(path, 'utf8');","      var parser = jade.compile(input, Object.create(config, {","        filename: {value:path}","      }) );","      var output = parser(locals);","","      cb(output);","    }","  };","};",""],"l":{"3":1,"6":1,"7":0,"8":0,"9":0,"12":0,"14":0,"23":0,"26":0,"27":0,"31":0,"32":0,"35":0,"36":0,"39":0,"41":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/less.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/less.js","s":{"1":1,"2":1,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":22},"end":{"line":7,"column":46}}},"2":{"name":"errorBodyStyling","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":42}}},"3":{"name":"decidePaths","line":33,"loc":{"start":{"line":33,"column":22},"end":{"line":33,"column":58}}},"4":{"name":"(anonymous_4)","line":45,"loc":{"start":{"line":45,"column":17},"end":{"line":45,"column":38}}},"5":{"name":"(anonymous_5)","line":56,"loc":{"start":{"line":56,"column":17},"end":{"line":56,"column":45}}},"6":{"name":"(anonymous_6)","line":71,"loc":{"start":{"line":71,"column":23},"end":{"line":71,"column":41}}},"7":{"name":"(anonymous_7)","line":74,"loc":{"start":{"line":74,"column":22},"end":{"line":74,"column":40}}},"8":{"name":"(anonymous_8)","line":77,"loc":{"start":{"line":77,"column":22},"end":{"line":77,"column":40}}},"9":{"name":"(anonymous_9)","line":80,"loc":{"start":{"line":80,"column":23},"end":{"line":80,"column":41}}},"10":{"name":"(anonymous_10)","line":87,"loc":{"start":{"line":87,"column":37},"end":{"line":87,"column":56}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":5,"column":19}},"2":{"start":{"line":7,"column":0},"end":{"line":11,"column":2}},"3":{"start":{"line":8,"column":4},"end":{"line":10,"column":5}},"4":{"start":{"line":9,"column":8},"end":{"line":9,"column":39}},"5":{"start":{"line":13,"column":0},"end":{"line":31,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":33}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":49}},"8":{"start":{"line":16,"column":4},"end":{"line":29,"column":6}},"9":{"start":{"line":30,"column":4},"end":{"line":30,"column":24}},"10":{"start":{"line":33,"column":0},"end":{"line":41,"column":2}},"11":{"start":{"line":35,"column":4},"end":{"line":35,"column":38}},"12":{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},"13":{"start":{"line":38,"column":8},"end":{"line":38,"column":36}},"14":{"start":{"line":40,"column":4},"end":{"line":40,"column":13}},"15":{"start":{"line":45,"column":0},"end":{"line":98,"column":2}},"16":{"start":{"line":47,"column":4},"end":{"line":47,"column":34}},"17":{"start":{"line":49,"column":4},"end":{"line":97,"column":6}},"18":{"start":{"line":58,"column":12},"end":{"line":58,"column":54}},"19":{"start":{"line":60,"column":12},"end":{"line":62,"column":13}},"20":{"start":{"line":61,"column":16},"end":{"line":61,"column":54}},"21":{"start":{"line":63,"column":12},"end":{"line":63,"column":26}},"22":{"start":{"line":64,"column":12},"end":{"line":64,"column":57}},"23":{"start":{"line":64,"column":35},"end":{"line":64,"column":55}},"24":{"start":{"line":65,"column":12},"end":{"line":65,"column":33}},"25":{"start":{"line":66,"column":12},"end":{"line":66,"column":59}},"26":{"start":{"line":67,"column":12},"end":{"line":67,"column":45}},"27":{"start":{"line":69,"column":12},"end":{"line":83,"column":15}},"28":{"start":{"line":87,"column":12},"end":{"line":95,"column":15}},"29":{"start":{"line":88,"column":16},"end":{"line":92,"column":17}},"30":{"start":{"line":89,"column":20},"end":{"line":89,"column":85}},"31":{"start":{"line":90,"column":20},"end":{"line":90,"column":37}},"32":{"start":{"line":91,"column":20},"end":{"line":91,"column":63}},"33":{"start":{"line":94,"column":16},"end":{"line":94,"column":28}}},"branchMap":{"1":{"line":8,"type":"if","locations":[{"start":{"line":8,"column":4},"end":{"line":8,"column":4}},{"start":{"line":8,"column":4},"end":{"line":8,"column":4}}]},"2":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":60},"end":{"line":22,"column":68}},{"start":{"line":22,"column":70},"end":{"line":22,"column":73}}]},"3":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":80},"end":{"line":22,"column":88}},{"start":{"line":22,"column":90},"end":{"line":22,"column":93}}]},"4":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":100},"end":{"line":22,"column":109}},{"start":{"line":22,"column":111},"end":{"line":22,"column":114}}]},"5":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":37,"column":4}},{"start":{"line":37,"column":4},"end":{"line":37,"column":4}}]},"6":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":12},"end":{"line":60,"column":12}},{"start":{"line":60,"column":12},"end":{"line":60,"column":12}}]},"7":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":16},"end":{"line":88,"column":16}},{"start":{"line":88,"column":16},"end":{"line":88,"column":16}}]}},"code":["'use strict';","","var fs = require('fs'),","    pathlib = require('path'),","    _prependedLess;","","exports.prependLess = function(prependedLess) {","    if(typeof prependedLess === 'string') {","        _prependedLess = prependedLess;","    }","};","","function errorBodyStyling(root,path, err) {","    path = path.replace(root,'');","    var filename = err.filename.replace(root,'');","    var r = [","        'body:before {',","        'display:block;',","        'position:absolute;',","        'top:15px; left:20px; right:20px;',","        'z-index: 10000;',","        'content:\"Error compiling LESS file: '+path+' at '+(filename||'?')+' '+(err.line||'?')+':'+(err.index||'?')+'   '+err.message+'\";',","        'border: 1px solid #888;',","        'border-radius: 5px;',","        'background-color: rgba(255,255,255,.5);',","        'background-color: white;',","        'padding: 10px 15px;',","        '}'","    ];","    return r.join('\\n');","}","","exports.decidePaths = function decidePaths(path, options) {","","    var p = [ pathlib.dirname(path) ];","    //TODO by default we should add the ss.root to paths at end","    if (options.paths) {","        p = p.concat(options.paths);","    }","    return p;","};","","// root and config are passed as arguments, but are not used","//","module.exports = function (ss,config) {","","    var less = ss.require('less');","","    return {","","        name: 'Less',","        extensions: ['less'],","        assetType: 'css',","        contentType: 'text/css',","","        compile: function(path, options, cb) {","","            var input = fs.readFileSync(path, 'utf8');","","            if(_prependedLess) {","                input = _prependedLess + '\\n' + input;","            }","            var opts = {};","            for(var n in config) { opts[n] = config[n]; }","            opts.filename = path;","            opts.paths = exports.decidePaths(path, config);","            opts.compress = options.compress;","","            less.logger.addListener({","                //TODO passing along log output","                debug: function(/*msg*/) {","","                },","                info: function(/*msg*/) {","","                },","                warn: function(/*msg*/) {","","                },","                error: function(/*msg*/) {","","                }","            });","            ","            //TODO it seems less still blows up on some path errors, is there a way to catch them?","","            less.render(input, opts, function(err, out) {","                if (err) {","                    console.log('! - Unable to compile Less file %s into CSS', path);","                    console.log(err);","                    return cb(errorBodyStyling(ss, path, err));","                }","                //TODO out.map","                cb(out.css);","            });","        }","    };","};"],"l":{"3":1,"7":1,"8":0,"9":0,"13":1,"14":0,"15":0,"16":0,"30":0,"33":1,"35":0,"37":0,"38":0,"40":0,"45":1,"47":0,"49":0,"58":0,"60":0,"61":0,"63":0,"64":0,"65":0,"66":0,"67":0,"69":0,"87":0,"88":0,"89":0,"90":0,"91":0,"94":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/sass.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/formatters/sass.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":17},"end":{"line":6,"column":53}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":13},"end":{"line":23,"column":56}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":46}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":4,"column":36}},"2":{"start":{"line":6,"column":0},"end":{"line":48,"column":2}},"3":{"start":{"line":8,"column":2},"end":{"line":9,"column":47}},"4":{"start":{"line":11,"column":2},"end":{"line":11,"column":18}},"5":{"start":{"line":13,"column":2},"end":{"line":47,"column":4}},"6":{"start":{"line":25,"column":6},"end":{"line":28,"column":8}},"7":{"start":{"line":29,"column":6},"end":{"line":33,"column":7}},"8":{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},"9":{"start":{"line":31,"column":10},"end":{"line":31,"column":41}},"10":{"start":{"line":34,"column":6},"end":{"line":34,"column":50}},"11":{"start":{"line":35,"column":6},"end":{"line":35,"column":65}},"12":{"start":{"line":37,"column":6},"end":{"line":45,"column":9}},"13":{"start":{"line":38,"column":8},"end":{"line":41,"column":9}},"14":{"start":{"line":39,"column":10},"end":{"line":39,"column":26}},"15":{"start":{"line":40,"column":10},"end":{"line":40,"column":28}},"16":{"start":{"line":42,"column":8},"end":{"line":42,"column":39}}},"branchMap":{"1":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":8},"end":{"line":30,"column":8}},{"start":{"line":30,"column":8},"end":{"line":30,"column":8}}]},"2":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":20},"end":{"line":31,"column":29}},{"start":{"line":31,"column":33},"end":{"line":31,"column":40}}]},"3":{"line":34,"type":"binary-expr","locations":[{"start":{"line":34,"column":20},"end":{"line":34,"column":31}},{"start":{"line":34,"column":35},"end":{"line":34,"column":49}}]},"4":{"line":35,"type":"cond-expr","locations":[{"start":{"line":35,"column":43},"end":{"line":35,"column":55}},{"start":{"line":35,"column":56},"end":{"line":35,"column":64}}]},"5":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":8},"end":{"line":38,"column":8}},{"start":{"line":38,"column":8},"end":{"line":38,"column":8}}]}},"code":["'use strict';","","var path = require('path'),","    findup = require('findup-sync');","","module.exports = function(ss, config, clientOptions) {","","  var sass = ss.require('node-sass'),","      modulesPath = [ findup('node_modules') ]; //TODO get real npm and bower package locations","","  console.log(  );","","  return {","","    name: 'Sass',","","    extensions: ['sass', 'scss'],","","    assetType: 'css',","","    contentType: 'text/css',","","    compile: function(srcPath, options, success, error) {","","      var opts = {","        file: srcPath,","        includePaths: modulesPath.concat([ path.join(ss.root, clientOptions.dirs.client) ])","      };","      for(var n in config) {","        if (n !== 'file') {","          opts[n] = config[n] || opts[n];","        }","      }","      opts.locals = opts.locals || options.locals;","      opts.outputStyle = options.compress? \"compressed\":\"nested\";","","      sass.render(opts, function(err, result) {","        if (err) {","          console.log(err)","          return error(err);","        }","        success(result.css.toString());","        //TODO result.stats print","        //TODO result.map.toString","      });","    }","  };","};",""],"l":{"3":1,"6":1,"8":0,"11":0,"13":0,"25":0,"29":0,"30":0,"31":0,"34":0,"35":0,"37":0,"38":0,"39":0,"40":0,"42":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/template_engines/angular.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/template_engines/angular.js","s":{"1":1,"2":0,"3":0},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":15},"end":{"line":6,"column":26}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":13},"end":{"line":9,"column":42}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":13,"column":2}},"2":{"start":{"line":7,"column":2},"end":{"line":12,"column":4}},"3":{"start":{"line":10,"column":6},"end":{"line":10,"column":94}}},"branchMap":{},"code":["// Produces inline templates for Angular.js","// Use them in conjunction with `ng-view`. Note the `.html` at the end of each template name which is automatically appended","","'use strict';","","exports.init = function() {","  return {","    name: 'Angular.js',","    process: function(template, path, id) {","      return '<script type=\"text/ng-template\" id=\"' + id + '.html\">' + template + '</script>';","    }","  };","};",""],"l":{"6":1,"7":0,"10":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/template_engines/ember.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/client/template_engines/ember.js","s":{"1":1,"2":0,"3":0},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":15},"end":{"line":5,"column":26}}},"2":{"name":"(anonymous_2)","line":8,"loc":{"start":{"line":8,"column":13},"end":{"line":8,"column":42}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":12,"column":2}},"2":{"start":{"line":6,"column":2},"end":{"line":11,"column":4}},"3":{"start":{"line":9,"column":6},"end":{"line":9,"column":106}}},"branchMap":{},"code":["// Produces templates for Ember.js","// Note Ember compiles these Handlebars templates one time only when you call Em.Application.create();","'use strict';","","exports.init = function() {","  return {","    name: 'Ember.js',","    process: function(template, path, id) {","      return '<script type=\"text/x-handlebars\" data-template-name=\"' + id + '\">' + template + '</script>';","    }","  };","};",""],"l":{"5":1,"6":0,"9":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/publish/transports/internal.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/publish/transports/internal.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":17},"end":{"line":10,"column":28}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":25}}},"3":{"name":"(anonymous_3)","line":15,"loc":{"start":{"line":15,"column":10},"end":{"line":15,"column":24}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":27}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":55}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":30}},"4":{"start":{"line":10,"column":0},"end":{"line":19,"column":2}},"5":{"start":{"line":11,"column":2},"end":{"line":18,"column":4}},"6":{"start":{"line":13,"column":6},"end":{"line":13,"column":37}},"7":{"start":{"line":16,"column":6},"end":{"line":16,"column":40}}},"branchMap":{},"code":["// Publish Event - Internal EventEmitter Transport","'use strict';","","var EventEmitter2, emitter;","","EventEmitter2 = require('eventemitter2').EventEmitter2;","","emitter = new EventEmitter2();","","module.exports = function() {","  return {","    listen: function(cb) {","      return emitter.on('event', cb);","    },","    send: function(obj) {","      return emitter.emit('event', obj);","    }","  };","};",""],"l":{"4":1,"6":1,"8":1,"10":1,"11":0,"13":0,"16":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/publish/transports/redis.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/lib/publish/transports/redis.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":17},"end":{"line":6,"column":34}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":25},"end":{"line":19,"column":40}}},"3":{"name":"(anonymous_3)","line":29,"loc":{"start":{"line":29,"column":12},"end":{"line":29,"column":25}}},"4":{"name":"(anonymous_4)","line":31,"loc":{"start":{"line":31,"column":36},"end":{"line":31,"column":59}}},"5":{"name":"(anonymous_5)","line":35,"loc":{"start":{"line":35,"column":10},"end":{"line":35,"column":24}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"2":{"start":{"line":6,"column":0},"end":{"line":41,"column":2}},"3":{"start":{"line":7,"column":2},"end":{"line":7,"column":32}},"4":{"start":{"line":8,"column":2},"end":{"line":10,"column":3}},"5":{"start":{"line":9,"column":4},"end":{"line":9,"column":16}},"6":{"start":{"line":13,"column":2},"end":{"line":13,"column":29}},"7":{"start":{"line":14,"column":2},"end":{"line":14,"column":36}},"8":{"start":{"line":15,"column":2},"end":{"line":15,"column":33}},"9":{"start":{"line":18,"column":2},"end":{"line":18,"column":12}},"10":{"start":{"line":19,"column":2},"end":{"line":27,"column":5}},"11":{"start":{"line":20,"column":4},"end":{"line":20,"column":57}},"12":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"13":{"start":{"line":22,"column":6},"end":{"line":22,"column":35}},"14":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"15":{"start":{"line":25,"column":6},"end":{"line":25,"column":42}},"16":{"start":{"line":28,"column":2},"end":{"line":40,"column":4}},"17":{"start":{"line":30,"column":6},"end":{"line":30,"column":37}},"18":{"start":{"line":31,"column":6},"end":{"line":33,"column":9}},"19":{"start":{"line":32,"column":8},"end":{"line":32,"column":35}},"20":{"start":{"line":36,"column":6},"end":{"line":36,"column":14}},"21":{"start":{"line":37,"column":6},"end":{"line":37,"column":32}},"22":{"start":{"line":38,"column":6},"end":{"line":38,"column":47}}},"branchMap":{"1":{"line":8,"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":2}},{"start":{"line":8,"column":2},"end":{"line":8,"column":2}}]},"2":{"line":13,"type":"binary-expr","locations":[{"start":{"line":13,"column":9},"end":{"line":13,"column":20}},{"start":{"line":13,"column":24},"end":{"line":13,"column":28}}]},"3":{"line":14,"type":"binary-expr","locations":[{"start":{"line":14,"column":9},"end":{"line":14,"column":20}},{"start":{"line":14,"column":24},"end":{"line":14,"column":35}}]},"4":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":12},"end":{"line":15,"column":26}},{"start":{"line":15,"column":30},"end":{"line":15,"column":32}}]},"5":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":4}},{"start":{"line":21,"column":4},"end":{"line":21,"column":4}}]},"6":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":4}},{"start":{"line":24,"column":4},"end":{"line":24,"column":4}}]}},"code":["// Publish Event - Redis Transport","'use strict';","","var redis = require('redis'); //TODO ss.require('redis')","","module.exports = function(config) {","  var conn, host, options, port;","  if (!config) {","    config = {};","  }","","  // Set options or use the defaults  ","  port = config.port || 6379;","  host = config.host || '127.0.0.1';","  options = config.options || {};","","  // Redis requires a separate connection for pub/sub  ","  conn = {};","  ['pub', 'sub'].forEach(function(name) {","    conn[name] = redis.createClient(port, host, options);","    if (config.pass) {","      conn[name].auth(config.pass);","    }","    if (config.db) {","      return conn[name].select(config.db);","    }","  });","  return {","    listen: function(cb) {","      conn.sub.subscribe('ss:event');","      return conn.sub.on('message', function(channel, msg) {","        return cb(JSON.parse(msg));","      });","    },","    send: function(obj) {","      var msg;","      msg = JSON.stringify(obj);","      return conn.pub.publish('ss:event', msg);","    }","  };","};",""],"l":{"4":1,"6":1,"7":0,"8":0,"9":0,"13":0,"14":0,"15":0,"18":0,"19":0,"20":0,"21":0,"22":0,"24":0,"25":0,"28":0,"30":0,"31":0,"32":0,"36":0,"37":0,"38":0}},"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/new_project/server/rpc/demo.js":{"path":"/home/travis/build/npmtest/node-npmtest-socketstream/node_modules/socketstream/new_project/server/rpc/demo.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":41}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":17},"end":{"line":15,"column":35}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":26,"column":2}},"2":{"start":{"line":8,"column":2},"end":{"line":8,"column":21}},"3":{"start":{"line":13,"column":2},"end":{"line":24,"column":4}},"4":{"start":{"line":16,"column":6},"end":{"line":21,"column":7}},"5":{"start":{"line":17,"column":8},"end":{"line":17,"column":46}},"6":{"start":{"line":18,"column":8},"end":{"line":18,"column":25}},"7":{"start":{"line":20,"column":8},"end":{"line":20,"column":26}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":6},"end":{"line":16,"column":6}},{"start":{"line":16,"column":6},"end":{"line":16,"column":6}}]},"2":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":10},"end":{"line":16,"column":17}},{"start":{"line":16,"column":21},"end":{"line":16,"column":39}}]}},"code":["'use strict';","// Server-side Code","","// Define actions which can be called from the client using ss.rpc('demo.ACTIONNAME', param1, param2...)","exports.actions = function(req, res, ss) {","","  // Example of pre-loading sessions into req.session using internal middleware","  req.use('session');","","  // Uncomment line below to use the middleware defined in server/middleware/example","  //req.use('example.authenticated')","","  return {","","    sendMessage: function(message) {","      if (message && message.length > 0) {         // Check for blank messages","        ss.publish.all('newMessage', message);     // Broadcast the message to everyone","        return res(true);                          // Confirm it was sent to the originating client","      } else {","        return res(false);","      }","    }","","  };","","};"],"l":{"5":1,"8":0,"13":0,"16":0,"17":0,"18":0,"20":0}}}